"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@inngest";
exports.ids = ["vendor-chunks/@inngest"];
exports.modules = {

/***/ "(rsc)/./node_modules/@inngest/agent-kit/dist/chunk-J76M4KLW.js":
/*!****************************************************************!*\
  !*** ./node_modules/@inngest/agent-kit/dist/chunk-J76M4KLW.js ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Agent: () => (/* binding */ Agent),\n/* harmony export */   AgentResult: () => (/* binding */ AgentResult),\n/* harmony export */   AgenticModel: () => (/* binding */ AgenticModel),\n/* harmony export */   Network: () => (/* binding */ Network),\n/* harmony export */   NetworkRun: () => (/* binding */ NetworkRun),\n/* harmony export */   RoutingAgent: () => (/* binding */ RoutingAgent),\n/* harmony export */   State: () => (/* binding */ State),\n/* harmony export */   __spreadProps: () => (/* binding */ __spreadProps),\n/* harmony export */   __spreadValues: () => (/* binding */ __spreadValues),\n/* harmony export */   createAgent: () => (/* binding */ createAgent),\n/* harmony export */   createAgenticModelFromAiAdapter: () => (/* binding */ createAgenticModelFromAiAdapter),\n/* harmony export */   createNetwork: () => (/* binding */ createNetwork),\n/* harmony export */   createRoutingAgent: () => (/* binding */ createRoutingAgent),\n/* harmony export */   createState: () => (/* binding */ createState),\n/* harmony export */   createTool: () => (/* binding */ createTool),\n/* harmony export */   getDefaultRoutingAgent: () => (/* binding */ getDefaultRoutingAgent),\n/* harmony export */   getInngestFnInput: () => (/* binding */ getInngestFnInput),\n/* harmony export */   getStepTools: () => (/* binding */ getStepTools),\n/* harmony export */   initializeThread: () => (/* binding */ initializeThread),\n/* harmony export */   isInngestFn: () => (/* binding */ isInngestFn),\n/* harmony export */   loadThreadFromStorage: () => (/* binding */ loadThreadFromStorage),\n/* harmony export */   saveThreadToStorage: () => (/* binding */ saveThreadToStorage),\n/* harmony export */   stringifyError: () => (/* binding */ stringifyError)\n/* harmony export */ });\n/* harmony import */ var xxhashjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xxhashjs */ \"(rsc)/./node_modules/xxhashjs/lib/index.js\");\n/* harmony import */ var inngest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! inngest */ \"(rsc)/./node_modules/inngest/index.js\");\n/* harmony import */ var inngest_components_InngestFunction__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! inngest/components/InngestFunction */ \"(rsc)/./node_modules/inngest/components/InngestFunction.js\");\n/* harmony import */ var inngest_experimental__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! inngest/experimental */ \"(rsc)/./node_modules/inngest/experimental.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _inngest_ai__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @inngest/ai */ \"(rsc)/./node_modules/@inngest/ai/dist/index.js\");\n/* harmony import */ var _dmitryrechkin_json_schema_to_zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dmitryrechkin/json-schema-to-zod */ \"(rsc)/./node_modules/@dmitryrechkin/json-schema-to-zod/dist/index.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_client_index_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @modelcontextprotocol/sdk/client/index.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/client/index.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_client_streamableHttp_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @modelcontextprotocol/sdk/client/streamableHttp.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/client/streamableHttp.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_client_sse_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @modelcontextprotocol/sdk/client/sse.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/client/sse.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_client_websocket_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @modelcontextprotocol/sdk/client/websocket.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/client/websocket.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_client_stdio_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @modelcontextprotocol/sdk/client/stdio.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/client/stdio.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_shared_transport_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @modelcontextprotocol/sdk/shared/transport.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/shared/transport.js\");\n/* harmony import */ var _modelcontextprotocol_sdk_types_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @modelcontextprotocol/sdk/types.js */ \"(rsc)/./node_modules/@modelcontextprotocol/sdk/dist/esm/types.js\");\n/* harmony import */ var eventsource__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! eventsource */ \"(rsc)/./node_modules/eventsource/dist/index.js\");\n/* harmony import */ var inngest_helpers_errors__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! inngest/helpers/errors */ \"(rsc)/./node_modules/inngest/helpers/errors.js\");\n/* harmony import */ var inngest_types__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! inngest/types */ \"(rsc)/./node_modules/inngest/types.js\");\n/* harmony import */ var zod_to_json_schema__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! zod-to-json-schema */ \"(rsc)/./node_modules/zod-to-json-schema/dist/esm/index.js\");\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\n\n// src/types.ts\n\nvar _checksum;\nvar AgentResult = class {\n  constructor(agentName, output, toolCalls, createdAt, prompt, history, raw) {\n    this.agentName = agentName;\n    this.output = output;\n    this.toolCalls = toolCalls;\n    this.createdAt = createdAt;\n    this.prompt = prompt;\n    this.history = history;\n    this.raw = raw;\n    // checksum memoizes a checksum so that it doe snot have to be calculated many times.\n    __privateAdd(this, _checksum);\n  }\n  /**\n   * export returns all fields necessary to store the AgentResult for future use.\n   */\n  export() {\n    return {\n      agentName: this.agentName,\n      output: this.output,\n      toolCalls: this.toolCalls,\n      createdAt: this.createdAt,\n      checksum: this.checksum\n    };\n  }\n  /**\n   * checksum is a unique ID for this result.\n   *\n   * It is generated by taking a checksum of the message output and the created at date.\n   * This allows you to dedupe items when saving conversation history.\n   */\n  get checksum() {\n    if (__privateGet(this, _checksum) === void 0) {\n      const input = JSON.stringify(this.output.concat(this.toolCalls)) + this.createdAt.toString();\n      __privateSet(this, _checksum, xxhashjs__WEBPACK_IMPORTED_MODULE_0__.h64(input, 0).toString());\n    }\n    return __privateGet(this, _checksum);\n  }\n};\n_checksum = new WeakMap();\n\n// src/state.ts\nvar createState = (initialState, opts) => {\n  return new State(__spreadProps(__spreadValues({}, opts), { data: initialState }));\n};\nvar __kv;\nvar _State = class _State {\n  constructor({ data, messages, threadId, results } = {}) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    __privateAdd(this, __kv);\n    this._results = results || [];\n    this._messages = messages || [];\n    this._data = data ? __spreadValues({}, data) : {};\n    this.threadId = threadId;\n    this.data = new Proxy(this._data, {\n      set: (target, prop, value) => {\n        if (typeof prop === \"string\" && prop in target) {\n          Reflect.set(target, prop, value);\n          return true;\n        }\n        return Reflect.set(target, prop, value);\n      }\n    });\n    __privateSet(this, __kv, new Map(Object.entries(this._data)));\n    this.kv = {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      set: (key, value) => {\n        __privateGet(this, __kv).set(key, value);\n      },\n      get: (key) => {\n        return __privateGet(this, __kv).get(key);\n      },\n      delete: (key) => {\n        return __privateGet(this, __kv).delete(key);\n      },\n      has: (key) => {\n        return __privateGet(this, __kv).has(key);\n      },\n      all: () => {\n        return Object.fromEntries(__privateGet(this, __kv));\n      }\n    };\n  }\n  /**\n   * Results returns a new array containing all past inference results in the\n   * network. This array is safe to modify.\n   */\n  get results() {\n    return this._results.slice();\n  }\n  /**\n   * Replaces all results with the provided array\n   * used when loading initial results from history.get()\n   */\n  setResults(results) {\n    this._results = results;\n  }\n  /**\n   * Returns a slice of results from the given start index\n   * used when saving results to a database via history.appendResults()\n   */\n  getResultsFrom(startIndex) {\n    return this._results.slice(startIndex);\n  }\n  /**\n   * Messages returns a new array containing all initial messages that were\n   * provided to the constructor. This array is safe to modify.\n   */\n  get messages() {\n    return this._messages.slice();\n  }\n  /**\n   * formatHistory returns the memory used for agentic calls based off of prior\n   * agentic calls.\n   *\n   * This is used to format the current State as a conversation log when\n   * calling an individual agent.\n   *\n   */\n  formatHistory(formatter) {\n    if (!formatter) {\n      formatter = defaultResultFormatter;\n    }\n    return this._messages.concat(\n      this._results.map((result) => formatter(result)).flat()\n    );\n  }\n  /**\n   * appendResult appends a given result to the current state.  This\n   * is called by the network after each iteration.\n   */\n  appendResult(call) {\n    this._results.push(call);\n  }\n  /**\n   * clone allows you to safely clone the state.\n   */\n  clone() {\n    const state = new _State({\n      data: this.data,\n      threadId: this.threadId,\n      messages: this._messages.slice(),\n      results: this._results.slice()\n    });\n    return state;\n  }\n};\n__kv = new WeakMap();\nvar State = _State;\nvar defaultResultFormatter = (r) => {\n  return [].concat(r.output).concat(r.toolCalls);\n};\n\n// src/util.ts\n\n\n\n\nvar stringifyError = (e) => {\n  if (e instanceof Error) {\n    return e.message;\n  }\n  return String(e);\n};\nvar getStepTools = async () => {\n  const asyncCtx = await (0,inngest_experimental__WEBPACK_IMPORTED_MODULE_3__.getAsyncCtx)();\n  return asyncCtx == null ? void 0 : asyncCtx.ctx.step;\n};\nvar isInngestFn = (fn) => {\n  if (fn instanceof inngest_components_InngestFunction__WEBPACK_IMPORTED_MODULE_2__.InngestFunction) {\n    return true;\n  }\n  if (typeof fn === \"object\" && fn !== null && \"createExecution\" in fn && typeof fn.createExecution === \"function\") {\n    return true;\n  }\n  return false;\n};\nvar getInngestFnInput = (fn) => {\n  var _a, _b, _c;\n  const runtimeSchemas = (_a = fn[\"client\"][\"schemas\"]) == null ? void 0 : _a[\"runtimeSchemas\"];\n  if (!runtimeSchemas) {\n    return;\n  }\n  const schemasToAttempt = new Set(\n    (_c = (_b = fn[\"opts\"].triggers) == null ? void 0 : _b.reduce((acc, trigger) => {\n      if (trigger.event) {\n        return [...acc, trigger.event];\n      }\n      return acc;\n    }, [])) != null ? _c : []\n  );\n  if (!schemasToAttempt.size) {\n    return;\n  }\n  let schema;\n  for (const eventSchema of schemasToAttempt) {\n    const runtimeSchema = runtimeSchemas[eventSchema];\n    if (typeof runtimeSchema === \"object\" && runtimeSchema !== null && \"data\" in runtimeSchema && helpers.isZodObject(runtimeSchema.data)) {\n      if (schema) {\n        schema = schema.or(runtimeSchema.data);\n      } else {\n        schema = runtimeSchema.data;\n      }\n      continue;\n    }\n  }\n  return schema;\n};\nvar helpers = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  isZodObject: (value) => {\n    return value instanceof zod__WEBPACK_IMPORTED_MODULE_4__.ZodType && value._def.typeName === \"ZodObject\";\n  },\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  isObject: (value) => {\n    return typeof value === \"object\" && value !== null && !Array.isArray(value);\n  }\n};\n\n// src/network.ts\n\n\n\n// src/agent.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// src/model.ts\n\n\n// src/adapters/index.ts\n\n\n// src/adapters/anthropic.ts\n\n\n\n\n// src/tool.ts\n\n\nfunction createTool({\n  name,\n  description,\n  parameters,\n  handler\n}) {\n  return {\n    name,\n    description,\n    parameters,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    handler\n    // eslint-disable-line @typescript-eslint/no-explicit-any\n  };\n}\n\n// src/adapters/anthropic.ts\nvar requestParser = (model, messages, tools, tool_choice = \"auto\") => {\n  const systemMessage = messages.find(\n    (m) => m.role === \"system\" && m.type === \"text\"\n  );\n  const system = typeof (systemMessage == null ? void 0 : systemMessage.content) === \"string\" ? systemMessage.content : \"\";\n  const anthropicMessages = messages.filter((m) => m.role !== \"system\").reduce(\n    (acc, m) => {\n      switch (m.type) {\n        case \"text\":\n          return [\n            ...acc,\n            {\n              role: m.role,\n              content: Array.isArray(m.content) ? m.content.map((text) => ({ type: \"text\", text })) : m.content\n            }\n          ];\n        case \"tool_call\":\n          return [\n            ...acc,\n            {\n              role: m.role,\n              content: m.tools.map((tool) => ({\n                type: \"tool_use\",\n                id: tool.id,\n                input: tool.input,\n                name: tool.name\n              }))\n            }\n          ];\n        case \"tool_result\":\n          return [\n            ...acc,\n            {\n              role: \"user\",\n              content: [\n                {\n                  type: \"tool_result\",\n                  tool_use_id: m.tool.id,\n                  content: typeof m.content === \"string\" ? m.content : JSON.stringify(m.content)\n                }\n              ]\n            }\n          ];\n      }\n    },\n    []\n  );\n  const lastMessage = anthropicMessages[anthropicMessages.length - 1];\n  if ((lastMessage == null ? void 0 : lastMessage.role) === \"assistant\") {\n    lastMessage.role = \"user\";\n  }\n  const request = {\n    system,\n    model: model.options.model,\n    max_tokens: model.options.defaultParameters.max_tokens,\n    messages: anthropicMessages\n  };\n  if (tools == null ? void 0 : tools.length) {\n    request.tools = tools.map((t) => {\n      return {\n        name: t.name,\n        description: t.description,\n        input_schema: t.parameters ? (0,zod_to_json_schema__WEBPACK_IMPORTED_MODULE_16__.zodToJsonSchema)(t.parameters) : (0,zod_to_json_schema__WEBPACK_IMPORTED_MODULE_16__.zodToJsonSchema)(\n          zod__WEBPACK_IMPORTED_MODULE_4__.object({})\n        )\n      };\n    });\n    request.tool_choice = toolChoice(tool_choice);\n  }\n  return request;\n};\nvar responseParser = (input) => {\n  var _a, _b;\n  if (input.type === \"error\") {\n    throw new Error(\n      ((_a = input.error) == null ? void 0 : _a.message) || `Anthropic request failed: ${JSON.stringify(input.error)}`\n    );\n  }\n  return ((_b = input == null ? void 0 : input.content) != null ? _b : []).reduce((acc, item) => {\n    if (!item.type) {\n      return acc;\n    }\n    switch (item.type) {\n      case \"text\":\n        return [\n          ...acc,\n          {\n            type: \"text\",\n            role: input.role,\n            content: item.text,\n            // XXX: Better stop reason parsing\n            stop_reason: \"stop\"\n          }\n        ];\n      case \"tool_use\": {\n        let args;\n        try {\n          args = typeof item.input === \"string\" ? JSON.parse(item.input) : item.input;\n        } catch (e) {\n          args = item.input;\n        }\n        return [\n          ...acc,\n          {\n            type: \"tool_call\",\n            role: input.role,\n            stop_reason: \"tool\",\n            tools: [\n              {\n                type: \"tool\",\n                id: item.id,\n                name: item.name,\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                input: args\n              }\n            ]\n          }\n        ];\n      }\n    }\n  }, []);\n};\nvar toolChoice = (choice) => {\n  switch (choice) {\n    case \"auto\":\n      return { type: \"auto\" };\n    case \"any\":\n      return { type: \"any\" };\n    default:\n      if (typeof choice === \"string\") {\n        return {\n          type: \"tool\",\n          name: choice\n        };\n      }\n  }\n};\n\n// src/adapters/openai.ts\n\n\nvar requestParser2 = (model, messages, tools, tool_choice = \"auto\") => {\n  var _a, _b;\n  const request = {\n    messages: messages.map((m) => {\n      var _a2;\n      switch (m.type) {\n        case \"text\":\n          return {\n            role: m.role,\n            content: m.content\n          };\n        case \"tool_call\":\n          return {\n            role: \"assistant\",\n            content: null,\n            tool_calls: m.tools ? (_a2 = m.tools) == null ? void 0 : _a2.map((tool) => ({\n              id: tool.id,\n              type: \"function\",\n              function: {\n                name: tool.name,\n                arguments: JSON.stringify(tool.input)\n              }\n            })) : void 0\n          };\n        case \"tool_result\":\n          return {\n            role: \"tool\",\n            tool_call_id: m.tool.id,\n            content: typeof m.content === \"string\" ? m.content : JSON.stringify(m.content)\n          };\n      }\n    })\n  };\n  if (tools == null ? void 0 : tools.length) {\n    request.tool_choice = toolChoice2(tool_choice);\n    if (!((_a = model.options.model) == null ? void 0 : _a.includes(\"o3\")) && !((_b = model.options.model) == null ? void 0 : _b.includes(\"o1\"))) {\n      request.parallel_tool_calls = false;\n    }\n    request.tools = tools.map((t) => {\n      return {\n        type: \"function\",\n        function: {\n          name: t.name,\n          description: t.description,\n          parameters: t.parameters && (0,zod_to_json_schema__WEBPACK_IMPORTED_MODULE_16__.zodToJsonSchema)(t.parameters, { target: \"openAi\" }),\n          strict: typeof t.strict !== \"undefined\" ? t.strict : Boolean(t.parameters)\n          // strict mode is only supported with parameters\n        }\n      };\n    });\n  }\n  return request;\n};\nvar responseParser2 = (input) => {\n  var _a;\n  if (input.error) {\n    throw new Error(\n      input.error.message || `OpenAI request failed: ${JSON.stringify(input.error)}`\n    );\n  }\n  return ((_a = input == null ? void 0 : input.choices) != null ? _a : []).reduce((acc, choice) => {\n    var _a2, _b;\n    const { message, finish_reason } = choice;\n    if (!message) {\n      return acc;\n    }\n    const base = {\n      role: choice.message.role,\n      stop_reason: openAiStopReasonToStateStopReason[finish_reason != null ? finish_reason : \"\"] || \"stop\"\n    };\n    if (message.content && message.content.trim() !== \"\") {\n      acc.push(__spreadProps(__spreadValues({}, base), {\n        type: \"text\",\n        content: message.content\n      }));\n    }\n    if (((_b = (_a2 = message.tool_calls) == null ? void 0 : _a2.length) != null ? _b : 0) > 0) {\n      acc.push(__spreadProps(__spreadValues({}, base), {\n        type: \"tool_call\",\n        tools: message.tool_calls.map((tool) => {\n          return {\n            type: \"tool\",\n            id: tool.id,\n            name: tool.function.name,\n            function: tool.function.name,\n            // Duplicate for backward compatibility\n            // Use safe parser to handle OpenAI's JSON quirks (like backticks in strings)\n            input: safeParseOpenAIJson(tool.function.arguments || \"{}\")\n          };\n        })\n      }));\n    }\n    return acc;\n  }, []);\n};\nvar safeParseOpenAIJson = (str) => {\n  const trimmed = str.replace(/^[\"']|[\"']$/g, \"\");\n  try {\n    return JSON.parse(trimmed);\n  } catch (e) {\n    try {\n      const withQuotes = trimmed.replace(\n        /`([\\s\\S]*?)`/g,\n        (_, content) => JSON.stringify(content)\n      );\n      return JSON.parse(withQuotes);\n    } catch (e2) {\n      throw new Error(\n        `Failed to parse JSON with backticks: ${stringifyError(e2)}`\n      );\n    }\n  }\n};\nvar openAiStopReasonToStateStopReason = {\n  tool_calls: \"tool\",\n  stop: \"stop\",\n  length: \"stop\",\n  content_filter: \"stop\",\n  function_call: \"tool\"\n};\nvar toolChoice2 = (choice) => {\n  switch (choice) {\n    case \"auto\":\n      return \"auto\";\n    case \"any\":\n      return \"required\";\n    default:\n      return {\n        type: \"function\",\n        function: { name: choice }\n      };\n  }\n};\n\n// src/adapters/gemini.ts\n\n\n\nvar requestParser3 = (_model2, messages, tools, tool_choice = \"auto\") => {\n  const contents = messages.map((m) => messageToContent(m));\n  const functionDeclarations = tools.map((t) => ({\n    name: t.name,\n    description: t.description,\n    parameters: t.parameters ? geminiZodToJsonSchema(t.parameters) : (\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      geminiZodToJsonSchema(zod__WEBPACK_IMPORTED_MODULE_4__.object({}))\n    )\n  }));\n  return __spreadValues({\n    contents\n  }, tools.length > 0 ? {\n    tools: [\n      {\n        functionDeclarations\n      }\n    ],\n    tool_config: toolChoice3(tool_choice)\n  } : {});\n};\nvar messageContentToString = (content) => {\n  if (typeof content === \"string\") {\n    return content;\n  }\n  return content.map((c) => c.text).join(\"\");\n};\nvar responseParser3 = (input) => {\n  var _a, _b, _c;\n  if (input.error) {\n    throw new Error(\n      ((_a = input.error) == null ? void 0 : _a.message) || `Gemini request failed: ${JSON.stringify(input.error)}`\n    );\n  }\n  const messages = [];\n  for (const candidate of (_b = input.candidates) != null ? _b : []) {\n    if (candidate.finishReason === \"MALFORMED_FUNCTION_CALL\") {\n      console.warn(\n        \"Gemini returned MALFORMED_FUNCTION_CALL, skipping this candidate. This typically indicates an issue with tool/function call formatting. Check your tool definitions and parameters.\"\n      );\n      continue;\n    }\n    if (!((_c = candidate.content) == null ? void 0 : _c.parts)) {\n      continue;\n    }\n    for (const content of candidate.content.parts) {\n      if (candidate.content.role === \"user\" && \"text\" in content) {\n        messages.push({\n          role: \"user\",\n          type: \"text\",\n          content: content.text\n        });\n      } else if (candidate.content.role === \"model\" && \"text\" in content) {\n        messages.push({\n          role: \"assistant\",\n          type: \"text\",\n          content: content.text\n        });\n      } else if (candidate.content.role === \"model\" && \"functionCall\" in content) {\n        messages.push({\n          role: \"assistant\",\n          type: \"tool_call\",\n          stop_reason: \"tool\",\n          tools: [\n            {\n              name: content.functionCall.name,\n              input: content.functionCall.args,\n              type: \"tool\",\n              id: content.functionCall.name\n            }\n          ]\n        });\n      } else if (candidate.content.role === \"user\" && \"functionResponse\" in content) {\n        messages.push({\n          role: \"tool_result\",\n          type: \"tool_result\",\n          stop_reason: \"tool\",\n          tool: {\n            name: content.functionResponse.name,\n            input: content.functionResponse.response,\n            type: \"tool\",\n            id: content.functionResponse.name\n          },\n          content: JSON.stringify(content.functionResponse.response)\n        });\n      } else {\n        throw new Error(\"Unknown content type\");\n      }\n    }\n  }\n  return messages;\n};\nvar messageToContent = (m) => {\n  switch (m.role) {\n    case \"system\":\n      return {\n        role: \"user\",\n        parts: [{ text: messageContentToString(m.content) }]\n      };\n    case \"user\":\n      switch (m.type) {\n        case \"tool_call\":\n          if (m.tools.length === 0) {\n            throw new Error(\"Tool call message must have at least one tool\");\n          }\n          return {\n            role: \"model\",\n            parts: [\n              {\n                functionCall: {\n                  name: m.tools[0].name,\n                  args: m.tools[0].input\n                }\n              }\n            ]\n          };\n        case \"text\":\n        default:\n          return {\n            role: \"user\",\n            parts: [{ text: messageContentToString(m.content) }]\n          };\n      }\n    case \"assistant\":\n      switch (m.type) {\n        case \"tool_call\":\n          if (m.tools.length === 0) {\n            throw new Error(\"Tool call message must have at least one tool\");\n          }\n          return {\n            role: \"model\",\n            parts: [\n              {\n                functionCall: {\n                  name: m.tools[0].name,\n                  args: m.tools[0].input\n                }\n              }\n            ]\n          };\n        case \"text\":\n        default:\n          return {\n            role: \"model\",\n            parts: [{ text: messageContentToString(m.content) }]\n          };\n      }\n    case \"tool_result\":\n      return {\n        role: \"user\",\n        parts: [\n          {\n            functionResponse: {\n              name: m.tool.name,\n              response: {\n                name: m.tool.name,\n                content: typeof m.content === \"string\" ? m.content : JSON.stringify(m.content)\n              }\n            }\n          }\n        ]\n      };\n    default:\n      throw new Error(`Unknown message role: ${m.role}`);\n  }\n};\nvar toolChoice3 = (choice) => {\n  switch (choice) {\n    case \"auto\":\n      return {\n        functionCallingConfig: {\n          mode: \"AUTO\"\n        }\n      };\n    case \"any\":\n      return {\n        functionCallingConfig: {\n          mode: \"ANY\"\n        }\n      };\n    default:\n      if (typeof choice === \"string\") {\n        return {\n          functionCallingConfig: {\n            mode: \"ANY\",\n            allowedFunctionNames: [choice]\n          }\n        };\n      }\n  }\n};\nvar recursiveGeminiZodToJsonSchema = (obj) => {\n  if (obj === null || obj === void 0 || typeof obj !== \"object\") {\n    return obj;\n  }\n  if (Array.isArray(obj)) {\n    return obj.map(recursiveGeminiZodToJsonSchema);\n  }\n  const newObj = __spreadValues({}, obj);\n  for (const key in newObj) {\n    if (newObj[key] != null) {\n      newObj[key] = recursiveGeminiZodToJsonSchema(\n        newObj[key]\n      );\n    }\n  }\n  if ((newObj == null ? void 0 : newObj[\"additionalProperties\"]) != null) {\n    delete newObj[\"additionalProperties\"];\n  }\n  return newObj;\n};\nvar geminiZodToJsonSchema = (zod) => {\n  let schema = (0,zod_to_json_schema__WEBPACK_IMPORTED_MODULE_16__.zodToJsonSchema)(zod, { target: \"openApi3\" });\n  schema = recursiveGeminiZodToJsonSchema(schema);\n  return schema;\n};\n\n// src/adapters/grok.ts\nvar requestParser4 = (model, messages, tools, tool_choice = \"auto\") => {\n  const request = requestParser2(\n    model,\n    messages,\n    tools,\n    tool_choice\n  );\n  request.tools = (request.tools || []).map((tool) => __spreadProps(__spreadValues({}, tool), {\n    function: __spreadProps(__spreadValues({}, tool.function), {\n      strict: false\n    })\n  }));\n  return request;\n};\nvar responseParser4 = responseParser2;\n\n// src/adapters/index.ts\nvar adapters = {\n  \"openai-chat\": {\n    request: requestParser2,\n    response: responseParser2\n  },\n  anthropic: {\n    request: requestParser,\n    response: responseParser\n  },\n  gemini: {\n    request: requestParser3,\n    response: responseParser3\n  },\n  grok: {\n    request: requestParser4,\n    response: responseParser4\n  }\n};\n\n// src/model.ts\nvar createAgenticModelFromAiAdapter = (adapter) => {\n  const opts = adapters[adapter.format];\n  return new AgenticModel({\n    model: adapter,\n    requestParser: opts.request,\n    responseParser: opts.response\n  });\n};\nvar _model;\nvar AgenticModel = class {\n  constructor({\n    model,\n    requestParser: requestParser5,\n    responseParser: responseParser5\n  }) {\n    __privateAdd(this, _model);\n    __privateSet(this, _model, model);\n    this.requestParser = requestParser5;\n    this.responseParser = responseParser5;\n  }\n  async infer(stepID, input, tools, tool_choice) {\n    var _a, _b;\n    const body = this.requestParser(__privateGet(this, _model), input, tools, tool_choice);\n    let result;\n    const step = await getStepTools();\n    if (step) {\n      result = await step.ai.infer(stepID, {\n        model: __privateGet(this, _model),\n        body\n      });\n    } else {\n      const modelCopy = __spreadValues({}, __privateGet(this, _model));\n      (_b = (_a = __privateGet(this, _model)).onCall) == null ? void 0 : _b.call(_a, modelCopy, body);\n      const url = new URL(modelCopy.url || \"\");\n      const headers = {\n        \"Content-Type\": \"application/json\"\n      };\n      const formatHandlers = {\n        \"openai-chat\": () => {\n          headers[\"Authorization\"] = `Bearer ${modelCopy.authKey}`;\n        },\n        anthropic: () => {\n          headers[\"x-api-key\"] = modelCopy.authKey;\n          headers[\"anthropic-version\"] = \"2023-06-01\";\n        },\n        gemini: () => {\n        },\n        grok: () => {\n        }\n      };\n      formatHandlers[modelCopy.format]();\n      result = await (await fetch(url, {\n        method: \"POST\",\n        headers,\n        body: JSON.stringify(body)\n      })).json();\n    }\n    return { output: this.responseParser(result), raw: result };\n  }\n};\n_model = new WeakMap();\n\n// src/agent.ts\nvar createAgent = (opts) => new Agent(opts);\nvar createRoutingAgent = (opts) => new RoutingAgent(opts);\nvar Agent = class _Agent {\n  constructor(opts) {\n    this.name = opts.name;\n    this.description = opts.description || \"\";\n    this.system = opts.system;\n    this.assistant = opts.assistant || \"\";\n    this.tools = /* @__PURE__ */ new Map();\n    this.tool_choice = opts.tool_choice;\n    this.lifecycles = opts.lifecycle;\n    this.model = opts.model;\n    this.history = opts.history;\n    this.setTools(opts.tools);\n    this.mcpServers = opts.mcpServers;\n    this._mcpClients = [];\n  }\n  setTools(tools) {\n    for (const tool of tools || []) {\n      if (isInngestFn(tool)) {\n        this.tools.set(tool[\"absoluteId\"], {\n          name: tool[\"absoluteId\"],\n          description: tool.description,\n          // TODO Should we error here if we can't find an input schema?\n          parameters: getInngestFnInput(tool),\n          handler: async (input, opts) => {\n            const step = await getStepTools();\n            if (!step) {\n              throw new Error(\"Inngest tool called outside of Inngest context\");\n            }\n            const stepId = `${opts.agent.name}/tools/${tool[\"absoluteId\"]}`;\n            return step.invoke(stepId, {\n              function: (0,inngest__WEBPACK_IMPORTED_MODULE_1__.referenceFunction)({\n                appId: tool[\"client\"][\"id\"],\n                functionId: tool.id()\n              }),\n              data: input\n            });\n          }\n        });\n      } else {\n        this.tools.set(tool.name, tool);\n      }\n    }\n  }\n  withModel(model) {\n    return new _Agent({\n      name: this.name,\n      description: this.description,\n      system: this.system,\n      assistant: this.assistant,\n      tools: Array.from(this.tools.values()),\n      lifecycle: this.lifecycles,\n      model\n    });\n  }\n  /**\n   * Run runs an agent with the given user input, treated as a user message.  If\n   * the input is an empty string, only the system prompt will execute.\n   */\n  async run(input, { model, network, state, maxIter = 0 } = {}) {\n    var _a, _b;\n    await this.initMCP();\n    const rawModel = model || this.model || (network == null ? void 0 : network.defaultModel);\n    if (!rawModel) {\n      throw new Error(\"No model provided to agent\");\n    }\n    const p = createAgenticModelFromAiAdapter(rawModel);\n    const s = state || (network == null ? void 0 : network.state) || new State();\n    const run = new NetworkRun(\n      network || createNetwork({ name: \"default\", agents: [] }),\n      s\n    );\n    await initializeThread({\n      state: s,\n      history: this.history,\n      input,\n      network: run\n    });\n    await loadThreadFromStorage({\n      state: s,\n      history: this.history,\n      input,\n      network: run\n    });\n    let history = s ? s.formatHistory() : [];\n    let prompt = await this.agentPrompt(input, run);\n    let result = new AgentResult(\n      this.name,\n      [],\n      [],\n      /* @__PURE__ */ new Date(),\n      prompt,\n      history,\n      \"\"\n    );\n    let hasMoreActions = true;\n    let iter = 0;\n    const initialResultCount = s.results.length;\n    do {\n      if ((_a = this.lifecycles) == null ? void 0 : _a.onStart) {\n        const modified = await this.lifecycles.onStart({\n          agent: this,\n          network: run,\n          input,\n          prompt,\n          history\n        });\n        if (modified.stop) {\n          return result;\n        }\n        prompt = modified.prompt;\n        history = modified.history;\n      }\n      const inference = await this.performInference(p, prompt, history, run);\n      hasMoreActions = Boolean(\n        this.tools.size > 0 && inference.output.length && inference.output[inference.output.length - 1].stop_reason !== \"stop\"\n      );\n      result = inference;\n      history = [...inference.output];\n      iter++;\n    } while (hasMoreActions && iter < maxIter);\n    if ((_b = this.lifecycles) == null ? void 0 : _b.onFinish) {\n      result = await this.lifecycles.onFinish({\n        agent: this,\n        network: run,\n        result\n      });\n    }\n    await saveThreadToStorage({\n      state: s,\n      history: this.history,\n      input,\n      initialResultCount,\n      network: run\n    });\n    return result;\n  }\n  async performInference(p, prompt, history, network) {\n    var _a;\n    const { output, raw } = await p.infer(\n      this.name,\n      prompt.concat(history),\n      Array.from(this.tools.values()),\n      this.tool_choice || \"auto\"\n    );\n    let result = new AgentResult(\n      this.name,\n      output,\n      [],\n      /* @__PURE__ */ new Date(),\n      prompt,\n      history,\n      typeof raw === \"string\" ? raw : JSON.stringify(raw)\n    );\n    if ((_a = this.lifecycles) == null ? void 0 : _a.onResponse) {\n      result = await this.lifecycles.onResponse({\n        agent: this,\n        network,\n        result\n      });\n    }\n    const toolCallOutput = await this.invokeTools(result.output, network);\n    if (toolCallOutput.length > 0) {\n      result.toolCalls = result.toolCalls.concat(toolCallOutput);\n    }\n    return result;\n  }\n  /**\n   * invokeTools takes output messages from an inference call then invokes any tools\n   * in the message responses.\n   */\n  async invokeTools(msgs, network) {\n    const output = [];\n    for (const msg of msgs) {\n      if (msg.type !== \"tool_call\") {\n        continue;\n      }\n      if (!Array.isArray(msg.tools)) {\n        continue;\n      }\n      for (const tool of msg.tools) {\n        const found = this.tools.get(tool.name);\n        if (!found) {\n          throw new Error(\n            `Inference requested a non-existent tool: ${tool.name}`\n          );\n        }\n        const result = await Promise.resolve(\n          found.handler(tool.input, {\n            agent: this,\n            network,\n            step: await getStepTools()\n          })\n        ).then((r) => {\n          return {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            data: typeof r === \"undefined\" ? `${tool.name} successfully executed` : r\n          };\n        }).catch((err) => {\n          return { error: (0,inngest_helpers_errors__WEBPACK_IMPORTED_MODULE_14__.serializeError)(err) };\n        });\n        output.push({\n          role: \"tool_result\",\n          type: \"tool_result\",\n          tool: {\n            type: \"tool\",\n            id: tool.id,\n            name: tool.name,\n            input: tool.input.arguments\n          },\n          content: result,\n          stop_reason: \"tool\"\n        });\n      }\n    }\n    return output;\n  }\n  async agentPrompt(input, network) {\n    const messages = [\n      {\n        type: \"text\",\n        role: \"system\",\n        content: typeof this.system === \"string\" ? this.system : await this.system({ network })\n      }\n    ];\n    if (input.length > 0) {\n      messages.push({ type: \"text\", role: \"user\", content: input });\n    }\n    if (this.assistant.length > 0) {\n      messages.push({\n        type: \"text\",\n        role: \"assistant\",\n        content: this.assistant\n      });\n    }\n    return messages;\n  }\n  // initMCP fetches all tools from the agent's MCP servers, adding them to the tool list.\n  // This is all that's necessary in order to enable MCP tool use within agents\n  async initMCP() {\n    if (!this.mcpServers || this._mcpClients.length >= this.mcpServers.length) {\n      return;\n    }\n    const promises = [];\n    for (const server of this.mcpServers) {\n      promises.push(this.listMCPTools(server));\n    }\n    await Promise.all(promises);\n  }\n  /**\n   * listMCPTools lists all available tools for a given MCP server\n   */\n  async listMCPTools(server) {\n    const client = await this.mcpClient(server);\n    this._mcpClients.push(client);\n    try {\n      const results = await client.request(\n        { method: \"tools/list\" },\n        _modelcontextprotocol_sdk_types_js__WEBPACK_IMPORTED_MODULE_13__.ListToolsResultSchema\n      );\n      results.tools.forEach((t) => {\n        const name = `${server.name}-${t.name}`;\n        let zschema;\n        try {\n          zschema = _dmitryrechkin_json_schema_to_zod__WEBPACK_IMPORTED_MODULE_6__.JSONSchemaToZod.convert(t.inputSchema);\n        } catch (e) {\n          zschema = void 0;\n        }\n        this.tools.set(name, {\n          name,\n          description: t.description,\n          parameters: zschema,\n          mcp: {\n            server,\n            tool: t\n          },\n          handler: async (input) => {\n            var _a;\n            const fn = () => client.callTool({\n              name: t.name,\n              arguments: input\n            });\n            const step = await getStepTools();\n            const result = await ((_a = step == null ? void 0 : step.run(name, fn)) != null ? _a : fn());\n            return result.content;\n          }\n        });\n      });\n    } catch (e) {\n      console.warn(\"error listing mcp tools\", e);\n    }\n  }\n  /**\n   * mcpClient creates a new MCP client for the given server.\n   */\n  async mcpClient(server) {\n    const transport = (() => {\n      switch (server.transport.type) {\n        case \"streamable-http\":\n          return new _modelcontextprotocol_sdk_client_streamableHttp_js__WEBPACK_IMPORTED_MODULE_8__.StreamableHTTPClientTransport(\n            new URL(server.transport.url),\n            {\n              requestInit: server.transport.requestInit,\n              authProvider: server.transport.authProvider,\n              reconnectionOptions: server.transport.reconnectionOptions,\n              sessionId: server.transport.sessionId\n            }\n          );\n        case \"sse\":\n          if (global.EventSource === void 0) {\n            global.EventSource = eventsource__WEBPACK_IMPORTED_MODULE_17__.EventSource;\n          }\n          return new _modelcontextprotocol_sdk_client_sse_js__WEBPACK_IMPORTED_MODULE_9__.SSEClientTransport(new URL(server.transport.url), {\n            eventSourceInit: server.transport.eventSourceInit,\n            requestInit: server.transport.requestInit\n          });\n        case \"ws\":\n          return new _modelcontextprotocol_sdk_client_websocket_js__WEBPACK_IMPORTED_MODULE_10__.WebSocketClientTransport(new URL(server.transport.url));\n        case \"stdio\": {\n          const { command, args, env } = server.transport;\n          const safeProcessEnv = Object.fromEntries(\n            Object.entries(process.env).filter(([, v]) => v !== void 0)\n          );\n          const finalEnv = __spreadValues(__spreadValues({}, safeProcessEnv), env);\n          return new _modelcontextprotocol_sdk_client_stdio_js__WEBPACK_IMPORTED_MODULE_11__.StdioClientTransport({\n            command,\n            args,\n            env: finalEnv\n          });\n        }\n      }\n    })();\n    const client = new _modelcontextprotocol_sdk_client_index_js__WEBPACK_IMPORTED_MODULE_7__.Client(\n      {\n        name: this.name,\n        // XXX: This version should change.\n        version: \"1.0.0\"\n      },\n      {\n        capabilities: {}\n      }\n    );\n    try {\n      await client.connect(transport);\n    } catch (e) {\n      console.warn(\"mcp server disconnected\", server, e);\n    }\n    return client;\n  }\n};\nvar RoutingAgent = class _RoutingAgent extends Agent {\n  constructor(opts) {\n    super(opts);\n    this.type = \"routing\";\n    this.lifecycles = opts.lifecycle;\n  }\n  withModel(model) {\n    return new _RoutingAgent({\n      name: this.name,\n      description: this.description,\n      system: this.system,\n      assistant: this.assistant,\n      tools: Array.from(this.tools.values()),\n      lifecycle: this.lifecycles,\n      model\n    });\n  }\n};\n\n// src/network.ts\nvar createNetwork = (opts) => new Network(opts);\nvar Network = class {\n  constructor({\n    name,\n    description,\n    agents,\n    defaultModel,\n    maxIter,\n    defaultState,\n    router,\n    defaultRouter,\n    history\n  }) {\n    this._counter = 0;\n    this.name = name;\n    this.description = description;\n    this.agents = /* @__PURE__ */ new Map();\n    this._agents = /* @__PURE__ */ new Map();\n    this.defaultModel = defaultModel;\n    this.router = defaultRouter != null ? defaultRouter : router;\n    this.maxIter = maxIter || 0;\n    this._stack = [];\n    this.history = history;\n    if (defaultState) {\n      this.state = defaultState;\n    } else {\n      this.state = createState();\n    }\n    for (const agent of agents) {\n      this.agents.set(agent.name, agent);\n      this._agents.set(agent.name, agent);\n    }\n  }\n  async availableAgents(networkRun = new NetworkRun(this, new State())) {\n    var _a;\n    const available = [];\n    const all = Array.from(this.agents.values());\n    for (const a of all) {\n      const enabled = (_a = a == null ? void 0 : a.lifecycles) == null ? void 0 : _a.enabled;\n      if (!enabled || await enabled({ agent: a, network: networkRun })) {\n        available.push(a);\n      }\n    }\n    return available;\n  }\n  /**\n   * addAgent adds a new agent to the network.\n   */\n  addAgent(agent) {\n    this.agents.set(agent.name, agent);\n  }\n  /**\n   * run handles a given request using the network of agents.  It is not\n   * concurrency-safe; you can only call run on a network once, as networks are\n   * stateful.\n   *\n   */\n  run(...[input, overrides]) {\n    var _a;\n    let state;\n    if (overrides == null ? void 0 : overrides.state) {\n      if (overrides.state instanceof State) {\n        state = overrides.state;\n      } else {\n        const stateObj = overrides.state;\n        state = new State({\n          data: stateObj.data || {},\n          messages: stateObj._messages || [],\n          results: stateObj._results || []\n        });\n      }\n    } else {\n      state = ((_a = this.state) == null ? void 0 : _a.clone()) || new State();\n    }\n    return new NetworkRun(this, state)[\"execute\"](input, overrides);\n  }\n};\nvar defaultRoutingAgent;\nvar getDefaultRoutingAgent = () => {\n  defaultRoutingAgent != null ? defaultRoutingAgent : defaultRoutingAgent = createRoutingAgent({\n    name: \"Default routing agent\",\n    description: \"Selects which agents to work on based off of the current prompt and input.\",\n    lifecycle: {\n      onRoute: ({ result }) => {\n        const tool = result.toolCalls[0];\n        if (!tool) {\n          return;\n        }\n        if (typeof tool.content === \"object\" && tool.content !== null && \"data\" in tool.content && typeof tool.content.data === \"string\") {\n          return [tool.content.data];\n        }\n        return;\n      }\n    },\n    tools: [\n      // This tool does nothing but ensure that the model responds with the\n      // agent name as valid JSON.\n      createTool({\n        name: \"select_agent\",\n        description: \"select an agent to handle the input, based off of the current conversation\",\n        parameters: zod__WEBPACK_IMPORTED_MODULE_4__.object({\n          name: zod__WEBPACK_IMPORTED_MODULE_4__.string().describe(\"The name of the agent that should handle the request\")\n        }).strict(),\n        handler: ({ name }, { network }) => {\n          if (typeof name !== \"string\") {\n            throw new Error(\"The routing agent requested an invalid agent\");\n          }\n          const agent = network.agents.get(name);\n          if (agent === void 0) {\n            throw new Error(\n              `The routing agent requested an agent that doesn't exist: ${name}`\n            );\n          }\n          return agent.name;\n        }\n      })\n    ],\n    tool_choice: \"select_agent\",\n    system: async ({ network }) => {\n      if (!network) {\n        throw new Error(\n          \"The routing agent can only be used within a network of agents\"\n        );\n      }\n      const agents = await (network == null ? void 0 : network.availableAgents());\n      return `You are the orchestrator between a group of agents.  Each agent is suited for a set of specific tasks, and has a name, instructions, and a set of tools.\n\nThe following agents are available:\n<agents>\n  ${agents.map((a) => {\n        return `\n    <agent>\n      <name>${a.name}</name>\n      <description>${a.description}</description>\n      <tools>${JSON.stringify(Array.from(a.tools.values()))}</tools>\n    </agent>`;\n      }).join(\"\\n\")}\n</agents>\n\nFollow the set of instructions:\n\n<instructions>\n  Think about the current history and status.  Determine which agent to use to handle the user's request, based off of the current agents and their tools.\n\n  Your aim is to thoroughly complete the request, thinking step by step, choosing the right agent based off of the context.\n</instructions>\n    `;\n    }\n  });\n  return defaultRoutingAgent;\n};\nvar NetworkRun = class extends Network {\n  constructor(network, state) {\n    super({\n      name: network.name,\n      description: network.description,\n      agents: Array.from(network.agents.values()),\n      defaultModel: network.defaultModel,\n      defaultState: network.state,\n      router: network.router,\n      maxIter: network.maxIter,\n      history: network.history\n    });\n    this.state = state;\n  }\n  run() {\n    throw new Error(\"NetworkRun does not support run\");\n  }\n  async availableAgents() {\n    return super.availableAgents(this);\n  }\n  /**\n   * Schedule is used to push an agent's run function onto the stack.\n   */\n  schedule(agentName) {\n    this[\"_stack\"].push(agentName);\n  }\n  async execute(...[input, overrides]) {\n    await initializeThread({\n      state: this.state,\n      history: this.history,\n      input,\n      network: this\n    });\n    await loadThreadFromStorage({\n      state: this.state,\n      history: this.history,\n      input,\n      network: this\n    });\n    const available = await this.availableAgents();\n    if (available.length === 0) {\n      throw new Error(\"no agents enabled in network\");\n    }\n    const initialResultCount = this.state.results.length;\n    const next = await this.getNextAgents(\n      input,\n      (overrides == null ? void 0 : overrides.router) || (overrides == null ? void 0 : overrides.defaultRouter) || this.router\n    );\n    if (!(next == null ? void 0 : next.length)) {\n      return this;\n    }\n    for (const agent of next) {\n      this.schedule(agent.name);\n    }\n    while (this._stack.length > 0 && (this.maxIter === 0 || this._counter < this.maxIter)) {\n      const agentName = this._stack.shift();\n      const agent = agentName && this._agents.get(agentName);\n      if (!agent) {\n        return this;\n      }\n      const call = await agent.run(input, { network: this, maxIter: 0 });\n      this._counter += 1;\n      this.state.appendResult(call);\n      const next2 = await this.getNextAgents(\n        input,\n        (overrides == null ? void 0 : overrides.router) || (overrides == null ? void 0 : overrides.defaultRouter) || this.router\n      );\n      for (const a of next2 || []) {\n        this.schedule(a.name);\n      }\n    }\n    await saveThreadToStorage({\n      state: this.state,\n      history: this.history,\n      input,\n      initialResultCount,\n      network: this\n    });\n    return this;\n  }\n  async getNextAgents(input, router) {\n    if (!router && !this.defaultModel) {\n      throw new Error(\n        \"No router or model defined in network.  You must pass a router or a default model to use the built-in agentic router.\"\n      );\n    }\n    if (!router) {\n      router = getDefaultRoutingAgent();\n    }\n    if (router instanceof RoutingAgent) {\n      return await this.getNextAgentsViaRoutingAgent(router, input);\n    }\n    const stack = this._stack.map((name) => {\n      const agent2 = this._agents.get(name);\n      if (!agent2) {\n        throw new Error(`unknown agent in the network stack: ${name}`);\n      }\n      return agent2;\n    });\n    const agent = await router({\n      input,\n      network: this,\n      stack,\n      lastResult: this.state.results.pop(),\n      callCount: this._counter\n    });\n    if (!agent) {\n      return;\n    }\n    if (agent instanceof RoutingAgent) {\n      return await this.getNextAgentsViaRoutingAgent(agent, input);\n    }\n    for (const a of Array.isArray(agent) ? agent : [agent]) {\n      if (!this._agents.has(a.name)) {\n        this._agents.set(a.name, a);\n      }\n    }\n    return Array.isArray(agent) ? agent : [agent];\n  }\n  async getNextAgentsViaRoutingAgent(routingAgent, input) {\n    const result = await routingAgent.run(input, {\n      network: this,\n      model: routingAgent.model || this.defaultModel\n    });\n    const agentNames = routingAgent.lifecycles.onRoute({\n      result,\n      agent: routingAgent,\n      network: this\n    });\n    return (agentNames || []).map((name) => this.agents.get(name)).filter(Boolean);\n  }\n};\n\n// src/history.ts\n\nasync function initializeThread(config) {\n  const { state, history, input, network } = config;\n  if (!history) return;\n  const step = await getStepTools();\n  if (!state.threadId && history.createThread) {\n    const { threadId } = await history.createThread({\n      state,\n      network,\n      input,\n      step\n    });\n    state.threadId = threadId;\n  } else if (!state.threadId && history.get) {\n    state.threadId = crypto.randomUUID();\n    if (history.createThread) {\n      await history.createThread({\n        state,\n        network,\n        input,\n        step\n      });\n    }\n  }\n}\nasync function loadThreadFromStorage(config) {\n  const { state, history, input, network } = config;\n  if (!(history == null ? void 0 : history.get) || !state.threadId || state.results.length > 0 || state.messages.length > 0) {\n    return;\n  }\n  const step = await getStepTools();\n  const historyResults = await history.get({\n    state,\n    network,\n    input,\n    step,\n    threadId: state.threadId\n  });\n  state.setResults(historyResults);\n}\nasync function saveThreadToStorage(config) {\n  const { state, history, input, initialResultCount, network } = config;\n  if (!(history == null ? void 0 : history.appendResults)) return;\n  const step = await getStepTools();\n  const newResults = state.getResultsFrom(initialResultCount);\n  const userMessage = input.trim() ? {\n    content: input,\n    role: \"user\",\n    timestamp: /* @__PURE__ */ new Date()\n  } : void 0;\n  await history.appendResults({\n    state,\n    network,\n    step,\n    newResults,\n    input,\n    threadId: state.threadId,\n    userMessage\n  });\n}\n\n\n//# sourceMappingURL=chunk-J76M4KLW.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWdlbnQta2l0L2Rpc3QvY2h1bmstSjc2TTRLTFcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RUFBOEUsNkRBQTZEO0FBQzNJO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MseUNBQU87QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0RBQWtELFdBQVcsb0JBQW9CO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvQ0FBb0MsSUFBSTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsS0FBSztBQUNwRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNpQjtBQUNqQjtBQUNBLFVBQVUsaUNBQWlDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLFlBQVksV0FBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsaUNBQWlDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLFVBQVUscURBQXFEO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBMEJFO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWdlbnQta2l0L2Rpc3QvY2h1bmstSjc2TTRLTFcuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2RlZlByb3BzID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXM7XG52YXIgX19nZXRPd25Qcm9wRGVzY3MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycztcbnZhciBfX2dldE93blByb3BTeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scztcbnZhciBfX2hhc093blByb3AgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIF9fcHJvcElzRW51bSA9IE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGU7XG52YXIgX190eXBlRXJyb3IgPSAobXNnKSA9PiB7XG4gIHRocm93IFR5cGVFcnJvcihtc2cpO1xufTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19zcHJlYWRQcm9wcyA9IChhLCBiKSA9PiBfX2RlZlByb3BzKGEsIF9fZ2V0T3duUHJvcERlc2NzKGIpKTtcbnZhciBfX2FjY2Vzc0NoZWNrID0gKG9iaiwgbWVtYmVyLCBtc2cpID0+IG1lbWJlci5oYXMob2JqKSB8fCBfX3R5cGVFcnJvcihcIkNhbm5vdCBcIiArIG1zZyk7XG52YXIgX19wcml2YXRlR2V0ID0gKG9iaiwgbWVtYmVyLCBnZXR0ZXIpID0+IChfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcInJlYWQgZnJvbSBwcml2YXRlIGZpZWxkXCIpLCBnZXR0ZXIgPyBnZXR0ZXIuY2FsbChvYmopIDogbWVtYmVyLmdldChvYmopKTtcbnZhciBfX3ByaXZhdGVBZGQgPSAob2JqLCBtZW1iZXIsIHZhbHVlKSA9PiBtZW1iZXIuaGFzKG9iaikgPyBfX3R5cGVFcnJvcihcIkNhbm5vdCBhZGQgdGhlIHNhbWUgcHJpdmF0ZSBtZW1iZXIgbW9yZSB0aGFuIG9uY2VcIikgOiBtZW1iZXIgaW5zdGFuY2VvZiBXZWFrU2V0ID8gbWVtYmVyLmFkZChvYmopIDogbWVtYmVyLnNldChvYmosIHZhbHVlKTtcbnZhciBfX3ByaXZhdGVTZXQgPSAob2JqLCBtZW1iZXIsIHZhbHVlLCBzZXR0ZXIpID0+IChfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcIndyaXRlIHRvIHByaXZhdGUgZmllbGRcIiksIHNldHRlciA/IHNldHRlci5jYWxsKG9iaiwgdmFsdWUpIDogbWVtYmVyLnNldChvYmosIHZhbHVlKSwgdmFsdWUpO1xuXG4vLyBzcmMvdHlwZXMudHNcbmltcG9ydCB4eGggZnJvbSBcInh4aGFzaGpzXCI7XG52YXIgX2NoZWNrc3VtO1xudmFyIEFnZW50UmVzdWx0ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihhZ2VudE5hbWUsIG91dHB1dCwgdG9vbENhbGxzLCBjcmVhdGVkQXQsIHByb21wdCwgaGlzdG9yeSwgcmF3KSB7XG4gICAgdGhpcy5hZ2VudE5hbWUgPSBhZ2VudE5hbWU7XG4gICAgdGhpcy5vdXRwdXQgPSBvdXRwdXQ7XG4gICAgdGhpcy50b29sQ2FsbHMgPSB0b29sQ2FsbHM7XG4gICAgdGhpcy5jcmVhdGVkQXQgPSBjcmVhdGVkQXQ7XG4gICAgdGhpcy5wcm9tcHQgPSBwcm9tcHQ7XG4gICAgdGhpcy5oaXN0b3J5ID0gaGlzdG9yeTtcbiAgICB0aGlzLnJhdyA9IHJhdztcbiAgICAvLyBjaGVja3N1bSBtZW1vaXplcyBhIGNoZWNrc3VtIHNvIHRoYXQgaXQgZG9lIHNub3QgaGF2ZSB0byBiZSBjYWxjdWxhdGVkIG1hbnkgdGltZXMuXG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9jaGVja3N1bSk7XG4gIH1cbiAgLyoqXG4gICAqIGV4cG9ydCByZXR1cm5zIGFsbCBmaWVsZHMgbmVjZXNzYXJ5IHRvIHN0b3JlIHRoZSBBZ2VudFJlc3VsdCBmb3IgZnV0dXJlIHVzZS5cbiAgICovXG4gIGV4cG9ydCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWdlbnROYW1lOiB0aGlzLmFnZW50TmFtZSxcbiAgICAgIG91dHB1dDogdGhpcy5vdXRwdXQsXG4gICAgICB0b29sQ2FsbHM6IHRoaXMudG9vbENhbGxzLFxuICAgICAgY3JlYXRlZEF0OiB0aGlzLmNyZWF0ZWRBdCxcbiAgICAgIGNoZWNrc3VtOiB0aGlzLmNoZWNrc3VtXG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogY2hlY2tzdW0gaXMgYSB1bmlxdWUgSUQgZm9yIHRoaXMgcmVzdWx0LlxuICAgKlxuICAgKiBJdCBpcyBnZW5lcmF0ZWQgYnkgdGFraW5nIGEgY2hlY2tzdW0gb2YgdGhlIG1lc3NhZ2Ugb3V0cHV0IGFuZCB0aGUgY3JlYXRlZCBhdCBkYXRlLlxuICAgKiBUaGlzIGFsbG93cyB5b3UgdG8gZGVkdXBlIGl0ZW1zIHdoZW4gc2F2aW5nIGNvbnZlcnNhdGlvbiBoaXN0b3J5LlxuICAgKi9cbiAgZ2V0IGNoZWNrc3VtKCkge1xuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX2NoZWNrc3VtKSA9PT0gdm9pZCAwKSB7XG4gICAgICBjb25zdCBpbnB1dCA9IEpTT04uc3RyaW5naWZ5KHRoaXMub3V0cHV0LmNvbmNhdCh0aGlzLnRvb2xDYWxscykpICsgdGhpcy5jcmVhdGVkQXQudG9TdHJpbmcoKTtcbiAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfY2hlY2tzdW0sIHh4aC5oNjQoaW5wdXQsIDApLnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9jaGVja3N1bSk7XG4gIH1cbn07XG5fY2hlY2tzdW0gPSBuZXcgV2Vha01hcCgpO1xuXG4vLyBzcmMvc3RhdGUudHNcbnZhciBjcmVhdGVTdGF0ZSA9IChpbml0aWFsU3RhdGUsIG9wdHMpID0+IHtcbiAgcmV0dXJuIG5ldyBTdGF0ZShfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBvcHRzKSwgeyBkYXRhOiBpbml0aWFsU3RhdGUgfSkpO1xufTtcbnZhciBfX2t2O1xudmFyIF9TdGF0ZSA9IGNsYXNzIF9TdGF0ZSB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgbWVzc2FnZXMsIHRocmVhZElkLCByZXN1bHRzIH0gPSB7fSkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9fa3YpO1xuICAgIHRoaXMuX3Jlc3VsdHMgPSByZXN1bHRzIHx8IFtdO1xuICAgIHRoaXMuX21lc3NhZ2VzID0gbWVzc2FnZXMgfHwgW107XG4gICAgdGhpcy5fZGF0YSA9IGRhdGEgPyBfX3NwcmVhZFZhbHVlcyh7fSwgZGF0YSkgOiB7fTtcbiAgICB0aGlzLnRocmVhZElkID0gdGhyZWFkSWQ7XG4gICAgdGhpcy5kYXRhID0gbmV3IFByb3h5KHRoaXMuX2RhdGEsIHtcbiAgICAgIHNldDogKHRhcmdldCwgcHJvcCwgdmFsdWUpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wID09PSBcInN0cmluZ1wiICYmIHByb3AgaW4gdGFyZ2V0KSB7XG4gICAgICAgICAgUmVmbGVjdC5zZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFJlZmxlY3Quc2V0KHRhcmdldCwgcHJvcCwgdmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfX2t2LCBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKHRoaXMuX2RhdGEpKSk7XG4gICAgdGhpcy5rdiA9IHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICBzZXQ6IChrZXksIHZhbHVlKSA9PiB7XG4gICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfX2t2KS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICB9LFxuICAgICAgZ2V0OiAoa2V5KSA9PiB7XG4gICAgICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX19rdikuZ2V0KGtleSk7XG4gICAgICB9LFxuICAgICAgZGVsZXRlOiAoa2V5KSA9PiB7XG4gICAgICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX19rdikuZGVsZXRlKGtleSk7XG4gICAgICB9LFxuICAgICAgaGFzOiAoa2V5KSA9PiB7XG4gICAgICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX19rdikuaGFzKGtleSk7XG4gICAgICB9LFxuICAgICAgYWxsOiAoKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZnJvbUVudHJpZXMoX19wcml2YXRlR2V0KHRoaXMsIF9fa3YpKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIC8qKlxuICAgKiBSZXN1bHRzIHJldHVybnMgYSBuZXcgYXJyYXkgY29udGFpbmluZyBhbGwgcGFzdCBpbmZlcmVuY2UgcmVzdWx0cyBpbiB0aGVcbiAgICogbmV0d29yay4gVGhpcyBhcnJheSBpcyBzYWZlIHRvIG1vZGlmeS5cbiAgICovXG4gIGdldCByZXN1bHRzKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXN1bHRzLnNsaWNlKCk7XG4gIH1cbiAgLyoqXG4gICAqIFJlcGxhY2VzIGFsbCByZXN1bHRzIHdpdGggdGhlIHByb3ZpZGVkIGFycmF5XG4gICAqIHVzZWQgd2hlbiBsb2FkaW5nIGluaXRpYWwgcmVzdWx0cyBmcm9tIGhpc3RvcnkuZ2V0KClcbiAgICovXG4gIHNldFJlc3VsdHMocmVzdWx0cykge1xuICAgIHRoaXMuX3Jlc3VsdHMgPSByZXN1bHRzO1xuICB9XG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgc2xpY2Ugb2YgcmVzdWx0cyBmcm9tIHRoZSBnaXZlbiBzdGFydCBpbmRleFxuICAgKiB1c2VkIHdoZW4gc2F2aW5nIHJlc3VsdHMgdG8gYSBkYXRhYmFzZSB2aWEgaGlzdG9yeS5hcHBlbmRSZXN1bHRzKClcbiAgICovXG4gIGdldFJlc3VsdHNGcm9tKHN0YXJ0SW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVzdWx0cy5zbGljZShzdGFydEluZGV4KTtcbiAgfVxuICAvKipcbiAgICogTWVzc2FnZXMgcmV0dXJucyBhIG5ldyBhcnJheSBjb250YWluaW5nIGFsbCBpbml0aWFsIG1lc3NhZ2VzIHRoYXQgd2VyZVxuICAgKiBwcm92aWRlZCB0byB0aGUgY29uc3RydWN0b3IuIFRoaXMgYXJyYXkgaXMgc2FmZSB0byBtb2RpZnkuXG4gICAqL1xuICBnZXQgbWVzc2FnZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX21lc3NhZ2VzLnNsaWNlKCk7XG4gIH1cbiAgLyoqXG4gICAqIGZvcm1hdEhpc3RvcnkgcmV0dXJucyB0aGUgbWVtb3J5IHVzZWQgZm9yIGFnZW50aWMgY2FsbHMgYmFzZWQgb2ZmIG9mIHByaW9yXG4gICAqIGFnZW50aWMgY2FsbHMuXG4gICAqXG4gICAqIFRoaXMgaXMgdXNlZCB0byBmb3JtYXQgdGhlIGN1cnJlbnQgU3RhdGUgYXMgYSBjb252ZXJzYXRpb24gbG9nIHdoZW5cbiAgICogY2FsbGluZyBhbiBpbmRpdmlkdWFsIGFnZW50LlxuICAgKlxuICAgKi9cbiAgZm9ybWF0SGlzdG9yeShmb3JtYXR0ZXIpIHtcbiAgICBpZiAoIWZvcm1hdHRlcikge1xuICAgICAgZm9ybWF0dGVyID0gZGVmYXVsdFJlc3VsdEZvcm1hdHRlcjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX21lc3NhZ2VzLmNvbmNhdChcbiAgICAgIHRoaXMuX3Jlc3VsdHMubWFwKChyZXN1bHQpID0+IGZvcm1hdHRlcihyZXN1bHQpKS5mbGF0KClcbiAgICApO1xuICB9XG4gIC8qKlxuICAgKiBhcHBlbmRSZXN1bHQgYXBwZW5kcyBhIGdpdmVuIHJlc3VsdCB0byB0aGUgY3VycmVudCBzdGF0ZS4gIFRoaXNcbiAgICogaXMgY2FsbGVkIGJ5IHRoZSBuZXR3b3JrIGFmdGVyIGVhY2ggaXRlcmF0aW9uLlxuICAgKi9cbiAgYXBwZW5kUmVzdWx0KGNhbGwpIHtcbiAgICB0aGlzLl9yZXN1bHRzLnB1c2goY2FsbCk7XG4gIH1cbiAgLyoqXG4gICAqIGNsb25lIGFsbG93cyB5b3UgdG8gc2FmZWx5IGNsb25lIHRoZSBzdGF0ZS5cbiAgICovXG4gIGNsb25lKCkge1xuICAgIGNvbnN0IHN0YXRlID0gbmV3IF9TdGF0ZSh7XG4gICAgICBkYXRhOiB0aGlzLmRhdGEsXG4gICAgICB0aHJlYWRJZDogdGhpcy50aHJlYWRJZCxcbiAgICAgIG1lc3NhZ2VzOiB0aGlzLl9tZXNzYWdlcy5zbGljZSgpLFxuICAgICAgcmVzdWx0czogdGhpcy5fcmVzdWx0cy5zbGljZSgpXG4gICAgfSk7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG59O1xuX19rdiA9IG5ldyBXZWFrTWFwKCk7XG52YXIgU3RhdGUgPSBfU3RhdGU7XG52YXIgZGVmYXVsdFJlc3VsdEZvcm1hdHRlciA9IChyKSA9PiB7XG4gIHJldHVybiBbXS5jb25jYXQoci5vdXRwdXQpLmNvbmNhdChyLnRvb2xDYWxscyk7XG59O1xuXG4vLyBzcmMvdXRpbC50c1xuaW1wb3J0IFwiaW5uZ2VzdFwiO1xuaW1wb3J0IHsgSW5uZ2VzdEZ1bmN0aW9uIH0gZnJvbSBcImlubmdlc3QvY29tcG9uZW50cy9Jbm5nZXN0RnVuY3Rpb25cIjtcbmltcG9ydCB7IGdldEFzeW5jQ3R4IH0gZnJvbSBcImlubmdlc3QvZXhwZXJpbWVudGFsXCI7XG5pbXBvcnQgeyBab2RUeXBlIH0gZnJvbSBcInpvZFwiO1xudmFyIHN0cmluZ2lmeUVycm9yID0gKGUpID0+IHtcbiAgaWYgKGUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHJldHVybiBlLm1lc3NhZ2U7XG4gIH1cbiAgcmV0dXJuIFN0cmluZyhlKTtcbn07XG52YXIgZ2V0U3RlcFRvb2xzID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCBhc3luY0N0eCA9IGF3YWl0IGdldEFzeW5jQ3R4KCk7XG4gIHJldHVybiBhc3luY0N0eCA9PSBudWxsID8gdm9pZCAwIDogYXN5bmNDdHguY3R4LnN0ZXA7XG59O1xudmFyIGlzSW5uZ2VzdEZuID0gKGZuKSA9PiB7XG4gIGlmIChmbiBpbnN0YW5jZW9mIElubmdlc3RGdW5jdGlvbikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICh0eXBlb2YgZm4gPT09IFwib2JqZWN0XCIgJiYgZm4gIT09IG51bGwgJiYgXCJjcmVhdGVFeGVjdXRpb25cIiBpbiBmbiAmJiB0eXBlb2YgZm4uY3JlYXRlRXhlY3V0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xudmFyIGdldElubmdlc3RGbklucHV0ID0gKGZuKSA9PiB7XG4gIHZhciBfYSwgX2IsIF9jO1xuICBjb25zdCBydW50aW1lU2NoZW1hcyA9IChfYSA9IGZuW1wiY2xpZW50XCJdW1wic2NoZW1hc1wiXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hW1wicnVudGltZVNjaGVtYXNcIl07XG4gIGlmICghcnVudGltZVNjaGVtYXMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qgc2NoZW1hc1RvQXR0ZW1wdCA9IG5ldyBTZXQoXG4gICAgKF9jID0gKF9iID0gZm5bXCJvcHRzXCJdLnRyaWdnZXJzKSA9PSBudWxsID8gdm9pZCAwIDogX2IucmVkdWNlKChhY2MsIHRyaWdnZXIpID0+IHtcbiAgICAgIGlmICh0cmlnZ2VyLmV2ZW50KSB7XG4gICAgICAgIHJldHVybiBbLi4uYWNjLCB0cmlnZ2VyLmV2ZW50XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwgW10pKSAhPSBudWxsID8gX2MgOiBbXVxuICApO1xuICBpZiAoIXNjaGVtYXNUb0F0dGVtcHQuc2l6ZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBsZXQgc2NoZW1hO1xuICBmb3IgKGNvbnN0IGV2ZW50U2NoZW1hIG9mIHNjaGVtYXNUb0F0dGVtcHQpIHtcbiAgICBjb25zdCBydW50aW1lU2NoZW1hID0gcnVudGltZVNjaGVtYXNbZXZlbnRTY2hlbWFdO1xuICAgIGlmICh0eXBlb2YgcnVudGltZVNjaGVtYSA9PT0gXCJvYmplY3RcIiAmJiBydW50aW1lU2NoZW1hICE9PSBudWxsICYmIFwiZGF0YVwiIGluIHJ1bnRpbWVTY2hlbWEgJiYgaGVscGVycy5pc1pvZE9iamVjdChydW50aW1lU2NoZW1hLmRhdGEpKSB7XG4gICAgICBpZiAoc2NoZW1hKSB7XG4gICAgICAgIHNjaGVtYSA9IHNjaGVtYS5vcihydW50aW1lU2NoZW1hLmRhdGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2NoZW1hID0gcnVudGltZVNjaGVtYS5kYXRhO1xuICAgICAgfVxuICAgICAgY29udGludWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBzY2hlbWE7XG59O1xudmFyIGhlbHBlcnMgPSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIGlzWm9kT2JqZWN0OiAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBab2RUeXBlICYmIHZhbHVlLl9kZWYudHlwZU5hbWUgPT09IFwiWm9kT2JqZWN0XCI7XG4gIH0sXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIGlzT2JqZWN0OiAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsICYmICFBcnJheS5pc0FycmF5KHZhbHVlKTtcbiAgfVxufTtcblxuLy8gc3JjL25ldHdvcmsudHNcbmltcG9ydCBcIkBpbm5nZXN0L2FpXCI7XG5pbXBvcnQgeyB6IGFzIHozIH0gZnJvbSBcInpvZFwiO1xuXG4vLyBzcmMvYWdlbnQudHNcbmltcG9ydCB7XG4gIEpTT05TY2hlbWFUb1pvZFxufSBmcm9tIFwiQGRtaXRyeXJlY2hraW4vanNvbi1zY2hlbWEtdG8tem9kXCI7XG5pbXBvcnQgXCJAaW5uZ2VzdC9haVwiO1xuaW1wb3J0IHsgQ2xpZW50IGFzIE1DUENsaWVudCB9IGZyb20gXCJAbW9kZWxjb250ZXh0cHJvdG9jb2wvc2RrL2NsaWVudC9pbmRleC5qc1wiO1xuaW1wb3J0IHsgU3RyZWFtYWJsZUhUVFBDbGllbnRUcmFuc3BvcnQgfSBmcm9tIFwiQG1vZGVsY29udGV4dHByb3RvY29sL3Nkay9jbGllbnQvc3RyZWFtYWJsZUh0dHAuanNcIjtcbmltcG9ydCB7IFNTRUNsaWVudFRyYW5zcG9ydCB9IGZyb20gXCJAbW9kZWxjb250ZXh0cHJvdG9jb2wvc2RrL2NsaWVudC9zc2UuanNcIjtcbmltcG9ydCB7IFdlYlNvY2tldENsaWVudFRyYW5zcG9ydCB9IGZyb20gXCJAbW9kZWxjb250ZXh0cHJvdG9jb2wvc2RrL2NsaWVudC93ZWJzb2NrZXQuanNcIjtcbmltcG9ydCB7IFN0ZGlvQ2xpZW50VHJhbnNwb3J0IH0gZnJvbSBcIkBtb2RlbGNvbnRleHRwcm90b2NvbC9zZGsvY2xpZW50L3N0ZGlvLmpzXCI7XG5pbXBvcnQgXCJAbW9kZWxjb250ZXh0cHJvdG9jb2wvc2RrL3NoYXJlZC90cmFuc3BvcnQuanNcIjtcbmltcG9ydCB7IExpc3RUb29sc1Jlc3VsdFNjaGVtYSB9IGZyb20gXCJAbW9kZWxjb250ZXh0cHJvdG9jb2wvc2RrL3R5cGVzLmpzXCI7XG5pbXBvcnQgeyBFdmVudFNvdXJjZSB9IGZyb20gXCJldmVudHNvdXJjZVwiO1xuaW1wb3J0IHsgcmVmZXJlbmNlRnVuY3Rpb24gfSBmcm9tIFwiaW5uZ2VzdFwiO1xuaW1wb3J0IFwiaW5uZ2VzdC9jb21wb25lbnRzL0lubmdlc3RGdW5jdGlvblwiO1xuaW1wb3J0IHsgc2VyaWFsaXplRXJyb3IgfSBmcm9tIFwiaW5uZ2VzdC9oZWxwZXJzL2Vycm9yc1wiO1xuaW1wb3J0IFwiaW5uZ2VzdC90eXBlc1wiO1xuXG4vLyBzcmMvbW9kZWwudHNcbmltcG9ydCBcIkBpbm5nZXN0L2FpXCI7XG5cbi8vIHNyYy9hZGFwdGVycy9pbmRleC50c1xuaW1wb3J0IFwiQGlubmdlc3QvYWlcIjtcblxuLy8gc3JjL2FkYXB0ZXJzL2FudGhyb3BpYy50c1xuaW1wb3J0IFwiQGlubmdlc3QvYWlcIjtcbmltcG9ydCB7IHpvZFRvSnNvblNjaGVtYSB9IGZyb20gXCJ6b2QtdG8tanNvbi1zY2hlbWFcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5cbi8vIHNyYy90b29sLnRzXG5pbXBvcnQgXCJpbm5nZXN0XCI7XG5pbXBvcnQgXCJ6b2RcIjtcbmZ1bmN0aW9uIGNyZWF0ZVRvb2woe1xuICBuYW1lLFxuICBkZXNjcmlwdGlvbixcbiAgcGFyYW1ldGVycyxcbiAgaGFuZGxlclxufSkge1xuICByZXR1cm4ge1xuICAgIG5hbWUsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgcGFyYW1ldGVycyxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGhhbmRsZXJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgfTtcbn1cblxuLy8gc3JjL2FkYXB0ZXJzL2FudGhyb3BpYy50c1xudmFyIHJlcXVlc3RQYXJzZXIgPSAobW9kZWwsIG1lc3NhZ2VzLCB0b29scywgdG9vbF9jaG9pY2UgPSBcImF1dG9cIikgPT4ge1xuICBjb25zdCBzeXN0ZW1NZXNzYWdlID0gbWVzc2FnZXMuZmluZChcbiAgICAobSkgPT4gbS5yb2xlID09PSBcInN5c3RlbVwiICYmIG0udHlwZSA9PT0gXCJ0ZXh0XCJcbiAgKTtcbiAgY29uc3Qgc3lzdGVtID0gdHlwZW9mIChzeXN0ZW1NZXNzYWdlID09IG51bGwgPyB2b2lkIDAgOiBzeXN0ZW1NZXNzYWdlLmNvbnRlbnQpID09PSBcInN0cmluZ1wiID8gc3lzdGVtTWVzc2FnZS5jb250ZW50IDogXCJcIjtcbiAgY29uc3QgYW50aHJvcGljTWVzc2FnZXMgPSBtZXNzYWdlcy5maWx0ZXIoKG0pID0+IG0ucm9sZSAhPT0gXCJzeXN0ZW1cIikucmVkdWNlKFxuICAgIChhY2MsIG0pID0+IHtcbiAgICAgIHN3aXRjaCAobS50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcm9sZTogbS5yb2xlLFxuICAgICAgICAgICAgICBjb250ZW50OiBBcnJheS5pc0FycmF5KG0uY29udGVudCkgPyBtLmNvbnRlbnQubWFwKCh0ZXh0KSA9PiAoeyB0eXBlOiBcInRleHRcIiwgdGV4dCB9KSkgOiBtLmNvbnRlbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdO1xuICAgICAgICBjYXNlIFwidG9vbF9jYWxsXCI6XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcm9sZTogbS5yb2xlLFxuICAgICAgICAgICAgICBjb250ZW50OiBtLnRvb2xzLm1hcCgodG9vbCkgPT4gKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInRvb2xfdXNlXCIsXG4gICAgICAgICAgICAgICAgaWQ6IHRvb2wuaWQsXG4gICAgICAgICAgICAgICAgaW5wdXQ6IHRvb2wuaW5wdXQsXG4gICAgICAgICAgICAgICAgbmFtZTogdG9vbC5uYW1lXG4gICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF07XG4gICAgICAgIGNhc2UgXCJ0b29sX3Jlc3VsdFwiOlxuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAuLi5hY2MsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0b29sX3Jlc3VsdFwiLFxuICAgICAgICAgICAgICAgICAgdG9vbF91c2VfaWQ6IG0udG9vbC5pZCxcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHR5cGVvZiBtLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgPyBtLmNvbnRlbnQgOiBKU09OLnN0cmluZ2lmeShtLmNvbnRlbnQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtdXG4gICk7XG4gIGNvbnN0IGxhc3RNZXNzYWdlID0gYW50aHJvcGljTWVzc2FnZXNbYW50aHJvcGljTWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gIGlmICgobGFzdE1lc3NhZ2UgPT0gbnVsbCA/IHZvaWQgMCA6IGxhc3RNZXNzYWdlLnJvbGUpID09PSBcImFzc2lzdGFudFwiKSB7XG4gICAgbGFzdE1lc3NhZ2Uucm9sZSA9IFwidXNlclwiO1xuICB9XG4gIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgc3lzdGVtLFxuICAgIG1vZGVsOiBtb2RlbC5vcHRpb25zLm1vZGVsLFxuICAgIG1heF90b2tlbnM6IG1vZGVsLm9wdGlvbnMuZGVmYXVsdFBhcmFtZXRlcnMubWF4X3Rva2VucyxcbiAgICBtZXNzYWdlczogYW50aHJvcGljTWVzc2FnZXNcbiAgfTtcbiAgaWYgKHRvb2xzID09IG51bGwgPyB2b2lkIDAgOiB0b29scy5sZW5ndGgpIHtcbiAgICByZXF1ZXN0LnRvb2xzID0gdG9vbHMubWFwKCh0KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiB0Lm5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiB0LmRlc2NyaXB0aW9uLFxuICAgICAgICBpbnB1dF9zY2hlbWE6IHQucGFyYW1ldGVycyA/IHpvZFRvSnNvblNjaGVtYSh0LnBhcmFtZXRlcnMpIDogem9kVG9Kc29uU2NoZW1hKFxuICAgICAgICAgIHoub2JqZWN0KHt9KVxuICAgICAgICApXG4gICAgICB9O1xuICAgIH0pO1xuICAgIHJlcXVlc3QudG9vbF9jaG9pY2UgPSB0b29sQ2hvaWNlKHRvb2xfY2hvaWNlKTtcbiAgfVxuICByZXR1cm4gcmVxdWVzdDtcbn07XG52YXIgcmVzcG9uc2VQYXJzZXIgPSAoaW5wdXQpID0+IHtcbiAgdmFyIF9hLCBfYjtcbiAgaWYgKGlucHV0LnR5cGUgPT09IFwiZXJyb3JcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICgoX2EgPSBpbnB1dC5lcnJvcikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm1lc3NhZ2UpIHx8IGBBbnRocm9waWMgcmVxdWVzdCBmYWlsZWQ6ICR7SlNPTi5zdHJpbmdpZnkoaW5wdXQuZXJyb3IpfWBcbiAgICApO1xuICB9XG4gIHJldHVybiAoKF9iID0gaW5wdXQgPT0gbnVsbCA/IHZvaWQgMCA6IGlucHV0LmNvbnRlbnQpICE9IG51bGwgPyBfYiA6IFtdKS5yZWR1Y2UoKGFjYywgaXRlbSkgPT4ge1xuICAgIGlmICghaXRlbS50eXBlKSB7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH1cbiAgICBzd2l0Y2ggKGl0ZW0udHlwZSkge1xuICAgICAgY2FzZSBcInRleHRcIjpcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAuLi5hY2MsXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICByb2xlOiBpbnB1dC5yb2xlLFxuICAgICAgICAgICAgY29udGVudDogaXRlbS50ZXh0LFxuICAgICAgICAgICAgLy8gWFhYOiBCZXR0ZXIgc3RvcCByZWFzb24gcGFyc2luZ1xuICAgICAgICAgICAgc3RvcF9yZWFzb246IFwic3RvcFwiXG4gICAgICAgICAgfVxuICAgICAgICBdO1xuICAgICAgY2FzZSBcInRvb2xfdXNlXCI6IHtcbiAgICAgICAgbGV0IGFyZ3M7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXJncyA9IHR5cGVvZiBpdGVtLmlucHV0ID09PSBcInN0cmluZ1wiID8gSlNPTi5wYXJzZShpdGVtLmlucHV0KSA6IGl0ZW0uaW5wdXQ7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBhcmdzID0gaXRlbS5pbnB1dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiBcInRvb2xfY2FsbFwiLFxuICAgICAgICAgICAgcm9sZTogaW5wdXQucm9sZSxcbiAgICAgICAgICAgIHN0b3BfcmVhc29uOiBcInRvb2xcIixcbiAgICAgICAgICAgIHRvb2xzOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInRvb2xcIixcbiAgICAgICAgICAgICAgICBpZDogaXRlbS5pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxuICAgICAgICAgICAgICAgIGlucHV0OiBhcmdzXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgICB9XG4gICAgfVxuICB9LCBbXSk7XG59O1xudmFyIHRvb2xDaG9pY2UgPSAoY2hvaWNlKSA9PiB7XG4gIHN3aXRjaCAoY2hvaWNlKSB7XG4gICAgY2FzZSBcImF1dG9cIjpcbiAgICAgIHJldHVybiB7IHR5cGU6IFwiYXV0b1wiIH07XG4gICAgY2FzZSBcImFueVwiOlxuICAgICAgcmV0dXJuIHsgdHlwZTogXCJhbnlcIiB9O1xuICAgIGRlZmF1bHQ6XG4gICAgICBpZiAodHlwZW9mIGNob2ljZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6IFwidG9vbFwiLFxuICAgICAgICAgIG5hbWU6IGNob2ljZVxuICAgICAgICB9O1xuICAgICAgfVxuICB9XG59O1xuXG4vLyBzcmMvYWRhcHRlcnMvb3BlbmFpLnRzXG5pbXBvcnQgXCJAaW5uZ2VzdC9haVwiO1xuaW1wb3J0IHsgem9kVG9Kc29uU2NoZW1hIGFzIHpvZFRvSnNvblNjaGVtYTIgfSBmcm9tIFwiem9kLXRvLWpzb24tc2NoZW1hXCI7XG52YXIgcmVxdWVzdFBhcnNlcjIgPSAobW9kZWwsIG1lc3NhZ2VzLCB0b29scywgdG9vbF9jaG9pY2UgPSBcImF1dG9cIikgPT4ge1xuICB2YXIgX2EsIF9iO1xuICBjb25zdCByZXF1ZXN0ID0ge1xuICAgIG1lc3NhZ2VzOiBtZXNzYWdlcy5tYXAoKG0pID0+IHtcbiAgICAgIHZhciBfYTI7XG4gICAgICBzd2l0Y2ggKG0udHlwZSkge1xuICAgICAgICBjYXNlIFwidGV4dFwiOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByb2xlOiBtLnJvbGUsXG4gICAgICAgICAgICBjb250ZW50OiBtLmNvbnRlbnRcbiAgICAgICAgICB9O1xuICAgICAgICBjYXNlIFwidG9vbF9jYWxsXCI6XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgICBjb250ZW50OiBudWxsLFxuICAgICAgICAgICAgdG9vbF9jYWxsczogbS50b29scyA/IChfYTIgPSBtLnRvb2xzKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLm1hcCgodG9vbCkgPT4gKHtcbiAgICAgICAgICAgICAgaWQ6IHRvb2wuaWQsXG4gICAgICAgICAgICAgIHR5cGU6IFwiZnVuY3Rpb25cIixcbiAgICAgICAgICAgICAgZnVuY3Rpb246IHtcbiAgICAgICAgICAgICAgICBuYW1lOiB0b29sLm5hbWUsXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBKU09OLnN0cmluZ2lmeSh0b29sLmlucHV0KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSkgOiB2b2lkIDBcbiAgICAgICAgICB9O1xuICAgICAgICBjYXNlIFwidG9vbF9yZXN1bHRcIjpcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcm9sZTogXCJ0b29sXCIsXG4gICAgICAgICAgICB0b29sX2NhbGxfaWQ6IG0udG9vbC5pZCxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHR5cGVvZiBtLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgPyBtLmNvbnRlbnQgOiBKU09OLnN0cmluZ2lmeShtLmNvbnRlbnQpXG4gICAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KVxuICB9O1xuICBpZiAodG9vbHMgPT0gbnVsbCA/IHZvaWQgMCA6IHRvb2xzLmxlbmd0aCkge1xuICAgIHJlcXVlc3QudG9vbF9jaG9pY2UgPSB0b29sQ2hvaWNlMih0b29sX2Nob2ljZSk7XG4gICAgaWYgKCEoKF9hID0gbW9kZWwub3B0aW9ucy5tb2RlbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwibzNcIikpICYmICEoKF9iID0gbW9kZWwub3B0aW9ucy5tb2RlbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLmluY2x1ZGVzKFwibzFcIikpKSB7XG4gICAgICByZXF1ZXN0LnBhcmFsbGVsX3Rvb2xfY2FsbHMgPSBmYWxzZTtcbiAgICB9XG4gICAgcmVxdWVzdC50b29scyA9IHRvb2xzLm1hcCgodCkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJmdW5jdGlvblwiLFxuICAgICAgICBmdW5jdGlvbjoge1xuICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdC5kZXNjcmlwdGlvbixcbiAgICAgICAgICBwYXJhbWV0ZXJzOiB0LnBhcmFtZXRlcnMgJiYgem9kVG9Kc29uU2NoZW1hMih0LnBhcmFtZXRlcnMsIHsgdGFyZ2V0OiBcIm9wZW5BaVwiIH0pLFxuICAgICAgICAgIHN0cmljdDogdHlwZW9mIHQuc3RyaWN0ICE9PSBcInVuZGVmaW5lZFwiID8gdC5zdHJpY3QgOiBCb29sZWFuKHQucGFyYW1ldGVycylcbiAgICAgICAgICAvLyBzdHJpY3QgbW9kZSBpcyBvbmx5IHN1cHBvcnRlZCB3aXRoIHBhcmFtZXRlcnNcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcmVxdWVzdDtcbn07XG52YXIgcmVzcG9uc2VQYXJzZXIyID0gKGlucHV0KSA9PiB7XG4gIHZhciBfYTtcbiAgaWYgKGlucHV0LmVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgaW5wdXQuZXJyb3IubWVzc2FnZSB8fCBgT3BlbkFJIHJlcXVlc3QgZmFpbGVkOiAke0pTT04uc3RyaW5naWZ5KGlucHV0LmVycm9yKX1gXG4gICAgKTtcbiAgfVxuICByZXR1cm4gKChfYSA9IGlucHV0ID09IG51bGwgPyB2b2lkIDAgOiBpbnB1dC5jaG9pY2VzKSAhPSBudWxsID8gX2EgOiBbXSkucmVkdWNlKChhY2MsIGNob2ljZSkgPT4ge1xuICAgIHZhciBfYTIsIF9iO1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgZmluaXNoX3JlYXNvbiB9ID0gY2hvaWNlO1xuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9XG4gICAgY29uc3QgYmFzZSA9IHtcbiAgICAgIHJvbGU6IGNob2ljZS5tZXNzYWdlLnJvbGUsXG4gICAgICBzdG9wX3JlYXNvbjogb3BlbkFpU3RvcFJlYXNvblRvU3RhdGVTdG9wUmVhc29uW2ZpbmlzaF9yZWFzb24gIT0gbnVsbCA/IGZpbmlzaF9yZWFzb24gOiBcIlwiXSB8fCBcInN0b3BcIlxuICAgIH07XG4gICAgaWYgKG1lc3NhZ2UuY29udGVudCAmJiBtZXNzYWdlLmNvbnRlbnQudHJpbSgpICE9PSBcIlwiKSB7XG4gICAgICBhY2MucHVzaChfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBiYXNlKSwge1xuICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50XG4gICAgICB9KSk7XG4gICAgfVxuICAgIGlmICgoKF9iID0gKF9hMiA9IG1lc3NhZ2UudG9vbF9jYWxscykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5sZW5ndGgpICE9IG51bGwgPyBfYiA6IDApID4gMCkge1xuICAgICAgYWNjLnB1c2goX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgYmFzZSksIHtcbiAgICAgICAgdHlwZTogXCJ0b29sX2NhbGxcIixcbiAgICAgICAgdG9vbHM6IG1lc3NhZ2UudG9vbF9jYWxscy5tYXAoKHRvb2wpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJ0b29sXCIsXG4gICAgICAgICAgICBpZDogdG9vbC5pZCxcbiAgICAgICAgICAgIG5hbWU6IHRvb2wuZnVuY3Rpb24ubmFtZSxcbiAgICAgICAgICAgIGZ1bmN0aW9uOiB0b29sLmZ1bmN0aW9uLm5hbWUsXG4gICAgICAgICAgICAvLyBEdXBsaWNhdGUgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgIC8vIFVzZSBzYWZlIHBhcnNlciB0byBoYW5kbGUgT3BlbkFJJ3MgSlNPTiBxdWlya3MgKGxpa2UgYmFja3RpY2tzIGluIHN0cmluZ3MpXG4gICAgICAgICAgICBpbnB1dDogc2FmZVBhcnNlT3BlbkFJSnNvbih0b29sLmZ1bmN0aW9uLmFyZ3VtZW50cyB8fCBcInt9XCIpXG4gICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICAgIH0pKTtcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwgW10pO1xufTtcbnZhciBzYWZlUGFyc2VPcGVuQUlKc29uID0gKHN0cikgPT4ge1xuICBjb25zdCB0cmltbWVkID0gc3RyLnJlcGxhY2UoL15bXCInXXxbXCInXSQvZywgXCJcIik7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodHJpbW1lZCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgd2l0aFF1b3RlcyA9IHRyaW1tZWQucmVwbGFjZShcbiAgICAgICAgL2AoW1xcc1xcU10qPylgL2csXG4gICAgICAgIChfLCBjb250ZW50KSA9PiBKU09OLnN0cmluZ2lmeShjb250ZW50KVxuICAgICAgKTtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHdpdGhRdW90ZXMpO1xuICAgIH0gY2F0Y2ggKGUyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBGYWlsZWQgdG8gcGFyc2UgSlNPTiB3aXRoIGJhY2t0aWNrczogJHtzdHJpbmdpZnlFcnJvcihlMil9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn07XG52YXIgb3BlbkFpU3RvcFJlYXNvblRvU3RhdGVTdG9wUmVhc29uID0ge1xuICB0b29sX2NhbGxzOiBcInRvb2xcIixcbiAgc3RvcDogXCJzdG9wXCIsXG4gIGxlbmd0aDogXCJzdG9wXCIsXG4gIGNvbnRlbnRfZmlsdGVyOiBcInN0b3BcIixcbiAgZnVuY3Rpb25fY2FsbDogXCJ0b29sXCJcbn07XG52YXIgdG9vbENob2ljZTIgPSAoY2hvaWNlKSA9PiB7XG4gIHN3aXRjaCAoY2hvaWNlKSB7XG4gICAgY2FzZSBcImF1dG9cIjpcbiAgICAgIHJldHVybiBcImF1dG9cIjtcbiAgICBjYXNlIFwiYW55XCI6XG4gICAgICByZXR1cm4gXCJyZXF1aXJlZFwiO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCIsXG4gICAgICAgIGZ1bmN0aW9uOiB7IG5hbWU6IGNob2ljZSB9XG4gICAgICB9O1xuICB9XG59O1xuXG4vLyBzcmMvYWRhcHRlcnMvZ2VtaW5pLnRzXG5pbXBvcnQgXCJAaW5uZ2VzdC9haVwiO1xuaW1wb3J0IHsgeiBhcyB6MiB9IGZyb20gXCJ6b2RcIjtcbmltcG9ydCB7IHpvZFRvSnNvblNjaGVtYSBhcyB6b2RUb0pzb25TY2hlbWEzIH0gZnJvbSBcInpvZC10by1qc29uLXNjaGVtYVwiO1xudmFyIHJlcXVlc3RQYXJzZXIzID0gKF9tb2RlbDIsIG1lc3NhZ2VzLCB0b29scywgdG9vbF9jaG9pY2UgPSBcImF1dG9cIikgPT4ge1xuICBjb25zdCBjb250ZW50cyA9IG1lc3NhZ2VzLm1hcCgobSkgPT4gbWVzc2FnZVRvQ29udGVudChtKSk7XG4gIGNvbnN0IGZ1bmN0aW9uRGVjbGFyYXRpb25zID0gdG9vbHMubWFwKCh0KSA9PiAoe1xuICAgIG5hbWU6IHQubmFtZSxcbiAgICBkZXNjcmlwdGlvbjogdC5kZXNjcmlwdGlvbixcbiAgICBwYXJhbWV0ZXJzOiB0LnBhcmFtZXRlcnMgPyBnZW1pbmlab2RUb0pzb25TY2hlbWEodC5wYXJhbWV0ZXJzKSA6IChcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICBnZW1pbmlab2RUb0pzb25TY2hlbWEoejIub2JqZWN0KHt9KSlcbiAgICApXG4gIH0pKTtcbiAgcmV0dXJuIF9fc3ByZWFkVmFsdWVzKHtcbiAgICBjb250ZW50c1xuICB9LCB0b29scy5sZW5ndGggPiAwID8ge1xuICAgIHRvb2xzOiBbXG4gICAgICB7XG4gICAgICAgIGZ1bmN0aW9uRGVjbGFyYXRpb25zXG4gICAgICB9XG4gICAgXSxcbiAgICB0b29sX2NvbmZpZzogdG9vbENob2ljZTModG9vbF9jaG9pY2UpXG4gIH0gOiB7fSk7XG59O1xudmFyIG1lc3NhZ2VDb250ZW50VG9TdHJpbmcgPSAoY29udGVudCkgPT4ge1xuICBpZiAodHlwZW9mIGNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxuICByZXR1cm4gY29udGVudC5tYXAoKGMpID0+IGMudGV4dCkuam9pbihcIlwiKTtcbn07XG52YXIgcmVzcG9uc2VQYXJzZXIzID0gKGlucHV0KSA9PiB7XG4gIHZhciBfYSwgX2IsIF9jO1xuICBpZiAoaW5wdXQuZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAoKF9hID0gaW5wdXQuZXJyb3IpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tZXNzYWdlKSB8fCBgR2VtaW5pIHJlcXVlc3QgZmFpbGVkOiAke0pTT04uc3RyaW5naWZ5KGlucHV0LmVycm9yKX1gXG4gICAgKTtcbiAgfVxuICBjb25zdCBtZXNzYWdlcyA9IFtdO1xuICBmb3IgKGNvbnN0IGNhbmRpZGF0ZSBvZiAoX2IgPSBpbnB1dC5jYW5kaWRhdGVzKSAhPSBudWxsID8gX2IgOiBbXSkge1xuICAgIGlmIChjYW5kaWRhdGUuZmluaXNoUmVhc29uID09PSBcIk1BTEZPUk1FRF9GVU5DVElPTl9DQUxMXCIpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJHZW1pbmkgcmV0dXJuZWQgTUFMRk9STUVEX0ZVTkNUSU9OX0NBTEwsIHNraXBwaW5nIHRoaXMgY2FuZGlkYXRlLiBUaGlzIHR5cGljYWxseSBpbmRpY2F0ZXMgYW4gaXNzdWUgd2l0aCB0b29sL2Z1bmN0aW9uIGNhbGwgZm9ybWF0dGluZy4gQ2hlY2sgeW91ciB0b29sIGRlZmluaXRpb25zIGFuZCBwYXJhbWV0ZXJzLlwiXG4gICAgICApO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICghKChfYyA9IGNhbmRpZGF0ZS5jb250ZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2MucGFydHMpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBjb250ZW50IG9mIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzKSB7XG4gICAgICBpZiAoY2FuZGlkYXRlLmNvbnRlbnQucm9sZSA9PT0gXCJ1c2VyXCIgJiYgXCJ0ZXh0XCIgaW4gY29udGVudCkge1xuICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICBjb250ZW50OiBjb250ZW50LnRleHRcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGNhbmRpZGF0ZS5jb250ZW50LnJvbGUgPT09IFwibW9kZWxcIiAmJiBcInRleHRcIiBpbiBjb250ZW50KSB7XG4gICAgICAgIG1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgY29udGVudDogY29udGVudC50ZXh0XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChjYW5kaWRhdGUuY29udGVudC5yb2xlID09PSBcIm1vZGVsXCIgJiYgXCJmdW5jdGlvbkNhbGxcIiBpbiBjb250ZW50KSB7XG4gICAgICAgIG1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgdHlwZTogXCJ0b29sX2NhbGxcIixcbiAgICAgICAgICBzdG9wX3JlYXNvbjogXCJ0b29sXCIsXG4gICAgICAgICAgdG9vbHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbmFtZTogY29udGVudC5mdW5jdGlvbkNhbGwubmFtZSxcbiAgICAgICAgICAgICAgaW5wdXQ6IGNvbnRlbnQuZnVuY3Rpb25DYWxsLmFyZ3MsXG4gICAgICAgICAgICAgIHR5cGU6IFwidG9vbFwiLFxuICAgICAgICAgICAgICBpZDogY29udGVudC5mdW5jdGlvbkNhbGwubmFtZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGNhbmRpZGF0ZS5jb250ZW50LnJvbGUgPT09IFwidXNlclwiICYmIFwiZnVuY3Rpb25SZXNwb25zZVwiIGluIGNvbnRlbnQpIHtcbiAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgcm9sZTogXCJ0b29sX3Jlc3VsdFwiLFxuICAgICAgICAgIHR5cGU6IFwidG9vbF9yZXN1bHRcIixcbiAgICAgICAgICBzdG9wX3JlYXNvbjogXCJ0b29sXCIsXG4gICAgICAgICAgdG9vbDoge1xuICAgICAgICAgICAgbmFtZTogY29udGVudC5mdW5jdGlvblJlc3BvbnNlLm5hbWUsXG4gICAgICAgICAgICBpbnB1dDogY29udGVudC5mdW5jdGlvblJlc3BvbnNlLnJlc3BvbnNlLFxuICAgICAgICAgICAgdHlwZTogXCJ0b29sXCIsXG4gICAgICAgICAgICBpZDogY29udGVudC5mdW5jdGlvblJlc3BvbnNlLm5hbWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KGNvbnRlbnQuZnVuY3Rpb25SZXNwb25zZS5yZXNwb25zZSlcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIGNvbnRlbnQgdHlwZVwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1lc3NhZ2VzO1xufTtcbnZhciBtZXNzYWdlVG9Db250ZW50ID0gKG0pID0+IHtcbiAgc3dpdGNoIChtLnJvbGUpIHtcbiAgICBjYXNlIFwic3lzdGVtXCI6XG4gICAgICByZXR1cm4ge1xuICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgcGFydHM6IFt7IHRleHQ6IG1lc3NhZ2VDb250ZW50VG9TdHJpbmcobS5jb250ZW50KSB9XVxuICAgICAgfTtcbiAgICBjYXNlIFwidXNlclwiOlxuICAgICAgc3dpdGNoIChtLnR5cGUpIHtcbiAgICAgICAgY2FzZSBcInRvb2xfY2FsbFwiOlxuICAgICAgICAgIGlmIChtLnRvb2xzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9vbCBjYWxsIG1lc3NhZ2UgbXVzdCBoYXZlIGF0IGxlYXN0IG9uZSB0b29sXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcm9sZTogXCJtb2RlbFwiLFxuICAgICAgICAgICAgcGFydHM6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uQ2FsbDoge1xuICAgICAgICAgICAgICAgICAgbmFtZTogbS50b29sc1swXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgYXJnczogbS50b29sc1swXS5pbnB1dFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgICAgICAgcGFydHM6IFt7IHRleHQ6IG1lc3NhZ2VDb250ZW50VG9TdHJpbmcobS5jb250ZW50KSB9XVxuICAgICAgICAgIH07XG4gICAgICB9XG4gICAgY2FzZSBcImFzc2lzdGFudFwiOlxuICAgICAgc3dpdGNoIChtLnR5cGUpIHtcbiAgICAgICAgY2FzZSBcInRvb2xfY2FsbFwiOlxuICAgICAgICAgIGlmIChtLnRvb2xzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9vbCBjYWxsIG1lc3NhZ2UgbXVzdCBoYXZlIGF0IGxlYXN0IG9uZSB0b29sXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcm9sZTogXCJtb2RlbFwiLFxuICAgICAgICAgICAgcGFydHM6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uQ2FsbDoge1xuICAgICAgICAgICAgICAgICAgbmFtZTogbS50b29sc1swXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgYXJnczogbS50b29sc1swXS5pbnB1dFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJvbGU6IFwibW9kZWxcIixcbiAgICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiBtZXNzYWdlQ29udGVudFRvU3RyaW5nKG0uY29udGVudCkgfV1cbiAgICAgICAgICB9O1xuICAgICAgfVxuICAgIGNhc2UgXCJ0b29sX3Jlc3VsdFwiOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcm9sZTogXCJ1c2VyXCIsXG4gICAgICAgIHBhcnRzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZnVuY3Rpb25SZXNwb25zZToge1xuICAgICAgICAgICAgICBuYW1lOiBtLnRvb2wubmFtZSxcbiAgICAgICAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBtLnRvb2wubmFtZSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB0eXBlb2YgbS5jb250ZW50ID09PSBcInN0cmluZ1wiID8gbS5jb250ZW50IDogSlNPTi5zdHJpbmdpZnkobS5jb250ZW50KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9O1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gbWVzc2FnZSByb2xlOiAke20ucm9sZX1gKTtcbiAgfVxufTtcbnZhciB0b29sQ2hvaWNlMyA9IChjaG9pY2UpID0+IHtcbiAgc3dpdGNoIChjaG9pY2UpIHtcbiAgICBjYXNlIFwiYXV0b1wiOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZnVuY3Rpb25DYWxsaW5nQ29uZmlnOiB7XG4gICAgICAgICAgbW9kZTogXCJBVVRPXCJcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICBjYXNlIFwiYW55XCI6XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmdW5jdGlvbkNhbGxpbmdDb25maWc6IHtcbiAgICAgICAgICBtb2RlOiBcIkFOWVwiXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIGlmICh0eXBlb2YgY2hvaWNlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZnVuY3Rpb25DYWxsaW5nQ29uZmlnOiB7XG4gICAgICAgICAgICBtb2RlOiBcIkFOWVwiLFxuICAgICAgICAgICAgYWxsb3dlZEZ1bmN0aW9uTmFtZXM6IFtjaG9pY2VdXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuICB9XG59O1xudmFyIHJlY3Vyc2l2ZUdlbWluaVpvZFRvSnNvblNjaGVtYSA9IChvYmopID0+IHtcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHZvaWQgMCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgcmV0dXJuIG9iai5tYXAocmVjdXJzaXZlR2VtaW5pWm9kVG9Kc29uU2NoZW1hKTtcbiAgfVxuICBjb25zdCBuZXdPYmogPSBfX3NwcmVhZFZhbHVlcyh7fSwgb2JqKTtcbiAgZm9yIChjb25zdCBrZXkgaW4gbmV3T2JqKSB7XG4gICAgaWYgKG5ld09ialtrZXldICE9IG51bGwpIHtcbiAgICAgIG5ld09ialtrZXldID0gcmVjdXJzaXZlR2VtaW5pWm9kVG9Kc29uU2NoZW1hKFxuICAgICAgICBuZXdPYmpba2V5XVxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgaWYgKChuZXdPYmogPT0gbnVsbCA/IHZvaWQgMCA6IG5ld09ialtcImFkZGl0aW9uYWxQcm9wZXJ0aWVzXCJdKSAhPSBudWxsKSB7XG4gICAgZGVsZXRlIG5ld09ialtcImFkZGl0aW9uYWxQcm9wZXJ0aWVzXCJdO1xuICB9XG4gIHJldHVybiBuZXdPYmo7XG59O1xudmFyIGdlbWluaVpvZFRvSnNvblNjaGVtYSA9ICh6b2QpID0+IHtcbiAgbGV0IHNjaGVtYSA9IHpvZFRvSnNvblNjaGVtYTMoem9kLCB7IHRhcmdldDogXCJvcGVuQXBpM1wiIH0pO1xuICBzY2hlbWEgPSByZWN1cnNpdmVHZW1pbmlab2RUb0pzb25TY2hlbWEoc2NoZW1hKTtcbiAgcmV0dXJuIHNjaGVtYTtcbn07XG5cbi8vIHNyYy9hZGFwdGVycy9ncm9rLnRzXG52YXIgcmVxdWVzdFBhcnNlcjQgPSAobW9kZWwsIG1lc3NhZ2VzLCB0b29scywgdG9vbF9jaG9pY2UgPSBcImF1dG9cIikgPT4ge1xuICBjb25zdCByZXF1ZXN0ID0gcmVxdWVzdFBhcnNlcjIoXG4gICAgbW9kZWwsXG4gICAgbWVzc2FnZXMsXG4gICAgdG9vbHMsXG4gICAgdG9vbF9jaG9pY2VcbiAgKTtcbiAgcmVxdWVzdC50b29scyA9IChyZXF1ZXN0LnRvb2xzIHx8IFtdKS5tYXAoKHRvb2wpID0+IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIHRvb2wpLCB7XG4gICAgZnVuY3Rpb246IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIHRvb2wuZnVuY3Rpb24pLCB7XG4gICAgICBzdHJpY3Q6IGZhbHNlXG4gICAgfSlcbiAgfSkpO1xuICByZXR1cm4gcmVxdWVzdDtcbn07XG52YXIgcmVzcG9uc2VQYXJzZXI0ID0gcmVzcG9uc2VQYXJzZXIyO1xuXG4vLyBzcmMvYWRhcHRlcnMvaW5kZXgudHNcbnZhciBhZGFwdGVycyA9IHtcbiAgXCJvcGVuYWktY2hhdFwiOiB7XG4gICAgcmVxdWVzdDogcmVxdWVzdFBhcnNlcjIsXG4gICAgcmVzcG9uc2U6IHJlc3BvbnNlUGFyc2VyMlxuICB9LFxuICBhbnRocm9waWM6IHtcbiAgICByZXF1ZXN0OiByZXF1ZXN0UGFyc2VyLFxuICAgIHJlc3BvbnNlOiByZXNwb25zZVBhcnNlclxuICB9LFxuICBnZW1pbmk6IHtcbiAgICByZXF1ZXN0OiByZXF1ZXN0UGFyc2VyMyxcbiAgICByZXNwb25zZTogcmVzcG9uc2VQYXJzZXIzXG4gIH0sXG4gIGdyb2s6IHtcbiAgICByZXF1ZXN0OiByZXF1ZXN0UGFyc2VyNCxcbiAgICByZXNwb25zZTogcmVzcG9uc2VQYXJzZXI0XG4gIH1cbn07XG5cbi8vIHNyYy9tb2RlbC50c1xudmFyIGNyZWF0ZUFnZW50aWNNb2RlbEZyb21BaUFkYXB0ZXIgPSAoYWRhcHRlcikgPT4ge1xuICBjb25zdCBvcHRzID0gYWRhcHRlcnNbYWRhcHRlci5mb3JtYXRdO1xuICByZXR1cm4gbmV3IEFnZW50aWNNb2RlbCh7XG4gICAgbW9kZWw6IGFkYXB0ZXIsXG4gICAgcmVxdWVzdFBhcnNlcjogb3B0cy5yZXF1ZXN0LFxuICAgIHJlc3BvbnNlUGFyc2VyOiBvcHRzLnJlc3BvbnNlXG4gIH0pO1xufTtcbnZhciBfbW9kZWw7XG52YXIgQWdlbnRpY01vZGVsID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbW9kZWwsXG4gICAgcmVxdWVzdFBhcnNlcjogcmVxdWVzdFBhcnNlcjUsXG4gICAgcmVzcG9uc2VQYXJzZXI6IHJlc3BvbnNlUGFyc2VyNVxuICB9KSB7XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9tb2RlbCk7XG4gICAgX19wcml2YXRlU2V0KHRoaXMsIF9tb2RlbCwgbW9kZWwpO1xuICAgIHRoaXMucmVxdWVzdFBhcnNlciA9IHJlcXVlc3RQYXJzZXI1O1xuICAgIHRoaXMucmVzcG9uc2VQYXJzZXIgPSByZXNwb25zZVBhcnNlcjU7XG4gIH1cbiAgYXN5bmMgaW5mZXIoc3RlcElELCBpbnB1dCwgdG9vbHMsIHRvb2xfY2hvaWNlKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBib2R5ID0gdGhpcy5yZXF1ZXN0UGFyc2VyKF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kZWwpLCBpbnB1dCwgdG9vbHMsIHRvb2xfY2hvaWNlKTtcbiAgICBsZXQgcmVzdWx0O1xuICAgIGNvbnN0IHN0ZXAgPSBhd2FpdCBnZXRTdGVwVG9vbHMoKTtcbiAgICBpZiAoc3RlcCkge1xuICAgICAgcmVzdWx0ID0gYXdhaXQgc3RlcC5haS5pbmZlcihzdGVwSUQsIHtcbiAgICAgICAgbW9kZWw6IF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kZWwpLFxuICAgICAgICBib2R5XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbW9kZWxDb3B5ID0gX19zcHJlYWRWYWx1ZXMoe30sIF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kZWwpKTtcbiAgICAgIChfYiA9IChfYSA9IF9fcHJpdmF0ZUdldCh0aGlzLCBfbW9kZWwpKS5vbkNhbGwpID09IG51bGwgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBtb2RlbENvcHksIGJvZHkpO1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChtb2RlbENvcHkudXJsIHx8IFwiXCIpO1xuICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH07XG4gICAgICBjb25zdCBmb3JtYXRIYW5kbGVycyA9IHtcbiAgICAgICAgXCJvcGVuYWktY2hhdFwiOiAoKSA9PiB7XG4gICAgICAgICAgaGVhZGVyc1tcIkF1dGhvcml6YXRpb25cIl0gPSBgQmVhcmVyICR7bW9kZWxDb3B5LmF1dGhLZXl9YDtcbiAgICAgICAgfSxcbiAgICAgICAgYW50aHJvcGljOiAoKSA9PiB7XG4gICAgICAgICAgaGVhZGVyc1tcIngtYXBpLWtleVwiXSA9IG1vZGVsQ29weS5hdXRoS2V5O1xuICAgICAgICAgIGhlYWRlcnNbXCJhbnRocm9waWMtdmVyc2lvblwiXSA9IFwiMjAyMy0wNi0wMVwiO1xuICAgICAgICB9LFxuICAgICAgICBnZW1pbmk6ICgpID0+IHtcbiAgICAgICAgfSxcbiAgICAgICAgZ3JvazogKCkgPT4ge1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgZm9ybWF0SGFuZGxlcnNbbW9kZWxDb3B5LmZvcm1hdF0oKTtcbiAgICAgIHJlc3VsdCA9IGF3YWl0IChhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSlcbiAgICAgIH0pKS5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiB7IG91dHB1dDogdGhpcy5yZXNwb25zZVBhcnNlcihyZXN1bHQpLCByYXc6IHJlc3VsdCB9O1xuICB9XG59O1xuX21vZGVsID0gbmV3IFdlYWtNYXAoKTtcblxuLy8gc3JjL2FnZW50LnRzXG52YXIgY3JlYXRlQWdlbnQgPSAob3B0cykgPT4gbmV3IEFnZW50KG9wdHMpO1xudmFyIGNyZWF0ZVJvdXRpbmdBZ2VudCA9IChvcHRzKSA9PiBuZXcgUm91dGluZ0FnZW50KG9wdHMpO1xudmFyIEFnZW50ID0gY2xhc3MgX0FnZW50IHtcbiAgY29uc3RydWN0b3Iob3B0cykge1xuICAgIHRoaXMubmFtZSA9IG9wdHMubmFtZTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gb3B0cy5kZXNjcmlwdGlvbiB8fCBcIlwiO1xuICAgIHRoaXMuc3lzdGVtID0gb3B0cy5zeXN0ZW07XG4gICAgdGhpcy5hc3Npc3RhbnQgPSBvcHRzLmFzc2lzdGFudCB8fCBcIlwiO1xuICAgIHRoaXMudG9vbHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHRoaXMudG9vbF9jaG9pY2UgPSBvcHRzLnRvb2xfY2hvaWNlO1xuICAgIHRoaXMubGlmZWN5Y2xlcyA9IG9wdHMubGlmZWN5Y2xlO1xuICAgIHRoaXMubW9kZWwgPSBvcHRzLm1vZGVsO1xuICAgIHRoaXMuaGlzdG9yeSA9IG9wdHMuaGlzdG9yeTtcbiAgICB0aGlzLnNldFRvb2xzKG9wdHMudG9vbHMpO1xuICAgIHRoaXMubWNwU2VydmVycyA9IG9wdHMubWNwU2VydmVycztcbiAgICB0aGlzLl9tY3BDbGllbnRzID0gW107XG4gIH1cbiAgc2V0VG9vbHModG9vbHMpIHtcbiAgICBmb3IgKGNvbnN0IHRvb2wgb2YgdG9vbHMgfHwgW10pIHtcbiAgICAgIGlmIChpc0lubmdlc3RGbih0b29sKSkge1xuICAgICAgICB0aGlzLnRvb2xzLnNldCh0b29sW1wiYWJzb2x1dGVJZFwiXSwge1xuICAgICAgICAgIG5hbWU6IHRvb2xbXCJhYnNvbHV0ZUlkXCJdLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB0b29sLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIC8vIFRPRE8gU2hvdWxkIHdlIGVycm9yIGhlcmUgaWYgd2UgY2FuJ3QgZmluZCBhbiBpbnB1dCBzY2hlbWE/XG4gICAgICAgICAgcGFyYW1ldGVyczogZ2V0SW5uZ2VzdEZuSW5wdXQodG9vbCksXG4gICAgICAgICAgaGFuZGxlcjogYXN5bmMgKGlucHV0LCBvcHRzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdGVwID0gYXdhaXQgZ2V0U3RlcFRvb2xzKCk7XG4gICAgICAgICAgICBpZiAoIXN0ZXApIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5uZ2VzdCB0b29sIGNhbGxlZCBvdXRzaWRlIG9mIElubmdlc3QgY29udGV4dFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHN0ZXBJZCA9IGAke29wdHMuYWdlbnQubmFtZX0vdG9vbHMvJHt0b29sW1wiYWJzb2x1dGVJZFwiXX1gO1xuICAgICAgICAgICAgcmV0dXJuIHN0ZXAuaW52b2tlKHN0ZXBJZCwge1xuICAgICAgICAgICAgICBmdW5jdGlvbjogcmVmZXJlbmNlRnVuY3Rpb24oe1xuICAgICAgICAgICAgICAgIGFwcElkOiB0b29sW1wiY2xpZW50XCJdW1wiaWRcIl0sXG4gICAgICAgICAgICAgICAgZnVuY3Rpb25JZDogdG9vbC5pZCgpXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBkYXRhOiBpbnB1dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudG9vbHMuc2V0KHRvb2wubmFtZSwgdG9vbCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHdpdGhNb2RlbChtb2RlbCkge1xuICAgIHJldHVybiBuZXcgX0FnZW50KHtcbiAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLFxuICAgICAgc3lzdGVtOiB0aGlzLnN5c3RlbSxcbiAgICAgIGFzc2lzdGFudDogdGhpcy5hc3Npc3RhbnQsXG4gICAgICB0b29sczogQXJyYXkuZnJvbSh0aGlzLnRvb2xzLnZhbHVlcygpKSxcbiAgICAgIGxpZmVjeWNsZTogdGhpcy5saWZlY3ljbGVzLFxuICAgICAgbW9kZWxcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogUnVuIHJ1bnMgYW4gYWdlbnQgd2l0aCB0aGUgZ2l2ZW4gdXNlciBpbnB1dCwgdHJlYXRlZCBhcyBhIHVzZXIgbWVzc2FnZS4gIElmXG4gICAqIHRoZSBpbnB1dCBpcyBhbiBlbXB0eSBzdHJpbmcsIG9ubHkgdGhlIHN5c3RlbSBwcm9tcHQgd2lsbCBleGVjdXRlLlxuICAgKi9cbiAgYXN5bmMgcnVuKGlucHV0LCB7IG1vZGVsLCBuZXR3b3JrLCBzdGF0ZSwgbWF4SXRlciA9IDAgfSA9IHt9KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBhd2FpdCB0aGlzLmluaXRNQ1AoKTtcbiAgICBjb25zdCByYXdNb2RlbCA9IG1vZGVsIHx8IHRoaXMubW9kZWwgfHwgKG5ldHdvcmsgPT0gbnVsbCA/IHZvaWQgMCA6IG5ldHdvcmsuZGVmYXVsdE1vZGVsKTtcbiAgICBpZiAoIXJhd01vZGVsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBtb2RlbCBwcm92aWRlZCB0byBhZ2VudFwiKTtcbiAgICB9XG4gICAgY29uc3QgcCA9IGNyZWF0ZUFnZW50aWNNb2RlbEZyb21BaUFkYXB0ZXIocmF3TW9kZWwpO1xuICAgIGNvbnN0IHMgPSBzdGF0ZSB8fCAobmV0d29yayA9PSBudWxsID8gdm9pZCAwIDogbmV0d29yay5zdGF0ZSkgfHwgbmV3IFN0YXRlKCk7XG4gICAgY29uc3QgcnVuID0gbmV3IE5ldHdvcmtSdW4oXG4gICAgICBuZXR3b3JrIHx8IGNyZWF0ZU5ldHdvcmsoeyBuYW1lOiBcImRlZmF1bHRcIiwgYWdlbnRzOiBbXSB9KSxcbiAgICAgIHNcbiAgICApO1xuICAgIGF3YWl0IGluaXRpYWxpemVUaHJlYWQoe1xuICAgICAgc3RhdGU6IHMsXG4gICAgICBoaXN0b3J5OiB0aGlzLmhpc3RvcnksXG4gICAgICBpbnB1dCxcbiAgICAgIG5ldHdvcms6IHJ1blxuICAgIH0pO1xuICAgIGF3YWl0IGxvYWRUaHJlYWRGcm9tU3RvcmFnZSh7XG4gICAgICBzdGF0ZTogcyxcbiAgICAgIGhpc3Rvcnk6IHRoaXMuaGlzdG9yeSxcbiAgICAgIGlucHV0LFxuICAgICAgbmV0d29yazogcnVuXG4gICAgfSk7XG4gICAgbGV0IGhpc3RvcnkgPSBzID8gcy5mb3JtYXRIaXN0b3J5KCkgOiBbXTtcbiAgICBsZXQgcHJvbXB0ID0gYXdhaXQgdGhpcy5hZ2VudFByb21wdChpbnB1dCwgcnVuKTtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IEFnZW50UmVzdWx0KFxuICAgICAgdGhpcy5uYW1lLFxuICAgICAgW10sXG4gICAgICBbXSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgcHJvbXB0LFxuICAgICAgaGlzdG9yeSxcbiAgICAgIFwiXCJcbiAgICApO1xuICAgIGxldCBoYXNNb3JlQWN0aW9ucyA9IHRydWU7XG4gICAgbGV0IGl0ZXIgPSAwO1xuICAgIGNvbnN0IGluaXRpYWxSZXN1bHRDb3VudCA9IHMucmVzdWx0cy5sZW5ndGg7XG4gICAgZG8ge1xuICAgICAgaWYgKChfYSA9IHRoaXMubGlmZWN5Y2xlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9uU3RhcnQpIHtcbiAgICAgICAgY29uc3QgbW9kaWZpZWQgPSBhd2FpdCB0aGlzLmxpZmVjeWNsZXMub25TdGFydCh7XG4gICAgICAgICAgYWdlbnQ6IHRoaXMsXG4gICAgICAgICAgbmV0d29yazogcnVuLFxuICAgICAgICAgIGlucHV0LFxuICAgICAgICAgIHByb21wdCxcbiAgICAgICAgICBoaXN0b3J5XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobW9kaWZpZWQuc3RvcCkge1xuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcHJvbXB0ID0gbW9kaWZpZWQucHJvbXB0O1xuICAgICAgICBoaXN0b3J5ID0gbW9kaWZpZWQuaGlzdG9yeTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGluZmVyZW5jZSA9IGF3YWl0IHRoaXMucGVyZm9ybUluZmVyZW5jZShwLCBwcm9tcHQsIGhpc3RvcnksIHJ1bik7XG4gICAgICBoYXNNb3JlQWN0aW9ucyA9IEJvb2xlYW4oXG4gICAgICAgIHRoaXMudG9vbHMuc2l6ZSA+IDAgJiYgaW5mZXJlbmNlLm91dHB1dC5sZW5ndGggJiYgaW5mZXJlbmNlLm91dHB1dFtpbmZlcmVuY2Uub3V0cHV0Lmxlbmd0aCAtIDFdLnN0b3BfcmVhc29uICE9PSBcInN0b3BcIlxuICAgICAgKTtcbiAgICAgIHJlc3VsdCA9IGluZmVyZW5jZTtcbiAgICAgIGhpc3RvcnkgPSBbLi4uaW5mZXJlbmNlLm91dHB1dF07XG4gICAgICBpdGVyKys7XG4gICAgfSB3aGlsZSAoaGFzTW9yZUFjdGlvbnMgJiYgaXRlciA8IG1heEl0ZXIpO1xuICAgIGlmICgoX2IgPSB0aGlzLmxpZmVjeWNsZXMpID09IG51bGwgPyB2b2lkIDAgOiBfYi5vbkZpbmlzaCkge1xuICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5saWZlY3ljbGVzLm9uRmluaXNoKHtcbiAgICAgICAgYWdlbnQ6IHRoaXMsXG4gICAgICAgIG5ldHdvcms6IHJ1bixcbiAgICAgICAgcmVzdWx0XG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgc2F2ZVRocmVhZFRvU3RvcmFnZSh7XG4gICAgICBzdGF0ZTogcyxcbiAgICAgIGhpc3Rvcnk6IHRoaXMuaGlzdG9yeSxcbiAgICAgIGlucHV0LFxuICAgICAgaW5pdGlhbFJlc3VsdENvdW50LFxuICAgICAgbmV0d29yazogcnVuXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICBhc3luYyBwZXJmb3JtSW5mZXJlbmNlKHAsIHByb21wdCwgaGlzdG9yeSwgbmV0d29yaykge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCB7IG91dHB1dCwgcmF3IH0gPSBhd2FpdCBwLmluZmVyKFxuICAgICAgdGhpcy5uYW1lLFxuICAgICAgcHJvbXB0LmNvbmNhdChoaXN0b3J5KSxcbiAgICAgIEFycmF5LmZyb20odGhpcy50b29scy52YWx1ZXMoKSksXG4gICAgICB0aGlzLnRvb2xfY2hvaWNlIHx8IFwiYXV0b1wiXG4gICAgKTtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IEFnZW50UmVzdWx0KFxuICAgICAgdGhpcy5uYW1lLFxuICAgICAgb3V0cHV0LFxuICAgICAgW10sXG4gICAgICAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgIHByb21wdCxcbiAgICAgIGhpc3RvcnksXG4gICAgICB0eXBlb2YgcmF3ID09PSBcInN0cmluZ1wiID8gcmF3IDogSlNPTi5zdHJpbmdpZnkocmF3KVxuICAgICk7XG4gICAgaWYgKChfYSA9IHRoaXMubGlmZWN5Y2xlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9uUmVzcG9uc2UpIHtcbiAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMubGlmZWN5Y2xlcy5vblJlc3BvbnNlKHtcbiAgICAgICAgYWdlbnQ6IHRoaXMsXG4gICAgICAgIG5ldHdvcmssXG4gICAgICAgIHJlc3VsdFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHRvb2xDYWxsT3V0cHV0ID0gYXdhaXQgdGhpcy5pbnZva2VUb29scyhyZXN1bHQub3V0cHV0LCBuZXR3b3JrKTtcbiAgICBpZiAodG9vbENhbGxPdXRwdXQubGVuZ3RoID4gMCkge1xuICAgICAgcmVzdWx0LnRvb2xDYWxscyA9IHJlc3VsdC50b29sQ2FsbHMuY29uY2F0KHRvb2xDYWxsT3V0cHV0KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICAvKipcbiAgICogaW52b2tlVG9vbHMgdGFrZXMgb3V0cHV0IG1lc3NhZ2VzIGZyb20gYW4gaW5mZXJlbmNlIGNhbGwgdGhlbiBpbnZva2VzIGFueSB0b29sc1xuICAgKiBpbiB0aGUgbWVzc2FnZSByZXNwb25zZXMuXG4gICAqL1xuICBhc3luYyBpbnZva2VUb29scyhtc2dzLCBuZXR3b3JrKSB7XG4gICAgY29uc3Qgb3V0cHV0ID0gW107XG4gICAgZm9yIChjb25zdCBtc2cgb2YgbXNncykge1xuICAgICAgaWYgKG1zZy50eXBlICE9PSBcInRvb2xfY2FsbFwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG1zZy50b29scykpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IHRvb2wgb2YgbXNnLnRvb2xzKSB7XG4gICAgICAgIGNvbnN0IGZvdW5kID0gdGhpcy50b29scy5nZXQodG9vbC5uYW1lKTtcbiAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIGBJbmZlcmVuY2UgcmVxdWVzdGVkIGEgbm9uLWV4aXN0ZW50IHRvb2w6ICR7dG9vbC5uYW1lfWBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFByb21pc2UucmVzb2x2ZShcbiAgICAgICAgICBmb3VuZC5oYW5kbGVyKHRvb2wuaW5wdXQsIHtcbiAgICAgICAgICAgIGFnZW50OiB0aGlzLFxuICAgICAgICAgICAgbmV0d29yayxcbiAgICAgICAgICAgIHN0ZXA6IGF3YWl0IGdldFN0ZXBUb29scygpXG4gICAgICAgICAgfSlcbiAgICAgICAgKS50aGVuKChyKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcbiAgICAgICAgICAgIGRhdGE6IHR5cGVvZiByID09PSBcInVuZGVmaW5lZFwiID8gYCR7dG9vbC5uYW1lfSBzdWNjZXNzZnVsbHkgZXhlY3V0ZWRgIDogclxuICAgICAgICAgIH07XG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICByZXR1cm4geyBlcnJvcjogc2VyaWFsaXplRXJyb3IoZXJyKSB9O1xuICAgICAgICB9KTtcbiAgICAgICAgb3V0cHV0LnB1c2goe1xuICAgICAgICAgIHJvbGU6IFwidG9vbF9yZXN1bHRcIixcbiAgICAgICAgICB0eXBlOiBcInRvb2xfcmVzdWx0XCIsXG4gICAgICAgICAgdG9vbDoge1xuICAgICAgICAgICAgdHlwZTogXCJ0b29sXCIsXG4gICAgICAgICAgICBpZDogdG9vbC5pZCxcbiAgICAgICAgICAgIG5hbWU6IHRvb2wubmFtZSxcbiAgICAgICAgICAgIGlucHV0OiB0b29sLmlucHV0LmFyZ3VtZW50c1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY29udGVudDogcmVzdWx0LFxuICAgICAgICAgIHN0b3BfcmVhc29uOiBcInRvb2xcIlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuICBhc3luYyBhZ2VudFByb21wdChpbnB1dCwgbmV0d29yaykge1xuICAgIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgICAge1xuICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgcm9sZTogXCJzeXN0ZW1cIixcbiAgICAgICAgY29udGVudDogdHlwZW9mIHRoaXMuc3lzdGVtID09PSBcInN0cmluZ1wiID8gdGhpcy5zeXN0ZW0gOiBhd2FpdCB0aGlzLnN5c3RlbSh7IG5ldHdvcmsgfSlcbiAgICAgIH1cbiAgICBdO1xuICAgIGlmIChpbnB1dC5sZW5ndGggPiAwKSB7XG4gICAgICBtZXNzYWdlcy5wdXNoKHsgdHlwZTogXCJ0ZXh0XCIsIHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBpbnB1dCB9KTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYXNzaXN0YW50Lmxlbmd0aCA+IDApIHtcbiAgICAgIG1lc3NhZ2VzLnB1c2goe1xuICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgY29udGVudDogdGhpcy5hc3Npc3RhbnRcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZXM7XG4gIH1cbiAgLy8gaW5pdE1DUCBmZXRjaGVzIGFsbCB0b29scyBmcm9tIHRoZSBhZ2VudCdzIE1DUCBzZXJ2ZXJzLCBhZGRpbmcgdGhlbSB0byB0aGUgdG9vbCBsaXN0LlxuICAvLyBUaGlzIGlzIGFsbCB0aGF0J3MgbmVjZXNzYXJ5IGluIG9yZGVyIHRvIGVuYWJsZSBNQ1AgdG9vbCB1c2Ugd2l0aGluIGFnZW50c1xuICBhc3luYyBpbml0TUNQKCkge1xuICAgIGlmICghdGhpcy5tY3BTZXJ2ZXJzIHx8IHRoaXMuX21jcENsaWVudHMubGVuZ3RoID49IHRoaXMubWNwU2VydmVycy5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IHNlcnZlciBvZiB0aGlzLm1jcFNlcnZlcnMpIHtcbiAgICAgIHByb21pc2VzLnB1c2godGhpcy5saXN0TUNQVG9vbHMoc2VydmVyKSk7XG4gICAgfVxuICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgfVxuICAvKipcbiAgICogbGlzdE1DUFRvb2xzIGxpc3RzIGFsbCBhdmFpbGFibGUgdG9vbHMgZm9yIGEgZ2l2ZW4gTUNQIHNlcnZlclxuICAgKi9cbiAgYXN5bmMgbGlzdE1DUFRvb2xzKHNlcnZlcikge1xuICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IHRoaXMubWNwQ2xpZW50KHNlcnZlcik7XG4gICAgdGhpcy5fbWNwQ2xpZW50cy5wdXNoKGNsaWVudCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBjbGllbnQucmVxdWVzdChcbiAgICAgICAgeyBtZXRob2Q6IFwidG9vbHMvbGlzdFwiIH0sXG4gICAgICAgIExpc3RUb29sc1Jlc3VsdFNjaGVtYVxuICAgICAgKTtcbiAgICAgIHJlc3VsdHMudG9vbHMuZm9yRWFjaCgodCkgPT4ge1xuICAgICAgICBjb25zdCBuYW1lID0gYCR7c2VydmVyLm5hbWV9LSR7dC5uYW1lfWA7XG4gICAgICAgIGxldCB6c2NoZW1hO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHpzY2hlbWEgPSBKU09OU2NoZW1hVG9ab2QuY29udmVydCh0LmlucHV0U2NoZW1hKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHpzY2hlbWEgPSB2b2lkIDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b29scy5zZXQobmFtZSwge1xuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IHQuZGVzY3JpcHRpb24sXG4gICAgICAgICAgcGFyYW1ldGVyczogenNjaGVtYSxcbiAgICAgICAgICBtY3A6IHtcbiAgICAgICAgICAgIHNlcnZlcixcbiAgICAgICAgICAgIHRvb2w6IHRcbiAgICAgICAgICB9LFxuICAgICAgICAgIGhhbmRsZXI6IGFzeW5jIChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgY29uc3QgZm4gPSAoKSA9PiBjbGllbnQuY2FsbFRvb2woe1xuICAgICAgICAgICAgICBuYW1lOiB0Lm5hbWUsXG4gICAgICAgICAgICAgIGFyZ3VtZW50czogaW5wdXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc3RlcCA9IGF3YWl0IGdldFN0ZXBUb29scygpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKChfYSA9IHN0ZXAgPT0gbnVsbCA/IHZvaWQgMCA6IHN0ZXAucnVuKG5hbWUsIGZuKSkgIT0gbnVsbCA/IF9hIDogZm4oKSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LmNvbnRlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUud2FybihcImVycm9yIGxpc3RpbmcgbWNwIHRvb2xzXCIsIGUpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogbWNwQ2xpZW50IGNyZWF0ZXMgYSBuZXcgTUNQIGNsaWVudCBmb3IgdGhlIGdpdmVuIHNlcnZlci5cbiAgICovXG4gIGFzeW5jIG1jcENsaWVudChzZXJ2ZXIpIHtcbiAgICBjb25zdCB0cmFuc3BvcnQgPSAoKCkgPT4ge1xuICAgICAgc3dpdGNoIChzZXJ2ZXIudHJhbnNwb3J0LnR5cGUpIHtcbiAgICAgICAgY2FzZSBcInN0cmVhbWFibGUtaHR0cFwiOlxuICAgICAgICAgIHJldHVybiBuZXcgU3RyZWFtYWJsZUhUVFBDbGllbnRUcmFuc3BvcnQoXG4gICAgICAgICAgICBuZXcgVVJMKHNlcnZlci50cmFuc3BvcnQudXJsKSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcmVxdWVzdEluaXQ6IHNlcnZlci50cmFuc3BvcnQucmVxdWVzdEluaXQsXG4gICAgICAgICAgICAgIGF1dGhQcm92aWRlcjogc2VydmVyLnRyYW5zcG9ydC5hdXRoUHJvdmlkZXIsXG4gICAgICAgICAgICAgIHJlY29ubmVjdGlvbk9wdGlvbnM6IHNlcnZlci50cmFuc3BvcnQucmVjb25uZWN0aW9uT3B0aW9ucyxcbiAgICAgICAgICAgICAgc2Vzc2lvbklkOiBzZXJ2ZXIudHJhbnNwb3J0LnNlc3Npb25JZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgIGNhc2UgXCJzc2VcIjpcbiAgICAgICAgICBpZiAoZ2xvYmFsLkV2ZW50U291cmNlID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGdsb2JhbC5FdmVudFNvdXJjZSA9IEV2ZW50U291cmNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbmV3IFNTRUNsaWVudFRyYW5zcG9ydChuZXcgVVJMKHNlcnZlci50cmFuc3BvcnQudXJsKSwge1xuICAgICAgICAgICAgZXZlbnRTb3VyY2VJbml0OiBzZXJ2ZXIudHJhbnNwb3J0LmV2ZW50U291cmNlSW5pdCxcbiAgICAgICAgICAgIHJlcXVlc3RJbml0OiBzZXJ2ZXIudHJhbnNwb3J0LnJlcXVlc3RJbml0XG4gICAgICAgICAgfSk7XG4gICAgICAgIGNhc2UgXCJ3c1wiOlxuICAgICAgICAgIHJldHVybiBuZXcgV2ViU29ja2V0Q2xpZW50VHJhbnNwb3J0KG5ldyBVUkwoc2VydmVyLnRyYW5zcG9ydC51cmwpKTtcbiAgICAgICAgY2FzZSBcInN0ZGlvXCI6IHtcbiAgICAgICAgICBjb25zdCB7IGNvbW1hbmQsIGFyZ3MsIGVudiB9ID0gc2VydmVyLnRyYW5zcG9ydDtcbiAgICAgICAgICBjb25zdCBzYWZlUHJvY2Vzc0VudiA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHByb2Nlc3MuZW52KS5maWx0ZXIoKFssIHZdKSA9PiB2ICE9PSB2b2lkIDApXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCBmaW5hbEVudiA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBzYWZlUHJvY2Vzc0VudiksIGVudik7XG4gICAgICAgICAgcmV0dXJuIG5ldyBTdGRpb0NsaWVudFRyYW5zcG9ydCh7XG4gICAgICAgICAgICBjb21tYW5kLFxuICAgICAgICAgICAgYXJncyxcbiAgICAgICAgICAgIGVudjogZmluYWxFbnZcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pKCk7XG4gICAgY29uc3QgY2xpZW50ID0gbmV3IE1DUENsaWVudChcbiAgICAgIHtcbiAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAvLyBYWFg6IFRoaXMgdmVyc2lvbiBzaG91bGQgY2hhbmdlLlxuICAgICAgICB2ZXJzaW9uOiBcIjEuMC4wXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNhcGFiaWxpdGllczoge31cbiAgICAgIH1cbiAgICApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBjbGllbnQuY29ubmVjdCh0cmFuc3BvcnQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIm1jcCBzZXJ2ZXIgZGlzY29ubmVjdGVkXCIsIHNlcnZlciwgZSk7XG4gICAgfVxuICAgIHJldHVybiBjbGllbnQ7XG4gIH1cbn07XG52YXIgUm91dGluZ0FnZW50ID0gY2xhc3MgX1JvdXRpbmdBZ2VudCBleHRlbmRzIEFnZW50IHtcbiAgY29uc3RydWN0b3Iob3B0cykge1xuICAgIHN1cGVyKG9wdHMpO1xuICAgIHRoaXMudHlwZSA9IFwicm91dGluZ1wiO1xuICAgIHRoaXMubGlmZWN5Y2xlcyA9IG9wdHMubGlmZWN5Y2xlO1xuICB9XG4gIHdpdGhNb2RlbChtb2RlbCkge1xuICAgIHJldHVybiBuZXcgX1JvdXRpbmdBZ2VudCh7XG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbixcbiAgICAgIHN5c3RlbTogdGhpcy5zeXN0ZW0sXG4gICAgICBhc3Npc3RhbnQ6IHRoaXMuYXNzaXN0YW50LFxuICAgICAgdG9vbHM6IEFycmF5LmZyb20odGhpcy50b29scy52YWx1ZXMoKSksXG4gICAgICBsaWZlY3ljbGU6IHRoaXMubGlmZWN5Y2xlcyxcbiAgICAgIG1vZGVsXG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHNyYy9uZXR3b3JrLnRzXG52YXIgY3JlYXRlTmV0d29yayA9IChvcHRzKSA9PiBuZXcgTmV0d29yayhvcHRzKTtcbnZhciBOZXR3b3JrID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbmFtZSxcbiAgICBkZXNjcmlwdGlvbixcbiAgICBhZ2VudHMsXG4gICAgZGVmYXVsdE1vZGVsLFxuICAgIG1heEl0ZXIsXG4gICAgZGVmYXVsdFN0YXRlLFxuICAgIHJvdXRlcixcbiAgICBkZWZhdWx0Um91dGVyLFxuICAgIGhpc3RvcnlcbiAgfSkge1xuICAgIHRoaXMuX2NvdW50ZXIgPSAwO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIHRoaXMuYWdlbnRzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICB0aGlzLl9hZ2VudHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHRoaXMuZGVmYXVsdE1vZGVsID0gZGVmYXVsdE1vZGVsO1xuICAgIHRoaXMucm91dGVyID0gZGVmYXVsdFJvdXRlciAhPSBudWxsID8gZGVmYXVsdFJvdXRlciA6IHJvdXRlcjtcbiAgICB0aGlzLm1heEl0ZXIgPSBtYXhJdGVyIHx8IDA7XG4gICAgdGhpcy5fc3RhY2sgPSBbXTtcbiAgICB0aGlzLmhpc3RvcnkgPSBoaXN0b3J5O1xuICAgIGlmIChkZWZhdWx0U3RhdGUpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBkZWZhdWx0U3RhdGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBjcmVhdGVTdGF0ZSgpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIGFnZW50cykge1xuICAgICAgdGhpcy5hZ2VudHMuc2V0KGFnZW50Lm5hbWUsIGFnZW50KTtcbiAgICAgIHRoaXMuX2FnZW50cy5zZXQoYWdlbnQubmFtZSwgYWdlbnQpO1xuICAgIH1cbiAgfVxuICBhc3luYyBhdmFpbGFibGVBZ2VudHMobmV0d29ya1J1biA9IG5ldyBOZXR3b3JrUnVuKHRoaXMsIG5ldyBTdGF0ZSgpKSkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBhdmFpbGFibGUgPSBbXTtcbiAgICBjb25zdCBhbGwgPSBBcnJheS5mcm9tKHRoaXMuYWdlbnRzLnZhbHVlcygpKTtcbiAgICBmb3IgKGNvbnN0IGEgb2YgYWxsKSB7XG4gICAgICBjb25zdCBlbmFibGVkID0gKF9hID0gYSA9PSBudWxsID8gdm9pZCAwIDogYS5saWZlY3ljbGVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZW5hYmxlZDtcbiAgICAgIGlmICghZW5hYmxlZCB8fCBhd2FpdCBlbmFibGVkKHsgYWdlbnQ6IGEsIG5ldHdvcms6IG5ldHdvcmtSdW4gfSkpIHtcbiAgICAgICAgYXZhaWxhYmxlLnB1c2goYSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhdmFpbGFibGU7XG4gIH1cbiAgLyoqXG4gICAqIGFkZEFnZW50IGFkZHMgYSBuZXcgYWdlbnQgdG8gdGhlIG5ldHdvcmsuXG4gICAqL1xuICBhZGRBZ2VudChhZ2VudCkge1xuICAgIHRoaXMuYWdlbnRzLnNldChhZ2VudC5uYW1lLCBhZ2VudCk7XG4gIH1cbiAgLyoqXG4gICAqIHJ1biBoYW5kbGVzIGEgZ2l2ZW4gcmVxdWVzdCB1c2luZyB0aGUgbmV0d29yayBvZiBhZ2VudHMuICBJdCBpcyBub3RcbiAgICogY29uY3VycmVuY3ktc2FmZTsgeW91IGNhbiBvbmx5IGNhbGwgcnVuIG9uIGEgbmV0d29yayBvbmNlLCBhcyBuZXR3b3JrcyBhcmVcbiAgICogc3RhdGVmdWwuXG4gICAqXG4gICAqL1xuICBydW4oLi4uW2lucHV0LCBvdmVycmlkZXNdKSB7XG4gICAgdmFyIF9hO1xuICAgIGxldCBzdGF0ZTtcbiAgICBpZiAob3ZlcnJpZGVzID09IG51bGwgPyB2b2lkIDAgOiBvdmVycmlkZXMuc3RhdGUpIHtcbiAgICAgIGlmIChvdmVycmlkZXMuc3RhdGUgaW5zdGFuY2VvZiBTdGF0ZSkge1xuICAgICAgICBzdGF0ZSA9IG92ZXJyaWRlcy5zdGF0ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHN0YXRlT2JqID0gb3ZlcnJpZGVzLnN0YXRlO1xuICAgICAgICBzdGF0ZSA9IG5ldyBTdGF0ZSh7XG4gICAgICAgICAgZGF0YTogc3RhdGVPYmouZGF0YSB8fCB7fSxcbiAgICAgICAgICBtZXNzYWdlczogc3RhdGVPYmouX21lc3NhZ2VzIHx8IFtdLFxuICAgICAgICAgIHJlc3VsdHM6IHN0YXRlT2JqLl9yZXN1bHRzIHx8IFtdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzdGF0ZSA9ICgoX2EgPSB0aGlzLnN0YXRlKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2xvbmUoKSkgfHwgbmV3IFN0YXRlKCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgTmV0d29ya1J1bih0aGlzLCBzdGF0ZSlbXCJleGVjdXRlXCJdKGlucHV0LCBvdmVycmlkZXMpO1xuICB9XG59O1xudmFyIGRlZmF1bHRSb3V0aW5nQWdlbnQ7XG52YXIgZ2V0RGVmYXVsdFJvdXRpbmdBZ2VudCA9ICgpID0+IHtcbiAgZGVmYXVsdFJvdXRpbmdBZ2VudCAhPSBudWxsID8gZGVmYXVsdFJvdXRpbmdBZ2VudCA6IGRlZmF1bHRSb3V0aW5nQWdlbnQgPSBjcmVhdGVSb3V0aW5nQWdlbnQoe1xuICAgIG5hbWU6IFwiRGVmYXVsdCByb3V0aW5nIGFnZW50XCIsXG4gICAgZGVzY3JpcHRpb246IFwiU2VsZWN0cyB3aGljaCBhZ2VudHMgdG8gd29yayBvbiBiYXNlZCBvZmYgb2YgdGhlIGN1cnJlbnQgcHJvbXB0IGFuZCBpbnB1dC5cIixcbiAgICBsaWZlY3ljbGU6IHtcbiAgICAgIG9uUm91dGU6ICh7IHJlc3VsdCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHRvb2wgPSByZXN1bHQudG9vbENhbGxzWzBdO1xuICAgICAgICBpZiAoIXRvb2wpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB0b29sLmNvbnRlbnQgPT09IFwib2JqZWN0XCIgJiYgdG9vbC5jb250ZW50ICE9PSBudWxsICYmIFwiZGF0YVwiIGluIHRvb2wuY29udGVudCAmJiB0eXBlb2YgdG9vbC5jb250ZW50LmRhdGEgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICByZXR1cm4gW3Rvb2wuY29udGVudC5kYXRhXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSxcbiAgICB0b29sczogW1xuICAgICAgLy8gVGhpcyB0b29sIGRvZXMgbm90aGluZyBidXQgZW5zdXJlIHRoYXQgdGhlIG1vZGVsIHJlc3BvbmRzIHdpdGggdGhlXG4gICAgICAvLyBhZ2VudCBuYW1lIGFzIHZhbGlkIEpTT04uXG4gICAgICBjcmVhdGVUb29sKHtcbiAgICAgICAgbmFtZTogXCJzZWxlY3RfYWdlbnRcIixcbiAgICAgICAgZGVzY3JpcHRpb246IFwic2VsZWN0IGFuIGFnZW50IHRvIGhhbmRsZSB0aGUgaW5wdXQsIGJhc2VkIG9mZiBvZiB0aGUgY3VycmVudCBjb252ZXJzYXRpb25cIixcbiAgICAgICAgcGFyYW1ldGVyczogejMub2JqZWN0KHtcbiAgICAgICAgICBuYW1lOiB6My5zdHJpbmcoKS5kZXNjcmliZShcIlRoZSBuYW1lIG9mIHRoZSBhZ2VudCB0aGF0IHNob3VsZCBoYW5kbGUgdGhlIHJlcXVlc3RcIilcbiAgICAgICAgfSkuc3RyaWN0KCksXG4gICAgICAgIGhhbmRsZXI6ICh7IG5hbWUgfSwgeyBuZXR3b3JrIH0pID0+IHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSByb3V0aW5nIGFnZW50IHJlcXVlc3RlZCBhbiBpbnZhbGlkIGFnZW50XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBhZ2VudCA9IG5ldHdvcmsuYWdlbnRzLmdldChuYW1lKTtcbiAgICAgICAgICBpZiAoYWdlbnQgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICBgVGhlIHJvdXRpbmcgYWdlbnQgcmVxdWVzdGVkIGFuIGFnZW50IHRoYXQgZG9lc24ndCBleGlzdDogJHtuYW1lfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBhZ2VudC5uYW1lO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIF0sXG4gICAgdG9vbF9jaG9pY2U6IFwic2VsZWN0X2FnZW50XCIsXG4gICAgc3lzdGVtOiBhc3luYyAoeyBuZXR3b3JrIH0pID0+IHtcbiAgICAgIGlmICghbmV0d29yaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJUaGUgcm91dGluZyBhZ2VudCBjYW4gb25seSBiZSB1c2VkIHdpdGhpbiBhIG5ldHdvcmsgb2YgYWdlbnRzXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFnZW50cyA9IGF3YWl0IChuZXR3b3JrID09IG51bGwgPyB2b2lkIDAgOiBuZXR3b3JrLmF2YWlsYWJsZUFnZW50cygpKTtcbiAgICAgIHJldHVybiBgWW91IGFyZSB0aGUgb3JjaGVzdHJhdG9yIGJldHdlZW4gYSBncm91cCBvZiBhZ2VudHMuICBFYWNoIGFnZW50IGlzIHN1aXRlZCBmb3IgYSBzZXQgb2Ygc3BlY2lmaWMgdGFza3MsIGFuZCBoYXMgYSBuYW1lLCBpbnN0cnVjdGlvbnMsIGFuZCBhIHNldCBvZiB0b29scy5cblxuVGhlIGZvbGxvd2luZyBhZ2VudHMgYXJlIGF2YWlsYWJsZTpcbjxhZ2VudHM+XG4gICR7YWdlbnRzLm1hcCgoYSkgPT4ge1xuICAgICAgICByZXR1cm4gYFxuICAgIDxhZ2VudD5cbiAgICAgIDxuYW1lPiR7YS5uYW1lfTwvbmFtZT5cbiAgICAgIDxkZXNjcmlwdGlvbj4ke2EuZGVzY3JpcHRpb259PC9kZXNjcmlwdGlvbj5cbiAgICAgIDx0b29scz4ke0pTT04uc3RyaW5naWZ5KEFycmF5LmZyb20oYS50b29scy52YWx1ZXMoKSkpfTwvdG9vbHM+XG4gICAgPC9hZ2VudD5gO1xuICAgICAgfSkuam9pbihcIlxcblwiKX1cbjwvYWdlbnRzPlxuXG5Gb2xsb3cgdGhlIHNldCBvZiBpbnN0cnVjdGlvbnM6XG5cbjxpbnN0cnVjdGlvbnM+XG4gIFRoaW5rIGFib3V0IHRoZSBjdXJyZW50IGhpc3RvcnkgYW5kIHN0YXR1cy4gIERldGVybWluZSB3aGljaCBhZ2VudCB0byB1c2UgdG8gaGFuZGxlIHRoZSB1c2VyJ3MgcmVxdWVzdCwgYmFzZWQgb2ZmIG9mIHRoZSBjdXJyZW50IGFnZW50cyBhbmQgdGhlaXIgdG9vbHMuXG5cbiAgWW91ciBhaW0gaXMgdG8gdGhvcm91Z2hseSBjb21wbGV0ZSB0aGUgcmVxdWVzdCwgdGhpbmtpbmcgc3RlcCBieSBzdGVwLCBjaG9vc2luZyB0aGUgcmlnaHQgYWdlbnQgYmFzZWQgb2ZmIG9mIHRoZSBjb250ZXh0LlxuPC9pbnN0cnVjdGlvbnM+XG4gICAgYDtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gZGVmYXVsdFJvdXRpbmdBZ2VudDtcbn07XG52YXIgTmV0d29ya1J1biA9IGNsYXNzIGV4dGVuZHMgTmV0d29yayB7XG4gIGNvbnN0cnVjdG9yKG5ldHdvcmssIHN0YXRlKSB7XG4gICAgc3VwZXIoe1xuICAgICAgbmFtZTogbmV0d29yay5uYW1lLFxuICAgICAgZGVzY3JpcHRpb246IG5ldHdvcmsuZGVzY3JpcHRpb24sXG4gICAgICBhZ2VudHM6IEFycmF5LmZyb20obmV0d29yay5hZ2VudHMudmFsdWVzKCkpLFxuICAgICAgZGVmYXVsdE1vZGVsOiBuZXR3b3JrLmRlZmF1bHRNb2RlbCxcbiAgICAgIGRlZmF1bHRTdGF0ZTogbmV0d29yay5zdGF0ZSxcbiAgICAgIHJvdXRlcjogbmV0d29yay5yb3V0ZXIsXG4gICAgICBtYXhJdGVyOiBuZXR3b3JrLm1heEl0ZXIsXG4gICAgICBoaXN0b3J5OiBuZXR3b3JrLmhpc3RvcnlcbiAgICB9KTtcbiAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gIH1cbiAgcnVuKCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk5ldHdvcmtSdW4gZG9lcyBub3Qgc3VwcG9ydCBydW5cIik7XG4gIH1cbiAgYXN5bmMgYXZhaWxhYmxlQWdlbnRzKCkge1xuICAgIHJldHVybiBzdXBlci5hdmFpbGFibGVBZ2VudHModGhpcyk7XG4gIH1cbiAgLyoqXG4gICAqIFNjaGVkdWxlIGlzIHVzZWQgdG8gcHVzaCBhbiBhZ2VudCdzIHJ1biBmdW5jdGlvbiBvbnRvIHRoZSBzdGFjay5cbiAgICovXG4gIHNjaGVkdWxlKGFnZW50TmFtZSkge1xuICAgIHRoaXNbXCJfc3RhY2tcIl0ucHVzaChhZ2VudE5hbWUpO1xuICB9XG4gIGFzeW5jIGV4ZWN1dGUoLi4uW2lucHV0LCBvdmVycmlkZXNdKSB7XG4gICAgYXdhaXQgaW5pdGlhbGl6ZVRocmVhZCh7XG4gICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgIGhpc3Rvcnk6IHRoaXMuaGlzdG9yeSxcbiAgICAgIGlucHV0LFxuICAgICAgbmV0d29yazogdGhpc1xuICAgIH0pO1xuICAgIGF3YWl0IGxvYWRUaHJlYWRGcm9tU3RvcmFnZSh7XG4gICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgIGhpc3Rvcnk6IHRoaXMuaGlzdG9yeSxcbiAgICAgIGlucHV0LFxuICAgICAgbmV0d29yazogdGhpc1xuICAgIH0pO1xuICAgIGNvbnN0IGF2YWlsYWJsZSA9IGF3YWl0IHRoaXMuYXZhaWxhYmxlQWdlbnRzKCk7XG4gICAgaWYgKGF2YWlsYWJsZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIm5vIGFnZW50cyBlbmFibGVkIGluIG5ldHdvcmtcIik7XG4gICAgfVxuICAgIGNvbnN0IGluaXRpYWxSZXN1bHRDb3VudCA9IHRoaXMuc3RhdGUucmVzdWx0cy5sZW5ndGg7XG4gICAgY29uc3QgbmV4dCA9IGF3YWl0IHRoaXMuZ2V0TmV4dEFnZW50cyhcbiAgICAgIGlucHV0LFxuICAgICAgKG92ZXJyaWRlcyA9PSBudWxsID8gdm9pZCAwIDogb3ZlcnJpZGVzLnJvdXRlcikgfHwgKG92ZXJyaWRlcyA9PSBudWxsID8gdm9pZCAwIDogb3ZlcnJpZGVzLmRlZmF1bHRSb3V0ZXIpIHx8IHRoaXMucm91dGVyXG4gICAgKTtcbiAgICBpZiAoIShuZXh0ID09IG51bGwgPyB2b2lkIDAgOiBuZXh0Lmxlbmd0aCkpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGFnZW50IG9mIG5leHQpIHtcbiAgICAgIHRoaXMuc2NoZWR1bGUoYWdlbnQubmFtZSk7XG4gICAgfVxuICAgIHdoaWxlICh0aGlzLl9zdGFjay5sZW5ndGggPiAwICYmICh0aGlzLm1heEl0ZXIgPT09IDAgfHwgdGhpcy5fY291bnRlciA8IHRoaXMubWF4SXRlcikpIHtcbiAgICAgIGNvbnN0IGFnZW50TmFtZSA9IHRoaXMuX3N0YWNrLnNoaWZ0KCk7XG4gICAgICBjb25zdCBhZ2VudCA9IGFnZW50TmFtZSAmJiB0aGlzLl9hZ2VudHMuZ2V0KGFnZW50TmFtZSk7XG4gICAgICBpZiAoIWFnZW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FsbCA9IGF3YWl0IGFnZW50LnJ1bihpbnB1dCwgeyBuZXR3b3JrOiB0aGlzLCBtYXhJdGVyOiAwIH0pO1xuICAgICAgdGhpcy5fY291bnRlciArPSAxO1xuICAgICAgdGhpcy5zdGF0ZS5hcHBlbmRSZXN1bHQoY2FsbCk7XG4gICAgICBjb25zdCBuZXh0MiA9IGF3YWl0IHRoaXMuZ2V0TmV4dEFnZW50cyhcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIChvdmVycmlkZXMgPT0gbnVsbCA/IHZvaWQgMCA6IG92ZXJyaWRlcy5yb3V0ZXIpIHx8IChvdmVycmlkZXMgPT0gbnVsbCA/IHZvaWQgMCA6IG92ZXJyaWRlcy5kZWZhdWx0Um91dGVyKSB8fCB0aGlzLnJvdXRlclxuICAgICAgKTtcbiAgICAgIGZvciAoY29uc3QgYSBvZiBuZXh0MiB8fCBbXSkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGEubmFtZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGF3YWl0IHNhdmVUaHJlYWRUb1N0b3JhZ2Uoe1xuICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXG4gICAgICBoaXN0b3J5OiB0aGlzLmhpc3RvcnksXG4gICAgICBpbnB1dCxcbiAgICAgIGluaXRpYWxSZXN1bHRDb3VudCxcbiAgICAgIG5ldHdvcms6IHRoaXNcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBhc3luYyBnZXROZXh0QWdlbnRzKGlucHV0LCByb3V0ZXIpIHtcbiAgICBpZiAoIXJvdXRlciAmJiAhdGhpcy5kZWZhdWx0TW9kZWwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJObyByb3V0ZXIgb3IgbW9kZWwgZGVmaW5lZCBpbiBuZXR3b3JrLiAgWW91IG11c3QgcGFzcyBhIHJvdXRlciBvciBhIGRlZmF1bHQgbW9kZWwgdG8gdXNlIHRoZSBidWlsdC1pbiBhZ2VudGljIHJvdXRlci5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKCFyb3V0ZXIpIHtcbiAgICAgIHJvdXRlciA9IGdldERlZmF1bHRSb3V0aW5nQWdlbnQoKTtcbiAgICB9XG4gICAgaWYgKHJvdXRlciBpbnN0YW5jZW9mIFJvdXRpbmdBZ2VudCkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TmV4dEFnZW50c1ZpYVJvdXRpbmdBZ2VudChyb3V0ZXIsIGlucHV0KTtcbiAgICB9XG4gICAgY29uc3Qgc3RhY2sgPSB0aGlzLl9zdGFjay5tYXAoKG5hbWUpID0+IHtcbiAgICAgIGNvbnN0IGFnZW50MiA9IHRoaXMuX2FnZW50cy5nZXQobmFtZSk7XG4gICAgICBpZiAoIWFnZW50Mikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gYWdlbnQgaW4gdGhlIG5ldHdvcmsgc3RhY2s6ICR7bmFtZX1gKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhZ2VudDI7XG4gICAgfSk7XG4gICAgY29uc3QgYWdlbnQgPSBhd2FpdCByb3V0ZXIoe1xuICAgICAgaW5wdXQsXG4gICAgICBuZXR3b3JrOiB0aGlzLFxuICAgICAgc3RhY2ssXG4gICAgICBsYXN0UmVzdWx0OiB0aGlzLnN0YXRlLnJlc3VsdHMucG9wKCksXG4gICAgICBjYWxsQ291bnQ6IHRoaXMuX2NvdW50ZXJcbiAgICB9KTtcbiAgICBpZiAoIWFnZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChhZ2VudCBpbnN0YW5jZW9mIFJvdXRpbmdBZ2VudCkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TmV4dEFnZW50c1ZpYVJvdXRpbmdBZ2VudChhZ2VudCwgaW5wdXQpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGEgb2YgQXJyYXkuaXNBcnJheShhZ2VudCkgPyBhZ2VudCA6IFthZ2VudF0pIHtcbiAgICAgIGlmICghdGhpcy5fYWdlbnRzLmhhcyhhLm5hbWUpKSB7XG4gICAgICAgIHRoaXMuX2FnZW50cy5zZXQoYS5uYW1lLCBhKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYWdlbnQpID8gYWdlbnQgOiBbYWdlbnRdO1xuICB9XG4gIGFzeW5jIGdldE5leHRBZ2VudHNWaWFSb3V0aW5nQWdlbnQocm91dGluZ0FnZW50LCBpbnB1dCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJvdXRpbmdBZ2VudC5ydW4oaW5wdXQsIHtcbiAgICAgIG5ldHdvcms6IHRoaXMsXG4gICAgICBtb2RlbDogcm91dGluZ0FnZW50Lm1vZGVsIHx8IHRoaXMuZGVmYXVsdE1vZGVsXG4gICAgfSk7XG4gICAgY29uc3QgYWdlbnROYW1lcyA9IHJvdXRpbmdBZ2VudC5saWZlY3ljbGVzLm9uUm91dGUoe1xuICAgICAgcmVzdWx0LFxuICAgICAgYWdlbnQ6IHJvdXRpbmdBZ2VudCxcbiAgICAgIG5ldHdvcms6IHRoaXNcbiAgICB9KTtcbiAgICByZXR1cm4gKGFnZW50TmFtZXMgfHwgW10pLm1hcCgobmFtZSkgPT4gdGhpcy5hZ2VudHMuZ2V0KG5hbWUpKS5maWx0ZXIoQm9vbGVhbik7XG4gIH1cbn07XG5cbi8vIHNyYy9oaXN0b3J5LnRzXG5pbXBvcnQgXCJpbm5nZXN0XCI7XG5hc3luYyBmdW5jdGlvbiBpbml0aWFsaXplVGhyZWFkKGNvbmZpZykge1xuICBjb25zdCB7IHN0YXRlLCBoaXN0b3J5LCBpbnB1dCwgbmV0d29yayB9ID0gY29uZmlnO1xuICBpZiAoIWhpc3RvcnkpIHJldHVybjtcbiAgY29uc3Qgc3RlcCA9IGF3YWl0IGdldFN0ZXBUb29scygpO1xuICBpZiAoIXN0YXRlLnRocmVhZElkICYmIGhpc3RvcnkuY3JlYXRlVGhyZWFkKSB7XG4gICAgY29uc3QgeyB0aHJlYWRJZCB9ID0gYXdhaXQgaGlzdG9yeS5jcmVhdGVUaHJlYWQoe1xuICAgICAgc3RhdGUsXG4gICAgICBuZXR3b3JrLFxuICAgICAgaW5wdXQsXG4gICAgICBzdGVwXG4gICAgfSk7XG4gICAgc3RhdGUudGhyZWFkSWQgPSB0aHJlYWRJZDtcbiAgfSBlbHNlIGlmICghc3RhdGUudGhyZWFkSWQgJiYgaGlzdG9yeS5nZXQpIHtcbiAgICBzdGF0ZS50aHJlYWRJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgaWYgKGhpc3RvcnkuY3JlYXRlVGhyZWFkKSB7XG4gICAgICBhd2FpdCBoaXN0b3J5LmNyZWF0ZVRocmVhZCh7XG4gICAgICAgIHN0YXRlLFxuICAgICAgICBuZXR3b3JrLFxuICAgICAgICBpbnB1dCxcbiAgICAgICAgc3RlcFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5hc3luYyBmdW5jdGlvbiBsb2FkVGhyZWFkRnJvbVN0b3JhZ2UoY29uZmlnKSB7XG4gIGNvbnN0IHsgc3RhdGUsIGhpc3RvcnksIGlucHV0LCBuZXR3b3JrIH0gPSBjb25maWc7XG4gIGlmICghKGhpc3RvcnkgPT0gbnVsbCA/IHZvaWQgMCA6IGhpc3RvcnkuZ2V0KSB8fCAhc3RhdGUudGhyZWFkSWQgfHwgc3RhdGUucmVzdWx0cy5sZW5ndGggPiAwIHx8IHN0YXRlLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3Qgc3RlcCA9IGF3YWl0IGdldFN0ZXBUb29scygpO1xuICBjb25zdCBoaXN0b3J5UmVzdWx0cyA9IGF3YWl0IGhpc3RvcnkuZ2V0KHtcbiAgICBzdGF0ZSxcbiAgICBuZXR3b3JrLFxuICAgIGlucHV0LFxuICAgIHN0ZXAsXG4gICAgdGhyZWFkSWQ6IHN0YXRlLnRocmVhZElkXG4gIH0pO1xuICBzdGF0ZS5zZXRSZXN1bHRzKGhpc3RvcnlSZXN1bHRzKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNhdmVUaHJlYWRUb1N0b3JhZ2UoY29uZmlnKSB7XG4gIGNvbnN0IHsgc3RhdGUsIGhpc3RvcnksIGlucHV0LCBpbml0aWFsUmVzdWx0Q291bnQsIG5ldHdvcmsgfSA9IGNvbmZpZztcbiAgaWYgKCEoaGlzdG9yeSA9PSBudWxsID8gdm9pZCAwIDogaGlzdG9yeS5hcHBlbmRSZXN1bHRzKSkgcmV0dXJuO1xuICBjb25zdCBzdGVwID0gYXdhaXQgZ2V0U3RlcFRvb2xzKCk7XG4gIGNvbnN0IG5ld1Jlc3VsdHMgPSBzdGF0ZS5nZXRSZXN1bHRzRnJvbShpbml0aWFsUmVzdWx0Q291bnQpO1xuICBjb25zdCB1c2VyTWVzc2FnZSA9IGlucHV0LnRyaW0oKSA/IHtcbiAgICBjb250ZW50OiBpbnB1dCxcbiAgICByb2xlOiBcInVzZXJcIixcbiAgICB0aW1lc3RhbXA6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gIH0gOiB2b2lkIDA7XG4gIGF3YWl0IGhpc3RvcnkuYXBwZW5kUmVzdWx0cyh7XG4gICAgc3RhdGUsXG4gICAgbmV0d29yayxcbiAgICBzdGVwLFxuICAgIG5ld1Jlc3VsdHMsXG4gICAgaW5wdXQsXG4gICAgdGhyZWFkSWQ6IHN0YXRlLnRocmVhZElkLFxuICAgIHVzZXJNZXNzYWdlXG4gIH0pO1xufVxuXG5leHBvcnQge1xuICBfX3NwcmVhZFZhbHVlcyxcbiAgX19zcHJlYWRQcm9wcyxcbiAgQWdlbnRSZXN1bHQsXG4gIGNyZWF0ZVN0YXRlLFxuICBTdGF0ZSxcbiAgc3RyaW5naWZ5RXJyb3IsXG4gIGdldFN0ZXBUb29scyxcbiAgaXNJbm5nZXN0Rm4sXG4gIGdldElubmdlc3RGbklucHV0LFxuICBpbml0aWFsaXplVGhyZWFkLFxuICBsb2FkVGhyZWFkRnJvbVN0b3JhZ2UsXG4gIHNhdmVUaHJlYWRUb1N0b3JhZ2UsXG4gIGNyZWF0ZU5ldHdvcmssXG4gIE5ldHdvcmssXG4gIGdldERlZmF1bHRSb3V0aW5nQWdlbnQsXG4gIE5ldHdvcmtSdW4sXG4gIGNyZWF0ZVRvb2wsXG4gIGNyZWF0ZUFnZW50aWNNb2RlbEZyb21BaUFkYXB0ZXIsXG4gIEFnZW50aWNNb2RlbCxcbiAgY3JlYXRlQWdlbnQsXG4gIGNyZWF0ZVJvdXRpbmdBZ2VudCxcbiAgQWdlbnQsXG4gIFJvdXRpbmdBZ2VudFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNodW5rLUo3Nk00S0xXLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/agent-kit/dist/chunk-J76M4KLW.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/agent-kit/dist/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/@inngest/agent-kit/dist/index.js ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Agent: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.Agent),\n/* harmony export */   AgentResult: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.AgentResult),\n/* harmony export */   AgenticModel: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.AgenticModel),\n/* harmony export */   Network: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.Network),\n/* harmony export */   NetworkRun: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.NetworkRun),\n/* harmony export */   RoutingAgent: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.RoutingAgent),\n/* harmony export */   State: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.State),\n/* harmony export */   anthropic: () => (/* reexport safe */ _inngest_ai__WEBPACK_IMPORTED_MODULE_1__.anthropic),\n/* harmony export */   createAgent: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.createAgent),\n/* harmony export */   createAgenticModelFromAiAdapter: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.createAgenticModelFromAiAdapter),\n/* harmony export */   createNetwork: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.createNetwork),\n/* harmony export */   createRoutingAgent: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.createRoutingAgent),\n/* harmony export */   createState: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.createState),\n/* harmony export */   createTool: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.createTool),\n/* harmony export */   gemini: () => (/* reexport safe */ _inngest_ai__WEBPACK_IMPORTED_MODULE_1__.gemini),\n/* harmony export */   getDefaultRoutingAgent: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.getDefaultRoutingAgent),\n/* harmony export */   getInngestFnInput: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.getInngestFnInput),\n/* harmony export */   getStepTools: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.getStepTools),\n/* harmony export */   grok: () => (/* reexport safe */ _inngest_ai__WEBPACK_IMPORTED_MODULE_1__.grok),\n/* harmony export */   initializeThread: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.initializeThread),\n/* harmony export */   isInngestFn: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.isInngestFn),\n/* harmony export */   loadThreadFromStorage: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.loadThreadFromStorage),\n/* harmony export */   openai: () => (/* reexport safe */ _inngest_ai__WEBPACK_IMPORTED_MODULE_1__.openai),\n/* harmony export */   saveThreadToStorage: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.saveThreadToStorage),\n/* harmony export */   stringifyError: () => (/* reexport safe */ _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__.stringifyError)\n/* harmony export */ });\n/* harmony import */ var _chunk_J76M4KLW_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-J76M4KLW.js */ \"(rsc)/./node_modules/@inngest/agent-kit/dist/chunk-J76M4KLW.js\");\n/* harmony import */ var _inngest_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @inngest/ai */ \"(rsc)/./node_modules/@inngest/ai/dist/index.js\");\n\n\n// src/models.ts\n\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWdlbnQta2l0L2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0I2Qjs7QUFFN0I7QUFDOEQ7QUEyQjVEO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWdlbnQta2l0L2Rpc3QvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWdlbnQsXG4gIEFnZW50UmVzdWx0LFxuICBBZ2VudGljTW9kZWwsXG4gIE5ldHdvcmssXG4gIE5ldHdvcmtSdW4sXG4gIFJvdXRpbmdBZ2VudCxcbiAgU3RhdGUsXG4gIGNyZWF0ZUFnZW50LFxuICBjcmVhdGVBZ2VudGljTW9kZWxGcm9tQWlBZGFwdGVyLFxuICBjcmVhdGVOZXR3b3JrLFxuICBjcmVhdGVSb3V0aW5nQWdlbnQsXG4gIGNyZWF0ZVN0YXRlLFxuICBjcmVhdGVUb29sLFxuICBnZXREZWZhdWx0Um91dGluZ0FnZW50LFxuICBnZXRJbm5nZXN0Rm5JbnB1dCxcbiAgZ2V0U3RlcFRvb2xzLFxuICBpbml0aWFsaXplVGhyZWFkLFxuICBpc0lubmdlc3RGbixcbiAgbG9hZFRocmVhZEZyb21TdG9yYWdlLFxuICBzYXZlVGhyZWFkVG9TdG9yYWdlLFxuICBzdHJpbmdpZnlFcnJvclxufSBmcm9tIFwiLi9jaHVuay1KNzZNNEtMVy5qc1wiO1xuXG4vLyBzcmMvbW9kZWxzLnRzXG5pbXBvcnQgeyBhbnRocm9waWMsIGdlbWluaSwgb3BlbmFpLCBncm9rIH0gZnJvbSBcIkBpbm5nZXN0L2FpXCI7XG5leHBvcnQge1xuICBBZ2VudCxcbiAgQWdlbnRSZXN1bHQsXG4gIEFnZW50aWNNb2RlbCxcbiAgTmV0d29yayxcbiAgTmV0d29ya1J1bixcbiAgUm91dGluZ0FnZW50LFxuICBTdGF0ZSxcbiAgYW50aHJvcGljLFxuICBjcmVhdGVBZ2VudCxcbiAgY3JlYXRlQWdlbnRpY01vZGVsRnJvbUFpQWRhcHRlcixcbiAgY3JlYXRlTmV0d29yayxcbiAgY3JlYXRlUm91dGluZ0FnZW50LFxuICBjcmVhdGVTdGF0ZSxcbiAgY3JlYXRlVG9vbCxcbiAgZ2VtaW5pLFxuICBnZXREZWZhdWx0Um91dGluZ0FnZW50LFxuICBnZXRJbm5nZXN0Rm5JbnB1dCxcbiAgZ2V0U3RlcFRvb2xzLFxuICBncm9rLFxuICBpbml0aWFsaXplVGhyZWFkLFxuICBpc0lubmdlc3RGbixcbiAgbG9hZFRocmVhZEZyb21TdG9yYWdlLFxuICBvcGVuYWksXG4gIHNhdmVUaHJlYWRUb1N0b3JhZ2UsXG4gIHN0cmluZ2lmeUVycm9yXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/agent-kit/dist/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/adapters/anthropic.js":
/*!*************************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/adapters/anthropic.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n//# sourceMappingURL=anthropic.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9hbnRocm9waWMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9hbnRocm9waWMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbnRocm9waWMuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/adapters/anthropic.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/adapters/gemini.js":
/*!**********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/adapters/gemini.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.GeminiAiAdapter = void 0;\nvar GeminiAiAdapter;\n(function (GeminiAiAdapter) {\n    let HarmCategory;\n    (function (HarmCategory) {\n        HarmCategory[\"HARM_CATEGORY_UNSPECIFIED\"] = \"HARM_CATEGORY_UNSPECIFIED\";\n        HarmCategory[\"HARM_CATEGORY_HATE_SPEECH\"] = \"HARM_CATEGORY_HATE_SPEECH\";\n        HarmCategory[\"HARM_CATEGORY_SEXUALLY_EXPLICIT\"] = \"HARM_CATEGORY_SEXUALLY_EXPLICIT\";\n        HarmCategory[\"HARM_CATEGORY_DANGEROUS_CONTENT\"] = \"HARM_CATEGORY_DANGEROUS_CONTENT\";\n        HarmCategory[\"HARM_CATEGORY_HARASSMENT\"] = \"HARM_CATEGORY_HARASSMENT\";\n        HarmCategory[\"HARM_CATEGORY_CIVIC_INTEGRITY\"] = \"HARM_CATEGORY_CIVIC_INTEGRITY\";\n    })(HarmCategory = GeminiAiAdapter.HarmCategory || (GeminiAiAdapter.HarmCategory = {}));\n    let HarmBlockThreshold;\n    (function (HarmBlockThreshold) {\n        HarmBlockThreshold[\"HARM_BLOCK_THRESHOLD_UNSPECIFIED\"] = \"HARM_BLOCK_THRESHOLD_UNSPECIFIED\";\n        HarmBlockThreshold[\"BLOCK_LOW_AND_ABOVE\"] = \"BLOCK_LOW_AND_ABOVE\";\n        HarmBlockThreshold[\"BLOCK_MEDIUM_AND_ABOVE\"] = \"BLOCK_MEDIUM_AND_ABOVE\";\n        HarmBlockThreshold[\"BLOCK_ONLY_HIGH\"] = \"BLOCK_ONLY_HIGH\";\n        HarmBlockThreshold[\"BLOCK_NONE\"] = \"BLOCK_NONE\";\n        HarmBlockThreshold[\"OFF\"] = \"OFF\";\n    })(HarmBlockThreshold = GeminiAiAdapter.HarmBlockThreshold || (GeminiAiAdapter.HarmBlockThreshold = {}));\n})(GeminiAiAdapter || (exports.GeminiAiAdapter = GeminiAiAdapter = {}));\n//# sourceMappingURL=gemini.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9nZW1pbmkuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxtRkFBbUY7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUsscUdBQXFHO0FBQzFHLENBQUMsc0JBQXNCLHVCQUF1Qix1QkFBdUI7QUFDckUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9nZW1pbmkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkdlbWluaUFpQWRhcHRlciA9IHZvaWQgMDtcbnZhciBHZW1pbmlBaUFkYXB0ZXI7XG4oZnVuY3Rpb24gKEdlbWluaUFpQWRhcHRlcikge1xuICAgIGxldCBIYXJtQ2F0ZWdvcnk7XG4gICAgKGZ1bmN0aW9uIChIYXJtQ2F0ZWdvcnkpIHtcbiAgICAgICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9VTlNQRUNJRklFRFwiXSA9IFwiSEFSTV9DQVRFR09SWV9VTlNQRUNJRklFRFwiO1xuICAgICAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX0hBVEVfU1BFRUNIXCJdID0gXCJIQVJNX0NBVEVHT1JZX0hBVEVfU1BFRUNIXCI7XG4gICAgICAgIEhhcm1DYXRlZ29yeVtcIkhBUk1fQ0FURUdPUllfU0VYVUFMTFlfRVhQTElDSVRcIl0gPSBcIkhBUk1fQ0FURUdPUllfU0VYVUFMTFlfRVhQTElDSVRcIjtcbiAgICAgICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9EQU5HRVJPVVNfQ09OVEVOVFwiXSA9IFwiSEFSTV9DQVRFR09SWV9EQU5HRVJPVVNfQ09OVEVOVFwiO1xuICAgICAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX0hBUkFTU01FTlRcIl0gPSBcIkhBUk1fQ0FURUdPUllfSEFSQVNTTUVOVFwiO1xuICAgICAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX0NJVklDX0lOVEVHUklUWVwiXSA9IFwiSEFSTV9DQVRFR09SWV9DSVZJQ19JTlRFR1JJVFlcIjtcbiAgICB9KShIYXJtQ2F0ZWdvcnkgPSBHZW1pbmlBaUFkYXB0ZXIuSGFybUNhdGVnb3J5IHx8IChHZW1pbmlBaUFkYXB0ZXIuSGFybUNhdGVnb3J5ID0ge30pKTtcbiAgICBsZXQgSGFybUJsb2NrVGhyZXNob2xkO1xuICAgIChmdW5jdGlvbiAoSGFybUJsb2NrVGhyZXNob2xkKSB7XG4gICAgICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkhBUk1fQkxPQ0tfVEhSRVNIT0xEX1VOU1BFQ0lGSUVEXCJdID0gXCJIQVJNX0JMT0NLX1RIUkVTSE9MRF9VTlNQRUNJRklFRFwiO1xuICAgICAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJCTE9DS19MT1dfQU5EX0FCT1ZFXCJdID0gXCJCTE9DS19MT1dfQU5EX0FCT1ZFXCI7XG4gICAgICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkJMT0NLX01FRElVTV9BTkRfQUJPVkVcIl0gPSBcIkJMT0NLX01FRElVTV9BTkRfQUJPVkVcIjtcbiAgICAgICAgSGFybUJsb2NrVGhyZXNob2xkW1wiQkxPQ0tfT05MWV9ISUdIXCJdID0gXCJCTE9DS19PTkxZX0hJR0hcIjtcbiAgICAgICAgSGFybUJsb2NrVGhyZXNob2xkW1wiQkxPQ0tfTk9ORVwiXSA9IFwiQkxPQ0tfTk9ORVwiO1xuICAgICAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJPRkZcIl0gPSBcIk9GRlwiO1xuICAgIH0pKEhhcm1CbG9ja1RocmVzaG9sZCA9IEdlbWluaUFpQWRhcHRlci5IYXJtQmxvY2tUaHJlc2hvbGQgfHwgKEdlbWluaUFpQWRhcHRlci5IYXJtQmxvY2tUaHJlc2hvbGQgPSB7fSkpO1xufSkoR2VtaW5pQWlBZGFwdGVyIHx8IChleHBvcnRzLkdlbWluaUFpQWRhcHRlciA9IEdlbWluaUFpQWRhcHRlciA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZW1pbmkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/adapters/gemini.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/adapters/grok.js":
/*!********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/adapters/grok.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n//# sourceMappingURL=grok.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9ncm9rLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdEIiwic291cmNlcyI6WyIvVXNlcnMvaGFyc2hzaHJpdmFzdGF2L0Rlc2t0b3AvQ29kaW5nIFByb2plY3RzL0pvYi1Bc3Npc3RhbnQtQWdlbnQvbm9kZV9tb2R1bGVzL0Bpbm5nZXN0L2FpL2Rpc3QvYWRhcHRlcnMvZ3Jvay5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdyb2suanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/adapters/grok.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/adapters/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/adapters/index.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n__exportStar(__webpack_require__(/*! ./anthropic.js */ \"(rsc)/./node_modules/@inngest/ai/dist/adapters/anthropic.js\"), exports);\n__exportStar(__webpack_require__(/*! ./gemini.js */ \"(rsc)/./node_modules/@inngest/ai/dist/adapters/gemini.js\"), exports);\n__exportStar(__webpack_require__(/*! ./openai.js */ \"(rsc)/./node_modules/@inngest/ai/dist/adapters/openai.js\"), exports);\n__exportStar(__webpack_require__(/*! ./grok.js */ \"(rsc)/./node_modules/@inngest/ai/dist/adapters/grok.js\"), exports);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQ0FBb0M7QUFDbkQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxhQUFhLG1CQUFPLENBQUMsbUZBQWdCO0FBQ3JDLGFBQWEsbUJBQU8sQ0FBQyw2RUFBYTtBQUNsQyxhQUFhLG1CQUFPLENBQUMsNkVBQWE7QUFDbEMsYUFBYSxtQkFBTyxDQUFDLHlFQUFXO0FBQ2hDIiwic291cmNlcyI6WyIvVXNlcnMvaGFyc2hzaHJpdmFzdGF2L0Rlc2t0b3AvQ29kaW5nIFByb2plY3RzL0pvYi1Bc3Npc3RhbnQtQWdlbnQvbm9kZV9tb2R1bGVzL0Bpbm5nZXN0L2FpL2Rpc3QvYWRhcHRlcnMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbihtLCBleHBvcnRzKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChleHBvcnRzLCBwKSkgX19jcmVhdGVCaW5kaW5nKGV4cG9ydHMsIG0sIHApO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9hbnRocm9waWMuanNcIiksIGV4cG9ydHMpO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2dlbWluaS5qc1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vb3BlbmFpLmpzXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9ncm9rLmpzXCIpLCBleHBvcnRzKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/adapters/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/adapters/openai.js":
/*!**********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/adapters/openai.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n//# sourceMappingURL=openai.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9vcGVuYWkuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9hZGFwdGVycy9vcGVuYWkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vcGVuYWkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/adapters/openai.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/env.js":
/*!**********************************************!*\
  !*** ./node_modules/@inngest/ai/dist/env.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.envKeys = exports.processEnv = exports.allProcessEnv = void 0;\n/**\n * allProcessEnv returns the current process environment variables, or an empty\n * object if they cannot be read, making sure we support environments other than\n * Node such as Deno, too.\n *\n * Using this ensures we don't dangerously access `process.env` in environments\n * where it may not be defined, such as Deno or the browser.\n */\nconst allProcessEnv = () => {\n    // Node, or Node-like environments\n    try {\n        if (process.env) {\n            return process.env;\n        }\n    }\n    catch (_err) {\n        // noop\n    }\n    // Deno\n    try {\n        const env = Deno.env.toObject();\n        if (env) {\n            return env;\n        }\n    }\n    catch (_err) {\n        // noop\n    }\n    // Netlify\n    try {\n        const env = Netlify.env.toObject();\n        if (env) {\n            return env;\n        }\n    }\n    catch (_err) {\n        // noop\n    }\n    return {};\n};\nexports.allProcessEnv = allProcessEnv;\nconst processEnv = (key) => {\n    return (0, exports.allProcessEnv)()[key];\n};\nexports.processEnv = processEnv;\nvar envKeys;\n(function (envKeys) {\n    envKeys[\"OpenAiApiKey\"] = \"OPENAI_API_KEY\";\n    envKeys[\"GeminiApiKey\"] = \"GEMINI_API_KEY\";\n    envKeys[\"AnthropicApiKey\"] = \"ANTHROPIC_API_KEY\";\n    envKeys[\"DeepSeekApiKey\"] = \"DEEPSEEK_API_KEY\";\n    envKeys[\"GrokApiKey\"] = \"XAI_API_KEY\";\n})(envKeys || (exports.envKeys = envKeys = {}));\n//# sourceMappingURL=env.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9lbnYuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsZUFBZSxHQUFHLGtCQUFrQixHQUFHLHFCQUFxQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGNBQWMsZUFBZSxlQUFlO0FBQzdDIiwic291cmNlcyI6WyIvVXNlcnMvaGFyc2hzaHJpdmFzdGF2L0Rlc2t0b3AvQ29kaW5nIFByb2plY3RzL0pvYi1Bc3Npc3RhbnQtQWdlbnQvbm9kZV9tb2R1bGVzL0Bpbm5nZXN0L2FpL2Rpc3QvZW52LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5lbnZLZXlzID0gZXhwb3J0cy5wcm9jZXNzRW52ID0gZXhwb3J0cy5hbGxQcm9jZXNzRW52ID0gdm9pZCAwO1xuLyoqXG4gKiBhbGxQcm9jZXNzRW52IHJldHVybnMgdGhlIGN1cnJlbnQgcHJvY2VzcyBlbnZpcm9ubWVudCB2YXJpYWJsZXMsIG9yIGFuIGVtcHR5XG4gKiBvYmplY3QgaWYgdGhleSBjYW5ub3QgYmUgcmVhZCwgbWFraW5nIHN1cmUgd2Ugc3VwcG9ydCBlbnZpcm9ubWVudHMgb3RoZXIgdGhhblxuICogTm9kZSBzdWNoIGFzIERlbm8sIHRvby5cbiAqXG4gKiBVc2luZyB0aGlzIGVuc3VyZXMgd2UgZG9uJ3QgZGFuZ2Vyb3VzbHkgYWNjZXNzIGBwcm9jZXNzLmVudmAgaW4gZW52aXJvbm1lbnRzXG4gKiB3aGVyZSBpdCBtYXkgbm90IGJlIGRlZmluZWQsIHN1Y2ggYXMgRGVubyBvciB0aGUgYnJvd3Nlci5cbiAqL1xuY29uc3QgYWxsUHJvY2Vzc0VudiA9ICgpID0+IHtcbiAgICAvLyBOb2RlLCBvciBOb2RlLWxpa2UgZW52aXJvbm1lbnRzXG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52KSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzcy5lbnY7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKF9lcnIpIHtcbiAgICAgICAgLy8gbm9vcFxuICAgIH1cbiAgICAvLyBEZW5vXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZW52ID0gRGVuby5lbnYudG9PYmplY3QoKTtcbiAgICAgICAgaWYgKGVudikge1xuICAgICAgICAgICAgcmV0dXJuIGVudjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoX2Vycikge1xuICAgICAgICAvLyBub29wXG4gICAgfVxuICAgIC8vIE5ldGxpZnlcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBlbnYgPSBOZXRsaWZ5LmVudi50b09iamVjdCgpO1xuICAgICAgICBpZiAoZW52KSB7XG4gICAgICAgICAgICByZXR1cm4gZW52O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChfZXJyKSB7XG4gICAgICAgIC8vIG5vb3BcbiAgICB9XG4gICAgcmV0dXJuIHt9O1xufTtcbmV4cG9ydHMuYWxsUHJvY2Vzc0VudiA9IGFsbFByb2Nlc3NFbnY7XG5jb25zdCBwcm9jZXNzRW52ID0gKGtleSkgPT4ge1xuICAgIHJldHVybiAoMCwgZXhwb3J0cy5hbGxQcm9jZXNzRW52KSgpW2tleV07XG59O1xuZXhwb3J0cy5wcm9jZXNzRW52ID0gcHJvY2Vzc0VudjtcbnZhciBlbnZLZXlzO1xuKGZ1bmN0aW9uIChlbnZLZXlzKSB7XG4gICAgZW52S2V5c1tcIk9wZW5BaUFwaUtleVwiXSA9IFwiT1BFTkFJX0FQSV9LRVlcIjtcbiAgICBlbnZLZXlzW1wiR2VtaW5pQXBpS2V5XCJdID0gXCJHRU1JTklfQVBJX0tFWVwiO1xuICAgIGVudktleXNbXCJBbnRocm9waWNBcGlLZXlcIl0gPSBcIkFOVEhST1BJQ19BUElfS0VZXCI7XG4gICAgZW52S2V5c1tcIkRlZXBTZWVrQXBpS2V5XCJdID0gXCJERUVQU0VFS19BUElfS0VZXCI7XG4gICAgZW52S2V5c1tcIkdyb2tBcGlLZXlcIl0gPSBcIlhBSV9BUElfS0VZXCI7XG59KShlbnZLZXlzIHx8IChleHBvcnRzLmVudktleXMgPSBlbnZLZXlzID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVudi5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/env.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/index.js":
/*!************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/index.js ***!
  \************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n__exportStar(__webpack_require__(/*! ./adapters/index.js */ \"(rsc)/./node_modules/@inngest/ai/dist/adapters/index.js\"), exports);\n__exportStar(__webpack_require__(/*! ./models/index.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/index.js\"), exports);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQ0FBb0M7QUFDbkQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxhQUFhLG1CQUFPLENBQUMsb0ZBQXFCO0FBQzFDLGFBQWEsbUJBQU8sQ0FBQyxnRkFBbUI7QUFDeEMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19leHBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2V4cG9ydFN0YXIpIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMsIHApKSBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2FkYXB0ZXJzL2luZGV4LmpzXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9tb2RlbHMvaW5kZXguanNcIiksIGV4cG9ydHMpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/models/anthropic.js":
/*!***********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/models/anthropic.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.anthropic = void 0;\nconst env_1 = __webpack_require__(/*! ../env */ \"(rsc)/./node_modules/@inngest/ai/dist/env.js\");\n/**\n * Create an Anthropic model using the Anthropic chat format.\n *\n * By default it targets the `https://api.anthropic.com/v1/` base URL, with the\n * \"2023-06-01\" anthropic-version header.\n */\nconst anthropic = (options) => {\n    var _a, _b;\n    const authKey = options.apiKey || (0, env_1.processEnv)(env_1.envKeys.AnthropicApiKey) || \"\";\n    // Ensure we add a trailing slash to our base URL if it doesn't have one,\n    // otherwise we'll replace the path instead of appending it.\n    let baseUrl = options.baseUrl || \"https://api.anthropic.com/v1/\";\n    if (!baseUrl.endsWith(\"/\")) {\n        baseUrl += \"/\";\n    }\n    const url = new URL(\"messages\", baseUrl);\n    const headers = {\n        \"anthropic-version\": \"2023-06-01\",\n    };\n    if ((((_a = options.betaHeaders) === null || _a === void 0 ? void 0 : _a.length) || 0) > 0) {\n        headers[\"anthropic-beta\"] = ((_b = options.betaHeaders) === null || _b === void 0 ? void 0 : _b.join(\",\")) || \"\";\n    }\n    return {\n        url: url.href,\n        authKey,\n        format: \"anthropic\",\n        onCall(_, body) {\n            Object.assign(body, options.defaultParameters);\n            body.model || (body.model = options.model);\n        },\n        headers,\n        options,\n    };\n};\nexports.anthropic = anthropic;\n//# sourceMappingURL=anthropic.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvYW50aHJvcGljLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGlCQUFpQjtBQUNqQixjQUFjLG1CQUFPLENBQUMsNERBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQiIsInNvdXJjZXMiOlsiL1VzZXJzL2hhcnNoc2hyaXZhc3Rhdi9EZXNrdG9wL0NvZGluZyBQcm9qZWN0cy9Kb2ItQXNzaXN0YW50LUFnZW50L25vZGVfbW9kdWxlcy9AaW5uZ2VzdC9haS9kaXN0L21vZGVscy9hbnRocm9waWMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmFudGhyb3BpYyA9IHZvaWQgMDtcbmNvbnN0IGVudl8xID0gcmVxdWlyZShcIi4uL2VudlwiKTtcbi8qKlxuICogQ3JlYXRlIGFuIEFudGhyb3BpYyBtb2RlbCB1c2luZyB0aGUgQW50aHJvcGljIGNoYXQgZm9ybWF0LlxuICpcbiAqIEJ5IGRlZmF1bHQgaXQgdGFyZ2V0cyB0aGUgYGh0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvYCBiYXNlIFVSTCwgd2l0aCB0aGVcbiAqIFwiMjAyMy0wNi0wMVwiIGFudGhyb3BpYy12ZXJzaW9uIGhlYWRlci5cbiAqL1xuY29uc3QgYW50aHJvcGljID0gKG9wdGlvbnMpID0+IHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IGF1dGhLZXkgPSBvcHRpb25zLmFwaUtleSB8fCAoMCwgZW52XzEucHJvY2Vzc0VudikoZW52XzEuZW52S2V5cy5BbnRocm9waWNBcGlLZXkpIHx8IFwiXCI7XG4gICAgLy8gRW5zdXJlIHdlIGFkZCBhIHRyYWlsaW5nIHNsYXNoIHRvIG91ciBiYXNlIFVSTCBpZiBpdCBkb2Vzbid0IGhhdmUgb25lLFxuICAgIC8vIG90aGVyd2lzZSB3ZSdsbCByZXBsYWNlIHRoZSBwYXRoIGluc3RlYWQgb2YgYXBwZW5kaW5nIGl0LlxuICAgIGxldCBiYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsIHx8IFwiaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9cIjtcbiAgICBpZiAoIWJhc2VVcmwuZW5kc1dpdGgoXCIvXCIpKSB7XG4gICAgICAgIGJhc2VVcmwgKz0gXCIvXCI7XG4gICAgfVxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoXCJtZXNzYWdlc1wiLCBiYXNlVXJsKTtcbiAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICBcImFudGhyb3BpYy12ZXJzaW9uXCI6IFwiMjAyMy0wNi0wMVwiLFxuICAgIH07XG4gICAgaWYgKCgoKF9hID0gb3B0aW9ucy5iZXRhSGVhZGVycykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgfHwgMCkgPiAwKSB7XG4gICAgICAgIGhlYWRlcnNbXCJhbnRocm9waWMtYmV0YVwiXSA9ICgoX2IgPSBvcHRpb25zLmJldGFIZWFkZXJzKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iuam9pbihcIixcIikpIHx8IFwiXCI7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHVybDogdXJsLmhyZWYsXG4gICAgICAgIGF1dGhLZXksXG4gICAgICAgIGZvcm1hdDogXCJhbnRocm9waWNcIixcbiAgICAgICAgb25DYWxsKF8sIGJvZHkpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYm9keSwgb3B0aW9ucy5kZWZhdWx0UGFyYW1ldGVycyk7XG4gICAgICAgICAgICBib2R5Lm1vZGVsIHx8IChib2R5Lm1vZGVsID0gb3B0aW9ucy5tb2RlbCk7XG4gICAgICAgIH0sXG4gICAgICAgIGhlYWRlcnMsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgfTtcbn07XG5leHBvcnRzLmFudGhyb3BpYyA9IGFudGhyb3BpYztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFudGhyb3BpYy5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/models/anthropic.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/models/deepseek.js":
/*!**********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/models/deepseek.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.deepseek = void 0;\nconst env_1 = __webpack_require__(/*! ../env */ \"(rsc)/./node_modules/@inngest/ai/dist/env.js\");\n/**\n * Create a DeepSeek model using the OpenAI-compatible chat format.\n *\n * By default it targets the `https://api.deepseek.com/v1/` base URL.\n */\nconst deepseek = (options) => {\n    const authKey = options.apiKey || (0, env_1.processEnv)(env_1.envKeys.DeepSeekApiKey) || \"\";\n    // Ensure we add a trailing slash to our base URL if it doesn't have one,\n    // otherwise we'll replace the path instead of appending it.\n    let baseUrl = options.baseUrl || \"https://api.deepseek.com/v1/\";\n    if (!baseUrl.endsWith(\"/\")) {\n        baseUrl += \"/\";\n    }\n    const url = new URL(\"chat/completions\", baseUrl);\n    return {\n        url: url.href,\n        authKey,\n        format: \"openai-chat\",\n        onCall(_, body) {\n            Object.assign(body, options.defaultParameters);\n            body.model || (body.model = options.model);\n        },\n        options,\n    };\n};\nexports.deepseek = deepseek;\n//# sourceMappingURL=deepseek.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvZGVlcHNlZWsuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsZ0JBQWdCO0FBQ2hCLGNBQWMsbUJBQU8sQ0FBQyw0REFBUTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCIiwic291cmNlcyI6WyIvVXNlcnMvaGFyc2hzaHJpdmFzdGF2L0Rlc2t0b3AvQ29kaW5nIFByb2plY3RzL0pvYi1Bc3Npc3RhbnQtQWdlbnQvbm9kZV9tb2R1bGVzL0Bpbm5nZXN0L2FpL2Rpc3QvbW9kZWxzL2RlZXBzZWVrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5kZWVwc2VlayA9IHZvaWQgMDtcbmNvbnN0IGVudl8xID0gcmVxdWlyZShcIi4uL2VudlwiKTtcbi8qKlxuICogQ3JlYXRlIGEgRGVlcFNlZWsgbW9kZWwgdXNpbmcgdGhlIE9wZW5BSS1jb21wYXRpYmxlIGNoYXQgZm9ybWF0LlxuICpcbiAqIEJ5IGRlZmF1bHQgaXQgdGFyZ2V0cyB0aGUgYGh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbS92MS9gIGJhc2UgVVJMLlxuICovXG5jb25zdCBkZWVwc2VlayA9IChvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgYXV0aEtleSA9IG9wdGlvbnMuYXBpS2V5IHx8ICgwLCBlbnZfMS5wcm9jZXNzRW52KShlbnZfMS5lbnZLZXlzLkRlZXBTZWVrQXBpS2V5KSB8fCBcIlwiO1xuICAgIC8vIEVuc3VyZSB3ZSBhZGQgYSB0cmFpbGluZyBzbGFzaCB0byBvdXIgYmFzZSBVUkwgaWYgaXQgZG9lc24ndCBoYXZlIG9uZSxcbiAgICAvLyBvdGhlcndpc2Ugd2UnbGwgcmVwbGFjZSB0aGUgcGF0aCBpbnN0ZWFkIG9mIGFwcGVuZGluZyBpdC5cbiAgICBsZXQgYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybCB8fCBcImh0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbS92MS9cIjtcbiAgICBpZiAoIWJhc2VVcmwuZW5kc1dpdGgoXCIvXCIpKSB7XG4gICAgICAgIGJhc2VVcmwgKz0gXCIvXCI7XG4gICAgfVxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoXCJjaGF0L2NvbXBsZXRpb25zXCIsIGJhc2VVcmwpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHVybDogdXJsLmhyZWYsXG4gICAgICAgIGF1dGhLZXksXG4gICAgICAgIGZvcm1hdDogXCJvcGVuYWktY2hhdFwiLFxuICAgICAgICBvbkNhbGwoXywgYm9keSkge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihib2R5LCBvcHRpb25zLmRlZmF1bHRQYXJhbWV0ZXJzKTtcbiAgICAgICAgICAgIGJvZHkubW9kZWwgfHwgKGJvZHkubW9kZWwgPSBvcHRpb25zLm1vZGVsKTtcbiAgICAgICAgfSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICB9O1xufTtcbmV4cG9ydHMuZGVlcHNlZWsgPSBkZWVwc2Vlaztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlZXBzZWVrLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/models/deepseek.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/models/gemini.js":
/*!********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/models/gemini.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.gemini = void 0;\nconst env_1 = __webpack_require__(/*! ../env */ \"(rsc)/./node_modules/@inngest/ai/dist/env.js\");\n/**\n * Create a Gemini model using the OpenAI chat format.\n *\n * By default it targets the `https://generativelanguage.googleapis.com/v1beta/`\n * base URL.\n */\nconst gemini = (options) => {\n    const authKey = options.apiKey || (0, env_1.processEnv)(env_1.envKeys.GeminiApiKey) || \"\";\n    // Ensure we add a trailing slash to our base URL if it doesn't have one,\n    // otherwise we'll replace the path instead of appending it.\n    let baseUrl = options.baseUrl || \"https://generativelanguage.googleapis.com/v1beta/\";\n    if (!baseUrl.endsWith(\"/\")) {\n        baseUrl += \"/\";\n    }\n    const url = new URL(`models/${options.model}:generateContent?key=${authKey}`, baseUrl);\n    const headers = {};\n    return {\n        url: url.href,\n        authKey,\n        format: \"gemini\",\n        onCall(_, body) {\n            Object.assign(body, options.defaultParameters);\n        },\n        headers,\n        options,\n    };\n};\nexports.gemini = gemini;\n//# sourceMappingURL=gemini.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvZ2VtaW5pLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGNBQWM7QUFDZCxjQUFjLG1CQUFPLENBQUMsNERBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxjQUFjLHVCQUF1QixRQUFRO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkIiwic291cmNlcyI6WyIvVXNlcnMvaGFyc2hzaHJpdmFzdGF2L0Rlc2t0b3AvQ29kaW5nIFByb2plY3RzL0pvYi1Bc3Npc3RhbnQtQWdlbnQvbm9kZV9tb2R1bGVzL0Bpbm5nZXN0L2FpL2Rpc3QvbW9kZWxzL2dlbWluaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZ2VtaW5pID0gdm9pZCAwO1xuY29uc3QgZW52XzEgPSByZXF1aXJlKFwiLi4vZW52XCIpO1xuLyoqXG4gKiBDcmVhdGUgYSBHZW1pbmkgbW9kZWwgdXNpbmcgdGhlIE9wZW5BSSBjaGF0IGZvcm1hdC5cbiAqXG4gKiBCeSBkZWZhdWx0IGl0IHRhcmdldHMgdGhlIGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvYFxuICogYmFzZSBVUkwuXG4gKi9cbmNvbnN0IGdlbWluaSA9IChvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgYXV0aEtleSA9IG9wdGlvbnMuYXBpS2V5IHx8ICgwLCBlbnZfMS5wcm9jZXNzRW52KShlbnZfMS5lbnZLZXlzLkdlbWluaUFwaUtleSkgfHwgXCJcIjtcbiAgICAvLyBFbnN1cmUgd2UgYWRkIGEgdHJhaWxpbmcgc2xhc2ggdG8gb3VyIGJhc2UgVVJMIGlmIGl0IGRvZXNuJ3QgaGF2ZSBvbmUsXG4gICAgLy8gb3RoZXJ3aXNlIHdlJ2xsIHJlcGxhY2UgdGhlIHBhdGggaW5zdGVhZCBvZiBhcHBlbmRpbmcgaXQuXG4gICAgbGV0IGJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmwgfHwgXCJodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvXCI7XG4gICAgaWYgKCFiYXNlVXJsLmVuZHNXaXRoKFwiL1wiKSkge1xuICAgICAgICBiYXNlVXJsICs9IFwiL1wiO1xuICAgIH1cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGBtb2RlbHMvJHtvcHRpb25zLm1vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7YXV0aEtleX1gLCBiYXNlVXJsKTtcbiAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdXJsOiB1cmwuaHJlZixcbiAgICAgICAgYXV0aEtleSxcbiAgICAgICAgZm9ybWF0OiBcImdlbWluaVwiLFxuICAgICAgICBvbkNhbGwoXywgYm9keSkge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihib2R5LCBvcHRpb25zLmRlZmF1bHRQYXJhbWV0ZXJzKTtcbiAgICAgICAgfSxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgICAgb3B0aW9ucyxcbiAgICB9O1xufTtcbmV4cG9ydHMuZ2VtaW5pID0gZ2VtaW5pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2VtaW5pLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/models/gemini.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/models/grok.js":
/*!******************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/models/grok.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.grok = void 0;\nconst env_1 = __webpack_require__(/*! ../env */ \"(rsc)/./node_modules/@inngest/ai/dist/env.js\");\nconst openai_js_1 = __webpack_require__(/*! ./openai.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/openai.js\");\n/**\n * Create a Grok model using the OpenAI chat format.\n *\n * By default it targets the `https://api.x.ai/v1`\n * base URL.\n */\nconst grok = (options) => {\n    const apiKey = options.apiKey || (0, env_1.processEnv)(env_1.envKeys.GrokApiKey);\n    const baseUrl = options.baseUrl || \"https://api.x.ai/v1\";\n    const model = options.model;\n    const adapter = (0, openai_js_1.openai)(Object.assign(Object.assign({}, options), { apiKey,\n        baseUrl,\n        model }));\n    adapter.format = \"grok\";\n    return adapter;\n};\nexports.grok = grok;\n//# sourceMappingURL=grok.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvZ3Jvay5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxZQUFZO0FBQ1osY0FBYyxtQkFBTyxDQUFDLDREQUFRO0FBQzlCLG9CQUFvQixtQkFBTyxDQUFDLDJFQUFhO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLGNBQWM7QUFDeEY7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaIiwic291cmNlcyI6WyIvVXNlcnMvaGFyc2hzaHJpdmFzdGF2L0Rlc2t0b3AvQ29kaW5nIFByb2plY3RzL0pvYi1Bc3Npc3RhbnQtQWdlbnQvbm9kZV9tb2R1bGVzL0Bpbm5nZXN0L2FpL2Rpc3QvbW9kZWxzL2dyb2suanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmdyb2sgPSB2b2lkIDA7XG5jb25zdCBlbnZfMSA9IHJlcXVpcmUoXCIuLi9lbnZcIik7XG5jb25zdCBvcGVuYWlfanNfMSA9IHJlcXVpcmUoXCIuL29wZW5haS5qc1wiKTtcbi8qKlxuICogQ3JlYXRlIGEgR3JvayBtb2RlbCB1c2luZyB0aGUgT3BlbkFJIGNoYXQgZm9ybWF0LlxuICpcbiAqIEJ5IGRlZmF1bHQgaXQgdGFyZ2V0cyB0aGUgYGh0dHBzOi8vYXBpLnguYWkvdjFgXG4gKiBiYXNlIFVSTC5cbiAqL1xuY29uc3QgZ3JvayA9IChvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgYXBpS2V5ID0gb3B0aW9ucy5hcGlLZXkgfHwgKDAsIGVudl8xLnByb2Nlc3NFbnYpKGVudl8xLmVudktleXMuR3Jva0FwaUtleSk7XG4gICAgY29uc3QgYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybCB8fCBcImh0dHBzOi8vYXBpLnguYWkvdjFcIjtcbiAgICBjb25zdCBtb2RlbCA9IG9wdGlvbnMubW9kZWw7XG4gICAgY29uc3QgYWRhcHRlciA9ICgwLCBvcGVuYWlfanNfMS5vcGVuYWkpKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyksIHsgYXBpS2V5LFxuICAgICAgICBiYXNlVXJsLFxuICAgICAgICBtb2RlbCB9KSk7XG4gICAgYWRhcHRlci5mb3JtYXQgPSBcImdyb2tcIjtcbiAgICByZXR1cm4gYWRhcHRlcjtcbn07XG5leHBvcnRzLmdyb2sgPSBncm9rO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3Jvay5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/models/grok.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/models/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/models/index.js ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n__exportStar(__webpack_require__(/*! ./anthropic.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/anthropic.js\"), exports);\n__exportStar(__webpack_require__(/*! ./gemini.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/gemini.js\"), exports);\n__exportStar(__webpack_require__(/*! ./openai.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/openai.js\"), exports);\n__exportStar(__webpack_require__(/*! ./deepseek.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/deepseek.js\"), exports);\n__exportStar(__webpack_require__(/*! ./grok.js */ \"(rsc)/./node_modules/@inngest/ai/dist/models/grok.js\"), exports);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvaW5kZXguanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsb0NBQW9DO0FBQ25EO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsYUFBYSxtQkFBTyxDQUFDLGlGQUFnQjtBQUNyQyxhQUFhLG1CQUFPLENBQUMsMkVBQWE7QUFDbEMsYUFBYSxtQkFBTyxDQUFDLDJFQUFhO0FBQ2xDLGFBQWEsbUJBQU8sQ0FBQywrRUFBZTtBQUNwQyxhQUFhLG1CQUFPLENBQUMsdUVBQVc7QUFDaEMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJzaHNocml2YXN0YXYvRGVza3RvcC9Db2RpbmcgUHJvamVjdHMvSm9iLUFzc2lzdGFudC1BZ2VudC9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbihtLCBleHBvcnRzKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChleHBvcnRzLCBwKSkgX19jcmVhdGVCaW5kaW5nKGV4cG9ydHMsIG0sIHApO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9hbnRocm9waWMuanNcIiksIGV4cG9ydHMpO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2dlbWluaS5qc1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vb3BlbmFpLmpzXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9kZWVwc2Vlay5qc1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vZ3Jvay5qc1wiKSwgZXhwb3J0cyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/models/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@inngest/ai/dist/models/openai.js":
/*!********************************************************!*\
  !*** ./node_modules/@inngest/ai/dist/models/openai.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.openai = void 0;\nconst env_1 = __webpack_require__(/*! ../env */ \"(rsc)/./node_modules/@inngest/ai/dist/env.js\");\n/**\n * Create an OpenAI model using the OpenAI chat format.\n *\n * By default it targets the `https://api.openai.com/v1/` base URL.\n */\nconst openai = (options) => {\n    const authKey = options.apiKey || (0, env_1.processEnv)(env_1.envKeys.OpenAiApiKey) || \"\";\n    // Ensure we add a trailing slash to our base URL if it doesn't have one,\n    // otherwise we'll replace the path instead of appending it.\n    let baseUrl = options.baseUrl || \"https://api.openai.com/v1/\";\n    if (!baseUrl.endsWith(\"/\")) {\n        baseUrl += \"/\";\n    }\n    const url = new URL(\"chat/completions\", baseUrl);\n    return {\n        url: url.href,\n        authKey,\n        format: \"openai-chat\",\n        onCall(_, body) {\n            Object.assign(body, options.defaultParameters);\n            body.model || (body.model = options.model);\n        },\n        options,\n    };\n};\nexports.openai = openai;\n//# sourceMappingURL=openai.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGlubmdlc3QvYWkvZGlzdC9tb2RlbHMvb3BlbmFpLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGNBQWM7QUFDZCxjQUFjLG1CQUFPLENBQUMsNERBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZCIsInNvdXJjZXMiOlsiL1VzZXJzL2hhcnNoc2hyaXZhc3Rhdi9EZXNrdG9wL0NvZGluZyBQcm9qZWN0cy9Kb2ItQXNzaXN0YW50LUFnZW50L25vZGVfbW9kdWxlcy9AaW5uZ2VzdC9haS9kaXN0L21vZGVscy9vcGVuYWkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLm9wZW5haSA9IHZvaWQgMDtcbmNvbnN0IGVudl8xID0gcmVxdWlyZShcIi4uL2VudlwiKTtcbi8qKlxuICogQ3JlYXRlIGFuIE9wZW5BSSBtb2RlbCB1c2luZyB0aGUgT3BlbkFJIGNoYXQgZm9ybWF0LlxuICpcbiAqIEJ5IGRlZmF1bHQgaXQgdGFyZ2V0cyB0aGUgYGh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvYCBiYXNlIFVSTC5cbiAqL1xuY29uc3Qgb3BlbmFpID0gKG9wdGlvbnMpID0+IHtcbiAgICBjb25zdCBhdXRoS2V5ID0gb3B0aW9ucy5hcGlLZXkgfHwgKDAsIGVudl8xLnByb2Nlc3NFbnYpKGVudl8xLmVudktleXMuT3BlbkFpQXBpS2V5KSB8fCBcIlwiO1xuICAgIC8vIEVuc3VyZSB3ZSBhZGQgYSB0cmFpbGluZyBzbGFzaCB0byBvdXIgYmFzZSBVUkwgaWYgaXQgZG9lc24ndCBoYXZlIG9uZSxcbiAgICAvLyBvdGhlcndpc2Ugd2UnbGwgcmVwbGFjZSB0aGUgcGF0aCBpbnN0ZWFkIG9mIGFwcGVuZGluZyBpdC5cbiAgICBsZXQgYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybCB8fCBcImh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvXCI7XG4gICAgaWYgKCFiYXNlVXJsLmVuZHNXaXRoKFwiL1wiKSkge1xuICAgICAgICBiYXNlVXJsICs9IFwiL1wiO1xuICAgIH1cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKFwiY2hhdC9jb21wbGV0aW9uc1wiLCBiYXNlVXJsKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB1cmw6IHVybC5ocmVmLFxuICAgICAgICBhdXRoS2V5LFxuICAgICAgICBmb3JtYXQ6IFwib3BlbmFpLWNoYXRcIixcbiAgICAgICAgb25DYWxsKF8sIGJvZHkpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYm9keSwgb3B0aW9ucy5kZWZhdWx0UGFyYW1ldGVycyk7XG4gICAgICAgICAgICBib2R5Lm1vZGVsIHx8IChib2R5Lm1vZGVsID0gb3B0aW9ucy5tb2RlbCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9wdGlvbnMsXG4gICAgfTtcbn07XG5leHBvcnRzLm9wZW5haSA9IG9wZW5haTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9wZW5haS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@inngest/ai/dist/models/openai.js\n");

/***/ })

};
;